<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.47">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Ravi Shankar">

<title>experimental_design – Data Down To Earth</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../logo.png" rel="icon" type="image/png">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../../styles.css">
<link rel="stylesheet" href="../../content.css">
<meta property="og:title" content="– Data Down To Earth">
<meta property="og:site_name" content="Data Down To Earth">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../../logo.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Data Down To Earth</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-projects" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Projects</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-projects">    
        <li>
    <a class="dropdown-item" href="../../../projects/dsml_projects.html">
 <span class="dropdown-text">Data Science and ML Projects</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../projects/genai_projects.html">
 <span class="dropdown-text">Generative AI Projects</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-tutorials" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Tutorials</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-tutorials">    
        <li>
    <a class="dropdown-item" href="../../../topics/statistics.html">
 <span class="dropdown-text">Statistics &amp; Probability</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../topics/machine_learning.html">
 <span class="dropdown-text">Machine Learning</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../topics/de.html">
 <span class="dropdown-text">Data Engineering</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../topics/generative_ai.html">
 <span class="dropdown-text">Generative AI</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../topics/public_health.html">
 <span class="dropdown-text">Public Health</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../topics/product_sense.html">
 <span class="dropdown-text">Product Sense</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../../notes/notes.html"> 
<span class="menu-text">Notes</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/iamrsps"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/iamravishankar/"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content column-page" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
</div>



<div class="quarto-title-meta column-page">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Ravi Shankar </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="chapter-11-experimental-design" class="level1 text-content">
<h1>Chapter 11: Experimental Design</h1>
<section id="randomized-controlled-trials-rcts" class="level2">
<h2 class="anchored" data-anchor-id="randomized-controlled-trials-rcts">Randomized Controlled Trials (RCTs)</h2>
<p>RCTs are considered the gold standard in clinical research for determining the efficacy of interventions. They involve randomly assigning participants to either the treatment group or the control group to ensure any differences observed between the groups are due to the intervention and not other factors.</p>
<section id="simple-randomization" class="level3">
<h3 class="anchored" data-anchor-id="simple-randomization">Simple Randomization</h3>
<section id="coin-flipping" class="level4">
<h4 class="anchored" data-anchor-id="coin-flipping">Coin Flipping</h4>
<ul>
<li><p><strong>Definition</strong>: Coin flipping is one of the most basic methods of randomization, where heads might mean assignment to the treatment group and tails to the control group. This method ensures that each participant has an equal chance of being assigned to either group.</p></li>
<li><p><strong>Advantages</strong>: This method is simple and easy to implement, requiring no special equipment or software.</p></li>
<li><p><strong>Disadvantages</strong>: It can lead to imbalances in group sizes, especially with smaller sample sizes. For example, in a small study with 20 participants, it is possible that 14 participants could be assigned to one group and only 6 to the other, which could affect the study’s validity.</p></li>
</ul>
</section>
<section id="random-number-generators" class="level4">
<h4 class="anchored" data-anchor-id="random-number-generators">Random Number Generators</h4>
<ul>
<li><p><strong>Definition</strong>: Random number generators use algorithms to produce sequences of numbers that lack any pattern. These numbers are then used to allocate participants to different groups.</p></li>
<li><p><strong>Procedure</strong>: Each participant is assigned a unique number. A random number generator is used to decide group allocation, ensuring an unbiased distribution.</p></li>
<li><p><strong>Advantages</strong>: This method is more precise and can handle larger sample sizes better than coin flipping. For example, using software to generate random numbers ensures a more balanced allocation in a study with 200 participants.</p></li>
</ul>
</section>
</section>
<section id="block-randomization" class="level3">
<h3 class="anchored" data-anchor-id="block-randomization">Block Randomization</h3>
<section id="fixed-block-sizes" class="level4">
<h4 class="anchored" data-anchor-id="fixed-block-sizes">Fixed Block Sizes</h4>
<ul>
<li><p><strong>Definition</strong>: In fixed block sizes, participants are divided into blocks (e.g., of size 4, 6, or 8), and within each block, half are assigned to the treatment group and half to the control group. This method ensures that the number of participants in each group is balanced at the end of each block.</p></li>
<li><p><strong>Advantages</strong>: Ensures equal numbers in each group throughout the trial, which helps maintain balance and enhances the study’s statistical power.</p></li>
</ul>
</section>
<section id="variable-block-sizes" class="level4">
<h4 class="anchored" data-anchor-id="variable-block-sizes">Variable Block Sizes</h4>
<ul>
<li><p><strong>Definition</strong>: Variable block sizes prevent predictability by varying the block sizes (e.g., 4, 6, 8) used in randomization. This method adds an extra layer of randomness.</p></li>
<li><p><strong>Advantages</strong>: This method maintains balance while reducing the risk of allocation prediction. For example, in a clinical trial, variable block sizes prevent investigators from guessing the next assignment.</p></li>
</ul>
</section>
</section>
<section id="stratified-randomization" class="level3">
<h3 class="anchored" data-anchor-id="stratified-randomization">Stratified Randomization</h3>
<section id="identifying-stratification-factors" class="level4">
<h4 class="anchored" data-anchor-id="identifying-stratification-factors">Identifying Stratification Factors</h4>
<ul>
<li><p><strong>Definition</strong>: Stratification factors are variables that can influence the outcome of the trial. These factors need to be identified before the trial starts to ensure they are evenly distributed across treatment groups.</p></li>
<li><p><strong>Procedure</strong>: Stratify participants based on these factors and then randomize within each stratum. For example, in a trial studying the effect of a drug on blood pressure, participants might be stratified by age and gender.</p></li>
</ul>
</section>
<section id="balancing-across-strata" class="level4">
<h4 class="anchored" data-anchor-id="balancing-across-strata">Balancing Across Strata</h4>
<ul>
<li><p><strong>Definition</strong>: Balancing across strata involves ensuring that within each subgroup, participants are equally distributed to treatment and control groups.</p></li>
<li><p><strong>Advantages</strong>: This minimizes confounding variables, which can distort the true effect of the treatment. For instance, ensuring an equal distribution of participants with different baseline blood pressures across treatment groups in a hypertension study.</p></li>
</ul>
</section>
</section>
<section id="cluster-randomization" class="level3">
<h3 class="anchored" data-anchor-id="cluster-randomization">Cluster Randomization</h3>
<ul>
<li><p><strong>Definition</strong>: Cluster randomization involves randomizing groups of participants (clusters) rather than individual participants. This is useful in situations where individual randomization is impractical or where participants are naturally grouped.</p></li>
<li><p><strong>Advantages</strong>: This is useful in settings where individual randomization is impractical. For example, in a study assessing the effectiveness of a new educational program, entire schools might be randomized to either the intervention or control group.</p></li>
</ul>
<section id="defining-clusters" class="level4">
<h4 class="anchored" data-anchor-id="defining-clusters">Defining Clusters</h4>
<ul>
<li><p><strong>Definition</strong>: Clusters can be defined based on geographical regions, schools, hospitals, or clinics.</p></li>
<li><p><strong>Procedure</strong>: Each cluster is then randomly assigned to the intervention or control group. For example, different wards in a hospital could be randomized in a study on infection control measures.</p></li>
</ul>
</section>
<section id="intracluster-correlation" class="level4">
<h4 class="anchored" data-anchor-id="intracluster-correlation">Intracluster Correlation</h4>
<ul>
<li><p><strong>Definition</strong>: Intracluster correlation refers to the degree to which participants within the same cluster resemble each other.</p></li>
<li><p><strong>Implications</strong>: High intracluster correlation can reduce the effective sample size, necessitating larger clusters or more clusters to maintain statistical power. For instance, if patients within the same hospital ward share similar characteristics, the effective number of independent observations is reduced.</p></li>
</ul>
</section>
</section>
<section id="crossover-designs" class="level3">
<h3 class="anchored" data-anchor-id="crossover-designs">Crossover Designs</h3>
<ul>
<li><strong>Definition</strong>: Crossover designs involve participants receiving both the intervention and control at different times, with a washout period in between. This allows each participant to serve as their own control, reducing variability.</li>
</ul>
<section id="washout-periods" class="level4">
<h4 class="anchored" data-anchor-id="washout-periods">Washout Periods</h4>
<ul>
<li><p><strong>Definition</strong>: A washout period is a break between treatments to ensure that the effects of the first treatment do not carry over into the second period.</p></li>
<li><p><strong>Example</strong>: In a drug trial, participants might receive Drug A for 4 weeks, have a 2-week washout period, and then receive Drug B for another 4 weeks.</p></li>
</ul>
</section>
<section id="carryover-effects" class="level4">
<h4 class="anchored" data-anchor-id="carryover-effects">Carryover Effects</h4>
<ul>
<li><p><strong>Definition</strong>: Carryover effects occur when the effects of the first treatment persist and affect the outcomes of the second treatment.</p></li>
<li><p><strong>Mitigation</strong>: Proper washout periods help mitigate these effects. For instance, ensuring a long enough washout period between different diets in a nutritional study to prevent residual effects.</p></li>
</ul>
</section>
</section>
<section id="adaptive-randomization" class="level3">
<h3 class="anchored" data-anchor-id="adaptive-randomization">Adaptive Randomization</h3>
<ul>
<li><strong>Definition</strong>: Adaptive randomization allows for modifications to the randomization process based on interim results during the trial. This method aims to improve the ethical and scientific validity of the trial by potentially assigning more participants to the more effective treatment.</li>
</ul>
<section id="response-adaptive-randomization" class="level4">
<h4 class="anchored" data-anchor-id="response-adaptive-randomization">Response-Adaptive Randomization</h4>
<ul>
<li><p><strong>Definition</strong>: Response-adaptive randomization adjusts the allocation ratio based on responses observed in the trial, potentially allocating more participants to the more effective treatment.</p></li>
<li><p><strong>Example</strong>: In a clinical trial for a new cancer drug, if initial results show that the drug is more effective than the standard treatment, more patients might be allocated to the new drug arm.</p></li>
</ul>
</section>
<section id="covariate-adaptive-randomization" class="level4">
<h4 class="anchored" data-anchor-id="covariate-adaptive-randomization">Covariate-Adaptive Randomization</h4>
<ul>
<li><p><strong>Definition</strong>: Covariate-adaptive randomization ensures balance across predefined covariates, adjusting the probability of assignment to maintain balance as the trial progresses.</p></li>
<li><p><strong>Example</strong>: In a trial for a new hypertension drug, the randomization process might be adjusted to ensure that age and baseline blood pressure are balanced across treatment groups.</p></li>
</ul>
</section>
</section>
</section>
<section id="ab-testing" class="level2">
<h2 class="anchored" data-anchor-id="ab-testing">A/B Testing</h2>
<p>A/B testing compares two versions (A and B) to determine which one performs better. It is widely used in marketing, web design, and user experience research.</p>
<section id="single-variable-testing" class="level3">
<h3 class="anchored" data-anchor-id="single-variable-testing">Single Variable Testing</h3>
<ul>
<li><p><strong>Definition</strong>: Single variable testing changes one element between versions A and B, allowing for a clear attribution of differences in outcomes to that single variable.</p></li>
<li><p><strong>Example</strong>: Testing two different headlines for a webpage to see which one leads to higher click-through rates.</p></li>
</ul>
<section id="scenario-testing-two-different-headlines-for-a-promotional-post" class="level4">
<h4 class="anchored" data-anchor-id="scenario-testing-two-different-headlines-for-a-promotional-post">Scenario: Testing Two Different Headlines for a Promotional Post</h4>
<p>Let’s assume Instagram wants to test two different headlines for a promotional post to see which one attracts more users to click through to a new feature announcement.</p>
<section id="headlines-to-test" class="level5">
<h5 class="anchored" data-anchor-id="headlines-to-test">Headlines to Test</h5>
<ul>
<li><strong>Headline A</strong>: “Discover the Latest Instagram Features Now!”</li>
<li><strong>Headline B</strong>: “Unlock New Instagram Features Today!”</li>
</ul>
</section>
<section id="objective" class="level5">
<h5 class="anchored" data-anchor-id="objective">Objective</h5>
<p>Determine which headline leads to a higher click-through rate (CTR).</p>
<div id="94cdd5fc" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>    <span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    <span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Sample data: user interactions with promotional post</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> {</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">'user_id'</span>: np.arange(<span class="dv">1</span>, <span class="dv">1001</span>),</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">'headline'</span>: np.random.choice([<span class="st">'A'</span>, <span class="st">'B'</span>], <span class="dv">1000</span>),</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">'clicked'</span>: np.random.choice([<span class="dv">0</span>, <span class="dv">1</span>], <span class="dv">1000</span>, p<span class="op">=</span>[<span class="fl">0.7</span>, <span class="fl">0.3</span>])</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate CTR for each headline</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    ctr_a <span class="op">=</span> df[df[<span class="st">'headline'</span>] <span class="op">==</span> <span class="st">'A'</span>][<span class="st">'clicked'</span>].mean()</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    ctr_b <span class="op">=</span> df[df[<span class="st">'headline'</span>] <span class="op">==</span> <span class="st">'B'</span>][<span class="st">'clicked'</span>].mean()</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Display CTRs</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"CTR for Headline A: </span><span class="sc">{</span>ctr_a<span class="sc">:.2%}</span><span class="ss">"</span>)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"CTR for Headline B: </span><span class="sc">{</span>ctr_b<span class="sc">:.2%}</span><span class="ss">"</span>)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Perform A/B test using a two-proportion z-test</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>    count_a <span class="op">=</span> df[df[<span class="st">'headline'</span>] <span class="op">==</span> <span class="st">'A'</span>][<span class="st">'clicked'</span>].<span class="bu">sum</span>()</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>    count_b <span class="op">=</span> df[df[<span class="st">'headline'</span>] <span class="op">==</span> <span class="st">'B'</span>][<span class="st">'clicked'</span>].<span class="bu">sum</span>()</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>    n_a <span class="op">=</span> df[df[<span class="st">'headline'</span>] <span class="op">==</span> <span class="st">'A'</span>].shape[<span class="dv">0</span>]</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>    n_b <span class="op">=</span> df[df[<span class="st">'headline'</span>] <span class="op">==</span> <span class="st">'B'</span>].shape[<span class="dv">0</span>]</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Compute proportions</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>    p1 <span class="op">=</span> count_a <span class="op">/</span> n_a</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>    p2 <span class="op">=</span> count_b <span class="op">/</span> n_b</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>    p_pool <span class="op">=</span> (count_a <span class="op">+</span> count_b) <span class="op">/</span> (n_a <span class="op">+</span> n_b)</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>    z_score <span class="op">=</span> (p1 <span class="op">-</span> p2) <span class="op">/</span> np.sqrt(p_pool <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> p_pool) <span class="op">*</span> (<span class="dv">1</span><span class="op">/</span>n_a <span class="op">+</span> <span class="dv">1</span><span class="op">/</span>n_b))</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>    p_value <span class="op">=</span> stats.norm.sf(<span class="bu">abs</span>(z_score)) <span class="op">*</span> <span class="dv">2</span>  <span class="co"># Two-tailed test</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Z-score: </span><span class="sc">{</span>z_score<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"P-value: </span><span class="sc">{</span>p_value<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Determine statistical significance</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>    alpha <span class="op">=</span> <span class="fl">0.05</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> p_value <span class="op">&lt;</span> alpha:</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"The difference in CTR between the two headlines is statistically significant."</span>)</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"The difference in CTR between the two headlines is not statistically significant."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>CTR for Headline A: 32.10%
CTR for Headline B: 31.91%
Z-score: 0.0651046633777244
P-value: 0.9480906674738749
The difference in CTR between the two headlines is not statistically significant.</code></pre>
</div>
</div>
<hr>
</section>
</section>
</section>
<section id="multivariate-testing-mvt" class="level3">
<h3 class="anchored" data-anchor-id="multivariate-testing-mvt">Multivariate Testing (MVT)</h3>
<ul>
<li><p><strong>Definition</strong>: Multivariate testing examines multiple variables simultaneously, testing different combinations to understand the effect of each variable and their interactions.</p></li>
<li><p><strong>Example</strong>: Testing different combinations of headlines, images, and call-to-action buttons on a webpage to determine the optimal combination for maximizing conversions.</p></li>
</ul>
<section id="scenario-testing-different-combinations-of-headlines-images-and-cta-buttons" class="level4">
<h4 class="anchored" data-anchor-id="scenario-testing-different-combinations-of-headlines-images-and-cta-buttons">Scenario: Testing Different Combinations of Headlines, Images, and CTA Buttons</h4>
<p>Let’s assume Facebook wants to test various combinations of headlines, images, and CTA buttons on a promotional webpage to see which combination leads to the highest conversion rate.</p>
<section id="variables-to-test" class="level5">
<h5 class="anchored" data-anchor-id="variables-to-test">Variables to Test</h5>
<ul>
<li><strong>Headlines</strong>:
<ul>
<li>“Discover New Features”</li>
<li>“Unlock Exclusive Content”</li>
</ul></li>
<li><strong>Images</strong>:
<ul>
<li>“Image1”</li>
<li>“Image2”</li>
</ul></li>
<li><strong>CTA Buttons</strong>:
<ul>
<li>“Sign Up Now”</li>
<li>“Learn More”</li>
</ul></li>
</ul>
</section>
<section id="objective-1" class="level5">
<h5 class="anchored" data-anchor-id="objective-1">Objective</h5>
<p>Determine the optimal combination of headline, image, and CTA button that maximizes the conversion rate.</p>
<div id="f85c4c12" class="cell" data-execution_count="2">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itertools <span class="im">import</span> product</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.stats.proportion <span class="im">import</span> proportions_ztest</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the variables</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>headlines <span class="op">=</span> [<span class="st">"Discover New Features"</span>, <span class="st">"Unlock Exclusive Content"</span>]</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>images <span class="op">=</span> [<span class="st">"Image1"</span>, <span class="st">"Image2"</span>]</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>cta_buttons <span class="op">=</span> [<span class="st">"Sign Up Now"</span>, <span class="st">"Learn More"</span>]</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Create all possible combinations of the variables</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>combinations <span class="op">=</span> <span class="bu">list</span>(product(headlines, images, cta_buttons))</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate user interactions for each combination</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> []</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> comb <span class="kw">in</span> combinations:</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> np.random.randint(<span class="dv">100</span>, <span class="dv">200</span>)  <span class="co"># Number of users exposed to this combination</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    clicks <span class="op">=</span> np.random.binomial(n, <span class="fl">0.2</span> <span class="op">+</span> <span class="fl">0.05</span><span class="op">*</span>np.random.rand())  <span class="co"># Simulate clicks with some random conversion rate</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    data.append([comb[<span class="dv">0</span>], comb[<span class="dv">1</span>], comb[<span class="dv">2</span>], n, clicks])</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a DataFrame</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(data, columns<span class="op">=</span>[<span class="st">"headline"</span>, <span class="st">"image"</span>, <span class="st">"cta_button"</span>, <span class="st">"users"</span>, <span class="st">"clicks"</span>])</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate conversion rate for each combination</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'conversion_rate'</span>] <span class="op">=</span> df[<span class="st">'clicks'</span>] <span class="op">/</span> df[<span class="st">'users'</span>]</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Display conversion rates</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df)</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform z-tests for proportions for each pair of combinations</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> []</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(combinations)):</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(combinations)):</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>        count <span class="op">=</span> np.array([df.iloc[i][<span class="st">'clicks'</span>], df.iloc[j][<span class="st">'clicks'</span>]])</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>        nobs <span class="op">=</span> np.array([df.iloc[i][<span class="st">'users'</span>], df.iloc[j][<span class="st">'users'</span>]])</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>        stat, p_value <span class="op">=</span> proportions_ztest(count, nobs)</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>        results.append((combinations[i], combinations[j], p_value))</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Display significant results</span></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>alpha <span class="op">=</span> <span class="fl">0.05</span></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> result <span class="kw">in</span> results:</span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> result[<span class="dv">2</span>] <span class="op">&lt;</span> alpha:</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Combination </span><span class="sc">{</span>result[<span class="dv">0</span>]<span class="sc">}</span><span class="ss"> is significantly different from </span><span class="sc">{</span>result[<span class="dv">1</span>]<span class="sc">}</span><span class="ss"> with p-value </span><span class="sc">{</span>result[<span class="dv">2</span>]<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                   headline   image   cta_button  users  clicks  \
0     Discover New Features  Image1  Sign Up Now    112      20   
1     Discover New Features  Image1   Learn More    120      34   
2     Discover New Features  Image2  Sign Up Now    196      50   
3     Discover New Features  Image2   Learn More    139      32   
4  Unlock Exclusive Content  Image1  Sign Up Now    143      26   
5  Unlock Exclusive Content  Image1   Learn More    183      37   
6  Unlock Exclusive Content  Image2  Sign Up Now    170      43   
7  Unlock Exclusive Content  Image2   Learn More    191      30   

   conversion_rate  
0         0.178571  
1         0.283333  
2         0.255102  
3         0.230216  
4         0.181818  
5         0.202186  
6         0.252941  
7         0.157068  
Combination ('Discover New Features', 'Image1', 'Learn More') is significantly different from ('Unlock Exclusive Content', 'Image2', 'Learn More') with p-value 0.007335359543926028
Combination ('Discover New Features', 'Image2', 'Sign Up Now') is significantly different from ('Unlock Exclusive Content', 'Image2', 'Learn More') with p-value 0.01726487662286889
Combination ('Unlock Exclusive Content', 'Image2', 'Sign Up Now') is significantly different from ('Unlock Exclusive Content', 'Image2', 'Learn More') with p-value 0.023587750355607333</code></pre>
</div>
</div>
<hr>
</section>
</section>
</section>
<section id="split-url-testing" class="level3">
<h3 class="anchored" data-anchor-id="split-url-testing">Split URL Testing</h3>
<ul>
<li><p><strong>Definition</strong>: Split URL testing involves directing users to different URLs (each hosting a different version of the content) to compare performance metrics like conversion rates.</p></li>
<li><p><strong>Example</strong>: Directing half of the website traffic to a new landing page and the other half to the original page to compare conversion rates.</p></li>
</ul>
<section id="scenario-testing-two-different-landing-pages" class="level4">
<h4 class="anchored" data-anchor-id="scenario-testing-two-different-landing-pages">Scenario: Testing Two Different Landing Pages</h4>
<p>Let’s assume Instagram wants to test a new landing page against the original landing page to see which one results in higher conversion rates.</p>
<section id="urls-to-test" class="level5">
<h5 class="anchored" data-anchor-id="urls-to-test">URLs to Test</h5>
<ul>
<li><strong>Original Landing Page</strong>: <a href="original_page_url">original_page_url</a></li>
<li><strong>New Landing Page</strong>: <a href="new_page_url">new_page_url</a></li>
</ul>
</section>
<section id="objective-2" class="level5">
<h5 class="anchored" data-anchor-id="objective-2">Objective</h5>
<p>Compare the conversion rates between the original landing page and the new landing page.</p>
<div id="c8fdf03a" class="cell" data-execution_count="3">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.stats.proportion <span class="im">import</span> proportions_ztest</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample data: user interactions with the landing pages</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> {</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'user_id'</span>: np.arange(<span class="dv">1</span>, <span class="dv">2001</span>),</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'landing_page'</span>: np.random.choice([<span class="st">'original'</span>, <span class="st">'new'</span>], <span class="dv">2000</span>),</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'converted'</span>: np.random.choice([<span class="dv">0</span>, <span class="dv">1</span>], <span class="dv">2000</span>, p<span class="op">=</span>[<span class="fl">0.7</span>, <span class="fl">0.3</span>])</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate conversion rate for each landing page</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>conversion_rate_original <span class="op">=</span> df[df[<span class="st">'landing_page'</span>] <span class="op">==</span> <span class="st">'original'</span>][<span class="st">'converted'</span>].mean()</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>conversion_rate_new <span class="op">=</span> df[df[<span class="st">'landing_page'</span>] <span class="op">==</span> <span class="st">'new'</span>][<span class="st">'converted'</span>].mean()</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Display conversion rates</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Conversion Rate for Original Landing Page: </span><span class="sc">{</span>conversion_rate_original<span class="sc">:.2%}</span><span class="ss">"</span>)</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Conversion Rate for New Landing Page: </span><span class="sc">{</span>conversion_rate_new<span class="sc">:.2%}</span><span class="ss">"</span>)</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform z-test for proportions</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>count <span class="op">=</span> np.array([</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>    df[df[<span class="st">'landing_page'</span>] <span class="op">==</span> <span class="st">'original'</span>][<span class="st">'converted'</span>].<span class="bu">sum</span>(),</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>    df[df[<span class="st">'landing_page'</span>] <span class="op">==</span> <span class="st">'new'</span>][<span class="st">'converted'</span>].<span class="bu">sum</span>()</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>nobs <span class="op">=</span> np.array([</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>    df[df[<span class="st">'landing_page'</span>] <span class="op">==</span> <span class="st">'original'</span>].shape[<span class="dv">0</span>],</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>    df[df[<span class="st">'landing_page'</span>] <span class="op">==</span> <span class="st">'new'</span>].shape[<span class="dv">0</span>]</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>stat, p_value <span class="op">=</span> proportions_ztest(count, nobs)</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Z-score: </span><span class="sc">{</span>stat<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"P-value: </span><span class="sc">{</span>p_value<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Determine statistical significance</span></span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>alpha <span class="op">=</span> <span class="fl">0.05</span></span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> p_value <span class="op">&lt;</span> alpha:</span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"The difference in conversion rates between the two landing pages is statistically significant."</span>)</span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"The difference in conversion rates between the two landing pages is not statistically significant."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Conversion Rate for Original Landing Page: 31.41%
Conversion Rate for New Landing Page: 30.38%
Z-score: 0.4980515932709024
P-value: 0.6184476779746853
The difference in conversion rates between the two landing pages is not statistically significant.</code></pre>
</div>
</div>
<hr>
</section>
</section>
</section>
<section id="multi-page-testing" class="level3">
<h3 class="anchored" data-anchor-id="multi-page-testing">Multi-Page Testing</h3>
<ul>
<li><p><strong>Definition</strong>: Multi-page testing examines changes across multiple pages, ensuring a consistent user experience and testing the combined effect of changes across a user journey.</p></li>
<li><p><strong>Example</strong>: Testing a new design for an entire checkout process on an e-commerce site to see if it reduces cart abandonment rates.</p></li>
</ul>
<section id="scenario-testing-a-new-design-for-the-entire-checkout-process" class="level4">
<h4 class="anchored" data-anchor-id="scenario-testing-a-new-design-for-the-entire-checkout-process">Scenario: Testing a New Design for the Entire Checkout Process</h4>
<p>Let’s assume Facebook Marketplace wants to test a new design for the entire checkout process, which consists of multiple pages (e.g., cart page, shipping page, payment page), to determine if it reduces cart abandonment rates compared to the current checkout process.</p>
<section id="checkout-process-pages" class="level5">
<h5 class="anchored" data-anchor-id="checkout-process-pages">Checkout Process Pages</h5>
<ul>
<li><strong>Original Checkout Process Pages</strong>: <a href="original_checkout_pages">original_checkout_pages</a></li>
<li><strong>New Checkout Process Pages</strong>: <a href="new_checkout_pages">new_checkout_pages</a></li>
</ul>
</section>
<section id="objective-3" class="level5">
<h5 class="anchored" data-anchor-id="objective-3">Objective</h5>
<p>Compare the cart abandonment rates between the original multi-page checkout process and the new multi-page checkout process.</p>
<div id="75b906ac" class="cell" data-execution_count="4">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.stats.proportion <span class="im">import</span> proportions_ztest</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate user interactions with the multi-page checkout process</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> []</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">0</span>)  <span class="co"># For reproducibility</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the stages of the checkout process</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>checkout_stages <span class="op">=</span> [<span class="st">'cart_page'</span>, <span class="st">'shipping_page'</span>, <span class="st">'payment_page'</span>]</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate data for users going through the original checkout process</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> user_id <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">1501</span>):</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    completed_purchase <span class="op">=</span> <span class="va">True</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> stage <span class="kw">in</span> checkout_stages:</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> np.random.rand() <span class="op">&gt;</span> <span class="fl">0.85</span>:  <span class="co"># 15% chance of abandoning at each stage</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>            completed_purchase <span class="op">=</span> <span class="va">False</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>    data.append([user_id, <span class="st">'original'</span>, completed_purchase])</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate data for users going through the new checkout process</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> user_id <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1501</span>, <span class="dv">3001</span>):</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>    completed_purchase <span class="op">=</span> <span class="va">True</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> stage <span class="kw">in</span> checkout_stages:</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> np.random.rand() <span class="op">&gt;</span> <span class="fl">0.90</span>:  <span class="co"># 10% chance of abandoning at each stage</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>            completed_purchase <span class="op">=</span> <span class="va">False</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>    data.append([user_id, <span class="st">'new'</span>, completed_purchase])</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a DataFrame</span></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(data, columns<span class="op">=</span>[<span class="st">'user_id'</span>, <span class="st">'checkout_process'</span>, <span class="st">'completed_purchase'</span>])</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate completion rate for each checkout process</span></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>completion_rate_original <span class="op">=</span> df[df[<span class="st">'checkout_process'</span>] <span class="op">==</span> <span class="st">'original'</span>][<span class="st">'completed_purchase'</span>].mean()</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>completion_rate_new <span class="op">=</span> df[df[<span class="st">'checkout_process'</span>] <span class="op">==</span> <span class="st">'new'</span>][<span class="st">'completed_purchase'</span>].mean()</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Display completion rates</span></span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Completion Rate for Original Checkout Process: </span><span class="sc">{</span>completion_rate_original<span class="sc">:.2%}</span><span class="ss">"</span>)</span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Completion Rate for New Checkout Process: </span><span class="sc">{</span>completion_rate_new<span class="sc">:.2%}</span><span class="ss">"</span>)</span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform z-test for proportions</span></span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>count <span class="op">=</span> np.array([</span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>    df[df[<span class="st">'checkout_process'</span>] <span class="op">==</span> <span class="st">'original'</span>][<span class="st">'completed_purchase'</span>].<span class="bu">sum</span>(),</span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>    df[df[<span class="st">'checkout_process'</span>] <span class="op">==</span> <span class="st">'new'</span>][<span class="st">'completed_purchase'</span>].<span class="bu">sum</span>()</span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>nobs <span class="op">=</span> np.array([</span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>    df[df[<span class="st">'checkout_process'</span>] <span class="op">==</span> <span class="st">'original'</span>].shape[<span class="dv">0</span>],</span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>    df[df[<span class="st">'checkout_process'</span>] <span class="op">==</span> <span class="st">'new'</span>].shape[<span class="dv">0</span>]</span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a>stat, p_value <span class="op">=</span> proportions_ztest(count, nobs)</span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Z-score: </span><span class="sc">{</span>stat<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"P-value: </span><span class="sc">{</span>p_value<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a><span class="co"># Determine statistical significance</span></span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a>alpha <span class="op">=</span> <span class="fl">0.05</span></span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> p_value <span class="op">&lt;</span> alpha:</span>
<span id="cb7-59"><a href="#cb7-59" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"The difference in completion rates between the two checkout processes is statistically significant."</span>)</span>
<span id="cb7-60"><a href="#cb7-60" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb7-61"><a href="#cb7-61" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"The difference in completion rates between the two checkout processes is not statistically significant."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Completion Rate for Original Checkout Process: 59.87%
Completion Rate for New Checkout Process: 74.87%
Z-score: -8.761301842485425
P-value: 1.9300821685769852e-18
The difference in completion rates between the two checkout processes is statistically significant.</code></pre>
</div>
</div>
<hr>
</section>
</section>
</section>
<section id="sequential-testing" class="level3">
<h3 class="anchored" data-anchor-id="sequential-testing">Sequential Testing</h3>
<ul>
<li><p><strong>Definition</strong>: Sequential testing allows for continuous monitoring and analysis of results as data is collected, making decisions about the experiment based on interim results.</p></li>
<li><p><strong>Example</strong>: Monitoring the performance of a new advertisement in real-time and deciding to stop the test early if it is clearly outperforming the current ad.</p></li>
</ul>
<section id="scenario-monitoring-a-new-advertisement" class="level4">
<h4 class="anchored" data-anchor-id="scenario-monitoring-a-new-advertisement">Scenario: Monitoring a New Advertisement</h4>
<p>Let’s assume Facebook wants to monitor the performance of a new advertisement in real-time and decide whether to stop the test early if it is clearly outperforming the current ad.</p>
<section id="ads-to-test" class="level5">
<h5 class="anchored" data-anchor-id="ads-to-test">Ads to Test</h5>
<ul>
<li><strong>Current Ad</strong>: <a href="current_ad">current_ad</a></li>
<li><strong>New Ad</strong>: <a href="new_ad">new_ad</a></li>
</ul>
</section>
<section id="objective-4" class="level5">
<h5 class="anchored" data-anchor-id="objective-4">Objective</h5>
<p>Continuously monitor the click-through rate (CTR) of both ads and decide whether to stop the test early if the new ad is significantly outperforming the current ad.</p>
<div id="bb8a0af4" class="cell" data-execution_count="5">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.stats.proportion <span class="im">import</span> proportions_ztest</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate streaming data of user interactions with ads</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">0</span>)  <span class="co"># For reproducibility</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="dv">5000</span>  <span class="co"># Total number of users</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>batch_size <span class="op">=</span> <span class="dv">500</span>  <span class="co"># Size of each batch of data</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>current_ctr <span class="op">=</span> <span class="fl">0.02</span>  <span class="co"># Click-through rate for current ad</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>new_ctr <span class="op">=</span> <span class="fl">0.03</span>  <span class="co"># Click-through rate for new ad</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize counters</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>current_ad_clicks <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>current_ad_impressions <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>new_ad_clicks <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>new_ad_impressions <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Sequential testing</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>stop_test <span class="op">=</span> <span class="va">False</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> batch <span class="kw">in</span> <span class="bu">range</span>(n <span class="op">//</span> batch_size):</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> stop_test:</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Simulate a batch of data</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>    current_batch_impressions <span class="op">=</span> np.random.binomial(batch_size, <span class="fl">0.5</span>)</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>    new_batch_impressions <span class="op">=</span> batch_size <span class="op">-</span> current_batch_impressions</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>    current_batch_clicks <span class="op">=</span> np.random.binomial(current_batch_impressions, current_ctr)</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>    new_batch_clicks <span class="op">=</span> np.random.binomial(new_batch_impressions, new_ctr)</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update counters</span></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>    current_ad_impressions <span class="op">+=</span> current_batch_impressions</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>    new_ad_impressions <span class="op">+=</span> new_batch_impressions</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>    current_ad_clicks <span class="op">+=</span> current_batch_clicks</span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>    new_ad_clicks <span class="op">+=</span> new_batch_clicks</span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate interim CTRs</span></span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>    current_ad_ctr <span class="op">=</span> current_ad_clicks <span class="op">/</span> current_ad_impressions</span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>    new_ad_ctr <span class="op">=</span> new_ad_clicks <span class="op">/</span> new_ad_impressions</span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Perform z-test for proportions</span></span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>    count <span class="op">=</span> np.array([current_ad_clicks, new_ad_clicks])</span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>    nobs <span class="op">=</span> np.array([current_ad_impressions, new_ad_impressions])</span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a>    stat, p_value <span class="op">=</span> proportions_ztest(count, nobs)</span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Batch </span><span class="sc">{</span>batch <span class="op">+</span> <span class="dv">1</span><span class="sc">}</span><span class="ss">:"</span>)</span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Current Ad CTR: </span><span class="sc">{</span>current_ad_ctr<span class="sc">:.2%}</span><span class="ss">"</span>)</span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"New Ad CTR: </span><span class="sc">{</span>new_ad_ctr<span class="sc">:.2%}</span><span class="ss">"</span>)</span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Z-score: </span><span class="sc">{</span>stat<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"P-value: </span><span class="sc">{</span>p_value<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check if the p-value is less than the significance level (alpha = 0.05)</span></span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> p_value <span class="op">&lt;</span> <span class="fl">0.05</span>:</span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"The new ad is significantly outperforming the current ad. Stopping the test early."</span>)</span>
<span id="cb9-55"><a href="#cb9-55" aria-hidden="true" tabindex="-1"></a>        stop_test <span class="op">=</span> <span class="va">True</span></span>
<span id="cb9-56"><a href="#cb9-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-57"><a href="#cb9-57" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="kw">not</span> stop_test:</span>
<span id="cb9-58"><a href="#cb9-58" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"The test did not reach significance. Continue collecting data."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Batch 1:
Current Ad CTR: 1.98%
New Ad CTR: 3.24%
Z-score: -0.89
P-value: 0.3751
Batch 2:
Current Ad CTR: 1.79%
New Ad CTR: 3.82%
Z-score: -1.95
P-value: 0.0513
Batch 3:
Current Ad CTR: 1.46%
New Ad CTR: 3.07%
Z-score: -2.10
P-value: 0.0360
The new ad is significantly outperforming the current ad. Stopping the test early.</code></pre>
</div>
</div>
<hr>
</section>
</section>
</section>
<section id="bandit-algorithms" class="level3">
<h3 class="anchored" data-anchor-id="bandit-algorithms">Bandit Algorithms</h3>
<ul>
<li><strong>Definition</strong>: Bandit algorithms dynamically allocate traffic to different versions based on their performance, aiming to maximize overall outcomes.</li>
</ul>
<section id="epsilon-greedy" class="level4">
<h4 class="anchored" data-anchor-id="epsilon-greedy">Epsilon-Greedy</h4>
<ul>
<li><p><strong>Definition</strong>: The epsilon-greedy algorithm explores all versions with a small probability (epsilon) but mostly exploits the version with the best observed performance.</p></li>
<li><p><strong>Example</strong>: Allocating 10% of traffic to explore different versions of a webpage, while 90% of traffic is directed to the current best-performing version.</p></li>
</ul>
</section>
<section id="scenario-allocating-traffic-to-different-versions-of-a-webpage" class="level4">
<h4 class="anchored" data-anchor-id="scenario-allocating-traffic-to-different-versions-of-a-webpage">Scenario: Allocating Traffic to Different Versions of a Webpage</h4>
<p>Let’s assume Facebook wants to allocate 10% of traffic to explore different versions of a webpage, while 90% of traffic is directed to the current best-performing version.</p>
<section id="versions-to-test" class="level5">
<h5 class="anchored" data-anchor-id="versions-to-test">Versions to Test</h5>
<ul>
<li><strong>Version A</strong>: <a href="version_a">version_a</a></li>
<li><strong>Version B</strong>: <a href="version_b">version_b</a></li>
<li><strong>Version C</strong>: <a href="version_c">version_c</a></li>
</ul>
</section>
<section id="objective-5" class="level5">
<h5 class="anchored" data-anchor-id="objective-5">Objective</h5>
<p>Use the epsilon-greedy algorithm to dynamically allocate traffic to the different versions based on their performance, aiming to maximize the overall click-through rate (CTR).</p>
<div id="d5c23a9f" class="cell" data-execution_count="6">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the versions</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>versions <span class="op">=</span> [<span class="st">'A'</span>, <span class="st">'B'</span>, <span class="st">'C'</span>]</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize counters</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>clicks <span class="op">=</span> {version: <span class="dv">0</span> <span class="cf">for</span> version <span class="kw">in</span> versions}</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>impressions <span class="op">=</span> {version: <span class="dv">0</span> <span class="cf">for</span> version <span class="kw">in</span> versions}</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the epsilon value</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>epsilon <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate user interactions</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">0</span>)</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>n_users <span class="op">=</span> <span class="dv">10000</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>true_ctrs <span class="op">=</span> {<span class="st">'A'</span>: <span class="fl">0.04</span>, <span class="st">'B'</span>: <span class="fl">0.05</span>, <span class="st">'C'</span>: <span class="fl">0.03</span>}</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> []</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> user_id <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, n_users <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Decide whether to explore or exploit</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> np.random.rand() <span class="op">&lt;</span> epsilon:</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Explore: randomly select a version</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>        selected_version <span class="op">=</span> np.random.choice(versions)</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Exploit: select the version with the highest observed CTR</span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>        ctrs <span class="op">=</span> {version: clicks[version] <span class="op">/</span> impressions[version] <span class="cf">if</span> impressions[version] <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="dv">0</span> <span class="cf">for</span> version <span class="kw">in</span> versions}</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>        selected_version <span class="op">=</span> <span class="bu">max</span>(ctrs, key<span class="op">=</span>ctrs.get)</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Simulate whether the user clicks based on the true CTR of the selected version</span></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>    click <span class="op">=</span> np.random.rand() <span class="op">&lt;</span> true_ctrs[selected_version]</span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update counters</span></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>    impressions[selected_version] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>    clicks[selected_version] <span class="op">+=</span> <span class="bu">int</span>(click)</span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Collect data</span></span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>    data.append([user_id, selected_version, click])</span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a DataFrame</span></span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(data, columns<span class="op">=</span>[<span class="st">'user_id'</span>, <span class="st">'version'</span>, <span class="st">'click'</span>])</span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the final observed CTR for each version</span></span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>final_ctrs <span class="op">=</span> {version: clicks[version] <span class="op">/</span> impressions[version] <span class="cf">for</span> version <span class="kw">in</span> versions}</span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Final observed CTRs:"</span>)</span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> version, ctr <span class="kw">in</span> final_ctrs.items():</span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Version </span><span class="sc">{</span>version<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>ctr<span class="sc">:.2%}</span><span class="ss">"</span>)</span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Determine the best-performing version</span></span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a>best_version <span class="op">=</span> <span class="bu">max</span>(final_ctrs, key<span class="op">=</span>final_ctrs.get)</span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The best-performing version is: </span><span class="sc">{</span>best_version<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Final observed CTRs:
Version A: 3.84%
Version B: 5.46%
Version C: 3.73%
The best-performing version is: B</code></pre>
</div>
</div>
</section>
</section>
<section id="explanation" class="level4">
<h4 class="anchored" data-anchor-id="explanation">Explanation</h4>
<section id="data-simulation" class="level5">
<h5 class="anchored" data-anchor-id="data-simulation">Data Simulation</h5>
<p>The code simulates user interactions with three different versions of a webpage. Each user is either assigned to a version based on exploration (10% chance) or exploitation (90% chance).</p>
</section>
<section id="epsilon-greedy-algorithm" class="level5">
<h5 class="anchored" data-anchor-id="epsilon-greedy-algorithm">Epsilon-Greedy Algorithm</h5>
<section id="exploration" class="level6">
<h6 class="anchored" data-anchor-id="exploration">Exploration</h6>
<ul>
<li>With a probability of epsilon (0.1), a version is randomly selected to gather more data.</li>
</ul>
</section>
<section id="exploitation" class="level6">
<h6 class="anchored" data-anchor-id="exploitation">Exploitation</h6>
<ul>
<li>With a probability of 1 - epsilon (0.9), the version with the highest observed click-through rate (CTR) so far is selected.</li>
</ul>
</section>
<section id="updating-counters" class="level6">
<h6 class="anchored" data-anchor-id="updating-counters">Updating Counters</h6>
<ul>
<li>The code updates the counters for clicks and impressions for each version after each user interaction.</li>
</ul>
</section>
</section>
<section id="calculating-final-ctrs" class="level5">
<h5 class="anchored" data-anchor-id="calculating-final-ctrs">Calculating Final CTRs</h5>
<p>The final observed CTR for each version is calculated by dividing the total number of clicks by the total number of impressions for each version.</p>
<p><span class="math display">\[
CTR = \frac{\text{Total Clicks}}{\text{Total Impressions}}
\]</span></p>
</section>
<section id="determining-the-best-performing-version" class="level5">
<h5 class="anchored" data-anchor-id="determining-the-best-performing-version">Determining the Best-Performing Version</h5>
<p>The version with the highest observed CTR is identified as the best-performing version.</p>
<hr>
</section>
</section>
<section id="thompson-sampling" class="level4">
<h4 class="anchored" data-anchor-id="thompson-sampling">Thompson Sampling</h4>
<ul>
<li><p><strong>Definition</strong>: Thompson sampling uses Bayesian probability to balance exploration and exploitation, choosing versions based on the probability of being the best option.</p></li>
<li><p><strong>Example</strong>: Continuously updating beliefs about which ad campaign is most effective based on conversion data, and allocating more traffic to the most promising campaigns.</p></li>
</ul>
</section>
<section id="scenario-allocating-traffic-to-different-ad-campaigns" class="level4">
<h4 class="anchored" data-anchor-id="scenario-allocating-traffic-to-different-ad-campaigns">Scenario: Allocating Traffic to Different Ad Campaigns</h4>
<p>Let’s assume Instagram wants to allocate traffic to different ad campaigns and continuously update their beliefs about which campaign is most effective based on conversion data.</p>
<section id="ad-campaigns-to-test" class="level5">
<h5 class="anchored" data-anchor-id="ad-campaigns-to-test">Ad Campaigns to Test</h5>
<ul>
<li><strong>Campaign A</strong>: <a href="campaign_a">campaign_a</a></li>
<li><strong>Campaign B</strong>: <a href="campaign_b">campaign_b</a></li>
<li><strong>Campaign C</strong>: <a href="campaign_c">campaign_c</a></li>
</ul>
</section>
<section id="objective-6" class="level5">
<h5 class="anchored" data-anchor-id="objective-6">Objective</h5>
<p>Use Thompson sampling to dynamically allocate traffic to the different ad campaigns based on the probability of each being the best option, aiming to maximize the overall conversion rate.</p>
<div id="6fe65678" class="cell" data-execution_count="7">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the campaigns</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>campaigns <span class="op">=</span> [<span class="st">'A'</span>, <span class="st">'B'</span>, <span class="st">'C'</span>]</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co"># True conversion rates for each campaign (unknown in real scenario)</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>true_conversion_rates <span class="op">=</span> {<span class="st">'A'</span>: <span class="fl">0.05</span>, <span class="st">'B'</span>: <span class="fl">0.07</span>, <span class="st">'C'</span>: <span class="fl">0.04</span>}</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize parameters for the Beta distribution</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>successes <span class="op">=</span> {campaign: <span class="dv">1</span> <span class="cf">for</span> campaign <span class="kw">in</span> campaigns}  <span class="co"># Prior success count (alpha)</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>failures <span class="op">=</span> {campaign: <span class="dv">1</span> <span class="cf">for</span> campaign <span class="kw">in</span> campaigns}   <span class="co"># Prior failure count (beta)</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate user interactions</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">0</span>)</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>n_users <span class="op">=</span> <span class="dv">10000</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> []</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> user_id <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, n_users <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Sample from the Beta distribution for each campaign</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>    sampled_probs <span class="op">=</span> {campaign: np.random.beta(successes[campaign], failures[campaign]) <span class="cf">for</span> campaign <span class="kw">in</span> campaigns}</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Select the campaign with the highest sampled probability</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>    selected_campaign <span class="op">=</span> <span class="bu">max</span>(sampled_probs, key<span class="op">=</span>sampled_probs.get)</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Simulate whether the user converts based on the true conversion rate of the selected campaign</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>    conversion <span class="op">=</span> np.random.rand() <span class="op">&lt;</span> true_conversion_rates[selected_campaign]</span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update the Beta distribution parameters</span></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> conversion:</span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>        successes[selected_campaign] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>        failures[selected_campaign] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Collect data</span></span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>    data.append([user_id, selected_campaign, conversion])</span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a DataFrame</span></span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(data, columns<span class="op">=</span>[<span class="st">'user_id'</span>, <span class="st">'campaign'</span>, <span class="st">'conversion'</span>])</span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the final observed conversion rate for each campaign</span></span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a>final_conversion_rates <span class="op">=</span> {campaign: df[df[<span class="st">'campaign'</span>] <span class="op">==</span> campaign][<span class="st">'conversion'</span>].mean() <span class="cf">for</span> campaign <span class="kw">in</span> campaigns}</span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Final observed conversion rates:"</span>)</span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> campaign, rate <span class="kw">in</span> final_conversion_rates.items():</span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Campaign </span><span class="sc">{</span>campaign<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>rate<span class="sc">:.2%}</span><span class="ss">"</span>)</span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Determine the best-performing campaign</span></span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a>best_campaign <span class="op">=</span> <span class="bu">max</span>(final_conversion_rates, key<span class="op">=</span>final_conversion_rates.get)</span>
<span id="cb13-52"><a href="#cb13-52" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The best-performing campaign is: </span><span class="sc">{</span>best_campaign<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb13-53"><a href="#cb13-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-54"><a href="#cb13-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the final Beta distributions</span></span>
<span id="cb13-55"><a href="#cb13-55" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="fl">0.2</span>, <span class="dv">100</span>)</span>
<span id="cb13-56"><a href="#cb13-56" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> campaign <span class="kw">in</span> campaigns:</span>
<span id="cb13-57"><a href="#cb13-57" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> np.random.beta(successes[campaign], failures[campaign], size<span class="op">=</span><span class="dv">10000</span>)</span>
<span id="cb13-58"><a href="#cb13-58" aria-hidden="true" tabindex="-1"></a>    plt.hist(y, bins<span class="op">=</span><span class="dv">100</span>, alpha<span class="op">=</span><span class="fl">0.5</span>, label<span class="op">=</span><span class="ss">f'Campaign </span><span class="sc">{</span>campaign<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb13-59"><a href="#cb13-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-60"><a href="#cb13-60" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Conversion Rate'</span>)</span>
<span id="cb13-61"><a href="#cb13-61" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Frequency'</span>)</span>
<span id="cb13-62"><a href="#cb13-62" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Posterior Distributions of Conversion Rates'</span>)</span>
<span id="cb13-63"><a href="#cb13-63" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb13-64"><a href="#cb13-64" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Final observed conversion rates:
Campaign A: 5.73%
Campaign B: 6.33%
Campaign C: 3.31%
The best-performing campaign is: B</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="11_experimental_design_files/figure-html/cell-8-output-2.png" width="598" height="449" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="explanation-1" class="level4">
<h4 class="anchored" data-anchor-id="explanation-1">Explanation</h4>
<section id="data-simulation-1" class="level5">
<h5 class="anchored" data-anchor-id="data-simulation-1">Data Simulation</h5>
<p>The code simulates user interactions with three different ad campaigns. Each user is assigned to a campaign based on the Thompson sampling algorithm, which uses Bayesian probability to balance exploration and exploitation.</p>
</section>
<section id="thompson-sampling-algorithm" class="level5">
<h5 class="anchored" data-anchor-id="thompson-sampling-algorithm">Thompson Sampling Algorithm</h5>
<section id="beta-distribution" class="level6">
<h6 class="anchored" data-anchor-id="beta-distribution">Beta Distribution</h6>
<ul>
<li>The algorithm maintains a Beta distribution for each campaign, representing the probability of conversion. The Beta distribution is parameterized by the number of successes (conversions) and failures (non-conversions).</li>
</ul>
<p><span class="math display">\[
\text{Beta}(\alpha, \beta)
\]</span> where <span class="math inline">\(\alpha\)</span> is the number of conversions (successes) + 1, and <span class="math inline">\(\beta\)</span> is the number of non-conversions (failures) + 1.</p>
</section>
<section id="sampling" class="level6">
<h6 class="anchored" data-anchor-id="sampling">Sampling</h6>
<ul>
<li>For each user, the algorithm samples a conversion probability from the Beta distribution of each campaign.</li>
</ul>
</section>
<section id="selection" class="level6">
<h6 class="anchored" data-anchor-id="selection">Selection</h6>
<ul>
<li>The campaign with the highest sampled probability is selected for the user.</li>
</ul>
</section>
<section id="updating-parameters" class="level6">
<h6 class="anchored" data-anchor-id="updating-parameters">Updating Parameters</h6>
<ul>
<li>After each user interaction, the algorithm updates the parameters of the Beta distribution for the selected campaign based on whether the user converted or not.</li>
</ul>
</section>
</section>
<section id="calculating-final-conversion-rates" class="level5">
<h5 class="anchored" data-anchor-id="calculating-final-conversion-rates">Calculating Final Conversion Rates</h5>
<p>The final observed conversion rate for each campaign is calculated by dividing the total number of conversions by the total number of impressions for each campaign.</p>
<p><span class="math display">\[
\text{Conversion Rate} = \frac{\text{Total Conversions}}{\text{Total Impressions}}
\]</span></p>
</section>
<section id="determining-the-best-performing-campaign" class="level5">
<h5 class="anchored" data-anchor-id="determining-the-best-performing-campaign">Determining the Best-Performing Campaign</h5>
<p>The campaign with the highest observed conversion rate is identified as the best-performing campaign.</p>
</section>
<section id="plotting-beta-distributions" class="level5">
<h5 class="anchored" data-anchor-id="plotting-beta-distributions">Plotting Beta Distributions</h5>
<p>The final Beta distributions for the conversion rates of each campaign are plotted to visualize the probability distributions after all user interactions.</p>
<hr>
</section>
</section>
</section>
<section id="bayesian-ab-testing" class="level3">
<h3 class="anchored" data-anchor-id="bayesian-ab-testing">Bayesian A/B Testing</h3>
<ul>
<li><p><strong>Definition</strong>: Bayesian A/B testing uses Bayesian statistics to update the probability of each version being better as data is collected, providing a probabilistic framework for decision-making.</p></li>
<li><p><strong>Example</strong>: Using prior beliefs about the performance of two website designs and updating these beliefs as user data is collected to decide which design to implement.</p></li>
</ul>
<section id="scenario-testing-two-website-designs" class="level4">
<h4 class="anchored" data-anchor-id="scenario-testing-two-website-designs">Scenario: Testing Two Website Designs</h4>
<p>Let’s assume Instagram wants to test two different website designs (Design A and Design B) and use Bayesian A/B testing to update the probability of each design being better based on user data.</p>
<section id="designs-to-test" class="level5">
<h5 class="anchored" data-anchor-id="designs-to-test">Designs to Test</h5>
<ul>
<li><strong>Design A</strong>: <a href="design_a">design_a</a></li>
<li><strong>Design B</strong>: <a href="design_b">design_b</a></li>
</ul>
</section>
<section id="objective-7" class="level5">
<h5 class="anchored" data-anchor-id="objective-7">Objective</h5>
<p>Use Bayesian A/B testing to update beliefs about the performance of each design and decide which design to implement based on the collected data.</p>
<div id="3ce7a978" class="cell" data-execution_count="8">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the designs</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>designs <span class="op">=</span> [<span class="st">'A'</span>, <span class="st">'B'</span>]</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="co"># True conversion rates for each design (unknown in real scenario)</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>true_conversion_rates <span class="op">=</span> {<span class="st">'A'</span>: <span class="fl">0.04</span>, <span class="st">'B'</span>: <span class="fl">0.05</span>}</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize parameters for the Beta distribution (prior beliefs)</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>alpha_prior <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>beta_prior <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize successes and failures</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>successes <span class="op">=</span> {design: alpha_prior <span class="cf">for</span> design <span class="kw">in</span> designs}</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>failures <span class="op">=</span> {design: beta_prior <span class="cf">for</span> design <span class="kw">in</span> designs}</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate user interactions</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">0</span>)</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>n_users <span class="op">=</span> <span class="dv">10000</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> []</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> user_id <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, n_users <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Randomly assign the user to a design</span></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>    assigned_design <span class="op">=</span> np.random.choice(designs)</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Simulate whether the user converts based on the true conversion rate of the assigned design</span></span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>    conversion <span class="op">=</span> np.random.rand() <span class="op">&lt;</span> true_conversion_rates[assigned_design]</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update the Beta distribution parameters</span></span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> conversion:</span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>        successes[assigned_design] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>        failures[assigned_design] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Collect data</span></span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>    data.append([user_id, assigned_design, conversion])</span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a DataFrame</span></span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(data, columns<span class="op">=</span>[<span class="st">'user_id'</span>, <span class="st">'design'</span>, <span class="st">'conversion'</span>])</span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the final observed conversion rate for each design</span></span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a>final_conversion_rates <span class="op">=</span> {design: df[df[<span class="st">'design'</span>] <span class="op">==</span> design][<span class="st">'conversion'</span>].mean() <span class="cf">for</span> design <span class="kw">in</span> designs}</span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Final observed conversion rates:"</span>)</span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> design, rate <span class="kw">in</span> final_conversion_rates.items():</span>
<span id="cb15-49"><a href="#cb15-49" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Design </span><span class="sc">{</span>design<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>rate<span class="sc">:.2%}</span><span class="ss">"</span>)</span>
<span id="cb15-50"><a href="#cb15-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-51"><a href="#cb15-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the posterior distributions</span></span>
<span id="cb15-52"><a href="#cb15-52" aria-hidden="true" tabindex="-1"></a>posterior_distributions <span class="op">=</span> {design: np.random.beta(successes[design], failures[design], size<span class="op">=</span><span class="dv">10000</span>) <span class="cf">for</span> design <span class="kw">in</span> designs}</span>
<span id="cb15-53"><a href="#cb15-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-54"><a href="#cb15-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Determine the probability that each design is better</span></span>
<span id="cb15-55"><a href="#cb15-55" aria-hidden="true" tabindex="-1"></a>prob_better <span class="op">=</span> (posterior_distributions[<span class="st">'A'</span>] <span class="op">&lt;</span> posterior_distributions[<span class="st">'B'</span>]).mean()</span>
<span id="cb15-56"><a href="#cb15-56" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Probability that Design B is better than Design A: </span><span class="sc">{</span>prob_better<span class="sc">:.2%}</span><span class="ss">"</span>)</span>
<span id="cb15-57"><a href="#cb15-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-58"><a href="#cb15-58" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the posterior distributions</span></span>
<span id="cb15-59"><a href="#cb15-59" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="fl">0.1</span>, <span class="dv">1000</span>)</span>
<span id="cb15-60"><a href="#cb15-60" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> design <span class="kw">in</span> designs:</span>
<span id="cb15-61"><a href="#cb15-61" aria-hidden="true" tabindex="-1"></a>    plt.hist(posterior_distributions[design], bins<span class="op">=</span><span class="dv">100</span>, alpha<span class="op">=</span><span class="fl">0.5</span>, label<span class="op">=</span><span class="ss">f'Design </span><span class="sc">{</span>design<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb15-62"><a href="#cb15-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-63"><a href="#cb15-63" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Conversion Rate'</span>)</span>
<span id="cb15-64"><a href="#cb15-64" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Frequency'</span>)</span>
<span id="cb15-65"><a href="#cb15-65" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Posterior Distributions of Conversion Rates'</span>)</span>
<span id="cb15-66"><a href="#cb15-66" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb15-67"><a href="#cb15-67" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Final observed conversion rates:
Design A: 4.04%
Design B: 5.70%
Probability that Design B is better than Design A: 99.98%</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="11_experimental_design_files/figure-html/cell-9-output-2.png" width="593" height="449" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="explanation-2" class="level4">
<h4 class="anchored" data-anchor-id="explanation-2">Explanation</h4>
<section id="data-simulation-2" class="level5">
<h5 class="anchored" data-anchor-id="data-simulation-2">Data Simulation</h5>
<p>The code simulates user interaction data for 10,000 users. Each user is randomly assigned to one of the two designs, and whether the user converts (e.g., signs up, makes a purchase) is simulated based on the true conversion rates of the designs.</p>
</section>
<section id="beta-distribution-1" class="level5">
<h5 class="anchored" data-anchor-id="beta-distribution-1">Beta Distribution</h5>
<p>The algorithm maintains a Beta distribution for each design, representing the probability of conversion. The Beta distribution is parameterized by the number of successes (conversions) and failures (non-conversions).</p>
<p><span class="math display">\[
\text{Beta}(\alpha, \beta)
\]</span> where <span class="math inline">\(\alpha\)</span> is the number of conversions (successes) + 1, and <span class="math inline">\(\beta\)</span> is the number of non-conversions (failures) + 1.</p>
</section>
<section id="updating-parameters-1" class="level5">
<h5 class="anchored" data-anchor-id="updating-parameters-1">Updating Parameters</h5>
<p>After each user interaction, the algorithm updates the parameters of the Beta distribution for the assigned design based on whether the user converted or not.</p>
</section>
<section id="calculating-final-conversion-rates-1" class="level5">
<h5 class="anchored" data-anchor-id="calculating-final-conversion-rates-1">Calculating Final Conversion Rates</h5>
<p>The final observed conversion rate for each design is calculated by dividing the total number of conversions by the total number of impressions for each design.</p>
<p><span class="math display">\[
\text{Conversion Rate} = \frac{\text{Total Conversions}}{\text{Total Impressions}}
\]</span></p>
</section>
<section id="posterior-distributions" class="level5">
<h5 class="anchored" data-anchor-id="posterior-distributions">Posterior Distributions</h5>
<p>The posterior distributions for the conversion rates of each design are calculated using the updated parameters of the Beta distributions.</p>
</section>
<section id="probability-of-being-better" class="level5">
<h5 class="anchored" data-anchor-id="probability-of-being-better">Probability of Being Better</h5>
<p>The probability that Design B is better than Design A is calculated by comparing samples from the posterior distributions of the two designs.</p>
</section>
<section id="plotting-beta-distributions-1" class="level5">
<h5 class="anchored" data-anchor-id="plotting-beta-distributions-1">Plotting Beta Distributions</h5>
<p>The final Beta distributions for the conversion rates of each design are plotted to visualize the probability distributions after all user interactions. This helps in understanding the likelihood of each design being the better option based on the collected data.</p>
<hr>
</section>
</section>
</section>
<section id="frequentist-vs.-bayesian-approaches" class="level3">
<h3 class="anchored" data-anchor-id="frequentist-vs.-bayesian-approaches">Frequentist vs.&nbsp;Bayesian Approaches</h3>
<ul>
<li><p><strong>Definition</strong>: Frequentist approaches rely on fixed sample sizes and p-values, while Bayesian approaches update beliefs based on prior distributions and observed data.</p></li>
<li><p><strong>Example</strong>: A frequentist A/B test might be designed to collect data until a predefined sample size is reached, whereas a Bayesian A/B test would continuously update the probability that one version is better than the other based on incoming data.</p></li>
</ul>
<section id="scenario-testing-two-website-designs-1" class="level4">
<h4 class="anchored" data-anchor-id="scenario-testing-two-website-designs-1">Scenario: Testing Two Website Designs</h4>
<p>Let’s assume Instagram wants to test two different website designs (Design A and Design B) and compare the Frequentist and Bayesian approaches to decide which design to implement based on user data.</p>
<section id="designs-to-test-1" class="level5">
<h5 class="anchored" data-anchor-id="designs-to-test-1">Designs to Test</h5>
<ul>
<li><strong>Design A</strong>: <a href="design_a">design_a</a></li>
<li><strong>Design B</strong>: <a href="design_b">design_b</a></li>
</ul>
</section>
<section id="objective-8" class="level5">
<h5 class="anchored" data-anchor-id="objective-8">Objective</h5>
<p>Compare the Frequentist and Bayesian approaches in terms of how they handle the decision-making process based on user data.</p>
</section>
<section id="frequentist-approach" class="level5">
<h5 class="anchored" data-anchor-id="frequentist-approach">Frequentist Approach</h5>
<div id="b6047592" class="cell" data-execution_count="9">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.stats.proportion <span class="im">import</span> proportions_ztest</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate user interactions</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">0</span>)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>n_users <span class="op">=</span> <span class="dv">10000</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>true_conversion_rates <span class="op">=</span> {<span class="st">'A'</span>: <span class="fl">0.04</span>, <span class="st">'B'</span>: <span class="fl">0.05</span>}</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> []</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> user_id <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, n_users <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>    assigned_design <span class="op">=</span> np.random.choice([<span class="st">'A'</span>, <span class="st">'B'</span>])</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>    conversion <span class="op">=</span> np.random.rand() <span class="op">&lt;</span> true_conversion_rates[assigned_design]</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>    data.append([user_id, assigned_design, conversion])</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a DataFrame</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(data, columns<span class="op">=</span>[<span class="st">'user_id'</span>, <span class="st">'design'</span>, <span class="st">'conversion'</span>])</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate conversion rates</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>conversion_rate_A <span class="op">=</span> df[df[<span class="st">'design'</span>] <span class="op">==</span> <span class="st">'A'</span>][<span class="st">'conversion'</span>].mean()</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>conversion_rate_B <span class="op">=</span> df[df[<span class="st">'design'</span>] <span class="op">==</span> <span class="st">'B'</span>][<span class="st">'conversion'</span>].mean()</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform a two-proportion z-test</span></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>count <span class="op">=</span> np.array([df[df[<span class="st">'design'</span>] <span class="op">==</span> <span class="st">'A'</span>][<span class="st">'conversion'</span>].<span class="bu">sum</span>(), df[df[<span class="st">'design'</span>] <span class="op">==</span> <span class="st">'B'</span>][<span class="st">'conversion'</span>].<span class="bu">sum</span>()])</span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>nobs <span class="op">=</span> np.array([df[df[<span class="st">'design'</span>] <span class="op">==</span> <span class="st">'A'</span>].shape[<span class="dv">0</span>], df[df[<span class="st">'design'</span>] <span class="op">==</span> <span class="st">'B'</span>].shape[<span class="dv">0</span>]])</span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>z_score, p_value <span class="op">=</span> proportions_ztest(count, nobs)</span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Conversion Rate for Design A: </span><span class="sc">{</span>conversion_rate_A<span class="sc">:.2%}</span><span class="ss">"</span>)</span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Conversion Rate for Design B: </span><span class="sc">{</span>conversion_rate_B<span class="sc">:.2%}</span><span class="ss">"</span>)</span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Z-score: </span><span class="sc">{</span>z_score<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"P-value: </span><span class="sc">{</span>p_value<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>alpha <span class="op">=</span> <span class="fl">0.05</span></span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> p_value <span class="op">&lt;</span> alpha:</span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"The difference in conversion rates is statistically significant. Design B is better."</span>)</span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"The difference in conversion rates is not statistically significant. No conclusive winner."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Conversion Rate for Design A: 4.04%
Conversion Rate for Design B: 5.70%
Z-score: -3.86
P-value: 0.0001
The difference in conversion rates is statistically significant. Design B is better.</code></pre>
</div>
</div>
</section>
<section id="bayesian-approach" class="level5">
<h5 class="anchored" data-anchor-id="bayesian-approach">Bayesian Approach</h5>
<div id="3ca25866" class="cell" data-execution_count="10">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize parameters for the Beta distribution (prior beliefs)</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>alpha_prior <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>beta_prior <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize successes and failures</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>successes <span class="op">=</span> {<span class="st">'A'</span>: alpha_prior, <span class="st">'B'</span>: alpha_prior}</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>failures <span class="op">=</span> {<span class="st">'A'</span>: beta_prior, <span class="st">'B'</span>: beta_prior}</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate user interactions</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">0</span>)</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>n_users <span class="op">=</span> <span class="dv">10000</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>true_conversion_rates <span class="op">=</span> {<span class="st">'A'</span>: <span class="fl">0.04</span>, <span class="st">'B'</span>: <span class="fl">0.05</span>}</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> []</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> user_id <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, n_users <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>    assigned_design <span class="op">=</span> np.random.choice([<span class="st">'A'</span>, <span class="st">'B'</span>])</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>    conversion <span class="op">=</span> np.random.rand() <span class="op">&lt;</span> true_conversion_rates[assigned_design]</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> conversion:</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>        successes[assigned_design] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>        failures[assigned_design] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>    data.append([user_id, assigned_design, conversion])</span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a DataFrame</span></span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(data, columns<span class="op">=</span>[<span class="st">'user_id'</span>, <span class="st">'design'</span>, <span class="st">'conversion'</span>])</span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the posterior distributions</span></span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>posterior_distributions <span class="op">=</span> {design: np.random.beta(successes[design], failures[design], size<span class="op">=</span><span class="dv">10000</span>) <span class="cf">for</span> design <span class="kw">in</span> [<span class="st">'A'</span>, <span class="st">'B'</span>]}</span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Determine the probability that each design is better</span></span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>prob_B_better_than_A <span class="op">=</span> (posterior_distributions[<span class="st">'A'</span>] <span class="op">&lt;</span> posterior_distributions[<span class="st">'B'</span>]).mean()</span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Probability that Design B is better than Design A: </span><span class="sc">{</span>prob_B_better_than_A<span class="sc">:.2%}</span><span class="ss">"</span>)</span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the posterior distributions</span></span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="fl">0.1</span>, <span class="dv">1000</span>)</span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> design <span class="kw">in</span> [<span class="st">'A'</span>, <span class="st">'B'</span>]:</span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a>    plt.hist(posterior_distributions[design], bins<span class="op">=</span><span class="dv">100</span>, alpha<span class="op">=</span><span class="fl">0.5</span>, label<span class="op">=</span><span class="ss">f'Design </span><span class="sc">{</span>design<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Conversion Rate'</span>)</span>
<span id="cb19-45"><a href="#cb19-45" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Frequency'</span>)</span>
<span id="cb19-46"><a href="#cb19-46" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Posterior Distributions of Conversion Rates'</span>)</span>
<span id="cb19-47"><a href="#cb19-47" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb19-48"><a href="#cb19-48" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Probability that Design B is better than Design A: 99.98%</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="11_experimental_design_files/figure-html/cell-11-output-2.png" width="593" height="449" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="explanation-3" class="level5">
<h5 class="anchored" data-anchor-id="explanation-3">Explanation</h5>
<section id="frequentist-approach-1" class="level6">
<h6 class="anchored" data-anchor-id="frequentist-approach-1">Frequentist Approach</h6>
<p><strong>Data Simulation</strong>: User interactions are simulated, assigning each user to one of the two designs and recording whether they convert.</p>
<p><strong>Conversion Rate Calculation</strong>: The conversion rates for both designs are calculated.</p>
<p><strong>Two-Proportion Z-Test</strong>: A z-test for proportions is performed to determine if the difference in conversion rates is statistically significant, based on a predefined significance level (alpha = 0.05).</p>
<p><strong>Results Interpretation</strong>: If the p-value is less than alpha, the difference in conversion rates is considered statistically significant, indicating a winner.</p>
</section>
<section id="bayesian-approach-1" class="level6">
<h6 class="anchored" data-anchor-id="bayesian-approach-1">Bayesian Approach</h6>
<p><strong>Data Simulation</strong>: User interactions are simulated similarly to the frequentist approach.</p>
<p><strong>Beta Distribution</strong>: The algorithm maintains a Beta distribution for each design, representing the probability of conversion. The Beta distribution is updated with each user interaction.</p>
<p><strong>Posterior Distributions</strong>: The posterior distributions for the conversion rates of each design are calculated using the updated parameters of the Beta distributions.</p>
<p><strong>Probability of Being Better</strong>: The probability that Design B is better than Design A is calculated by comparing samples from the posterior distributions of the two designs.</p>
<p><strong>Results Interpretation</strong>: The final probabilities and posterior distributions provide a probabilistic framework for decision-making, updating beliefs about the performance of each design based on the observed data.</p>
<p>This example highlights the key differences between the frequentist and Bayesian approaches in handling A/B testing and decision-making processes.</p>
<hr>
</section>
</section>
</section>
</section>
</section>
<section id="factorial-designs" class="level2">
<h2 class="anchored" data-anchor-id="factorial-designs">Factorial Designs</h2>
<p>Factorial designs test multiple factors simultaneously, understanding the effects of each factor and their interactions.</p>
<section id="two-factor-factorial-designs" class="level3">
<h3 class="anchored" data-anchor-id="two-factor-factorial-designs">Two-Factor Factorial Designs</h3>
<ul>
<li><p><strong>Definition</strong>: Two-factor factorial designs involve two independent variables, each at multiple levels, allowing for the assessment of main effects and interactions.</p></li>
<li><p><strong>Example</strong>: Testing the effect of different dosages of a drug (factor 1) and different frequencies of administration (factor 2) on patient outcomes.</p></li>
</ul>
<section id="scenario-testing-the-effect-of-image-styles-and-post-times-on-user-engagement" class="level4">
<h4 class="anchored" data-anchor-id="scenario-testing-the-effect-of-image-styles-and-post-times-on-user-engagement">Scenario: Testing the Effect of Image Styles and Post Times on User Engagement</h4>
<p>Let’s assume Instagram wants to test the effect of different image styles and different post times on user engagement (likes and comments).</p>
<section id="factors-to-test" class="level5">
<h5 class="anchored" data-anchor-id="factors-to-test">Factors to Test</h5>
<ul>
<li><strong>Factor 1 (Image Style)</strong>: style_a, style_b</li>
<li><strong>Factor 2 (Post Time)</strong>: morning, evening</li>
</ul>
</section>
<section id="objective-9" class="level5">
<h5 class="anchored" data-anchor-id="objective-9">Objective</h5>
<p>Use a two-factor factorial design to assess the main effects and interactions between image styles and post times on user engagement.</p>
<div id="3ec800d9" class="cell" data-execution_count="11">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.formula.api <span class="im">import</span> ols</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the levels for each factor</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>image_styles <span class="op">=</span> [<span class="st">'style_a'</span>, <span class="st">'style_b'</span>]</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>post_times <span class="op">=</span> [<span class="st">'morning'</span>, <span class="st">'evening'</span>]</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate user engagement data</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">0</span>)</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>n_samples <span class="op">=</span> <span class="dv">100</span>  <span class="co"># Number of samples per combination</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> []</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> style <span class="kw">in</span> image_styles:</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> time <span class="kw">in</span> post_times:</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(n_samples):</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>            engagement <span class="op">=</span> np.random.normal(loc<span class="op">=</span>(<span class="dv">10</span> <span class="cf">if</span> style <span class="op">==</span> <span class="st">'style_a'</span> <span class="cf">else</span> <span class="dv">15</span>) <span class="op">+</span> (<span class="dv">5</span> <span class="cf">if</span> time <span class="op">==</span> <span class="st">'morning'</span> <span class="cf">else</span> <span class="dv">10</span>), scale<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>            data.append([style, time, engagement])</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a DataFrame</span></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(data, columns<span class="op">=</span>[<span class="st">'image_style'</span>, <span class="st">'post_time'</span>, <span class="st">'engagement'</span>])</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform ANOVA</span></span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ols(<span class="st">'engagement ~ C(image_style) * C(post_time)'</span>, data<span class="op">=</span>df).fit()</span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>anova_table <span class="op">=</span> sm.stats.anova_lm(model, typ<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(anova_table)</span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the interaction</span></span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>interaction_plot <span class="op">=</span> sns.pointplot(x<span class="op">=</span><span class="st">'image_style'</span>, y<span class="op">=</span><span class="st">'engagement'</span>, hue<span class="op">=</span><span class="st">'post_time'</span>, data<span class="op">=</span>df, markers<span class="op">=</span>[<span class="st">"o"</span>, <span class="st">"s"</span>], linestyles<span class="op">=</span>[<span class="st">"-"</span>, <span class="st">"--"</span>])</span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Interaction Plot'</span>)</span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Engagement'</span>)</span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Image Style'</span>)</span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                  sum_sq     df          F        PR(&gt;F)
C(image_style)               1604.302982    1.0  65.896540  6.069124e-15
C(post_time)                 2219.918656    1.0  91.182875  1.389053e-19
C(image_style):C(post_time)    15.953913    1.0   0.655305  4.187085e-01
Residual                     9640.930846  396.0        NaN           NaN</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="11_experimental_design_files/figure-html/cell-12-output-2.png" width="585" height="449" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="explanation-4" class="level5">
<h5 class="anchored" data-anchor-id="explanation-4">Explanation</h5>
<section id="data-simulation-3" class="level6">
<h6 class="anchored" data-anchor-id="data-simulation-3">Data Simulation</h6>
<p>The code simulates user engagement data (e.g., likes and comments) for different combinations of image styles and post times. Engagement is normally distributed with means that depend on the image style and post time.</p>
</section>
<section id="anova-model" class="level6">
<h6 class="anchored" data-anchor-id="anova-model">ANOVA Model</h6>
<p>An ANOVA (Analysis of Variance) model is used to analyze the data. The formula ‘engagement ~ C(image_style) * C(post_time)’ specifies that the model should consider both main effects (image style and post time) and their interaction.</p>
</section>
<section id="anova-table" class="level6">
<h6 class="anchored" data-anchor-id="anova-table">ANOVA Table</h6>
<p>The ANOVA table summarizes the results of the analysis, including the sum of squares, degrees of freedom, F-statistic, and p-value for each factor and their interaction. Significant p-values (typically p &lt; 0.05) indicate that the factor or interaction has a significant effect on user engagement.</p>
</section>
<section id="interaction-plot" class="level6">
<h6 class="anchored" data-anchor-id="interaction-plot">Interaction Plot</h6>
<p>The interaction plot visually represents the interaction between the two factors. It shows the mean engagement for each combination of image style and post time, helping to identify any interaction effects.</p>
</section>
<section id="interpretation" class="level6">
<h6 class="anchored" data-anchor-id="interpretation">Interpretation</h6>
<p><strong>Main Effects</strong>: The ANOVA table allows you to assess the main effects of image style and post time on user engagement.</p>
<p><strong>Interaction Effects</strong>: The interaction term in the ANOVA table and the interaction plot help identify whether the effect of one factor depends on the level of the other factor.</p>
<p><strong>Practical Implications</strong>: By understanding the main effects and interactions, Instagram can make data-driven decisions about the optimal combination of image styles and post times to maximize user engagement.</p>
<p>This example demonstrates how a two-factor factorial design can be used to test multiple factors simultaneously and understand their individual and combined effects on an outcome of interest.</p>
<hr>
</section>
</section>
</section>
</section>
<section id="three-factor-and-higher-factorial-designs" class="level3">
<h3 class="anchored" data-anchor-id="three-factor-and-higher-factorial-designs">Three-Factor (and Higher) Factorial Designs</h3>
<ul>
<li><p><strong>Definition</strong>: Three-factor designs include three independent variables, and higher-order designs involve more factors, increasing the complexity and potential for interaction effects.</p></li>
<li><p><strong>Example</strong>: Studying the combined effects of drug dosage, frequency of administration, and diet on patient health outcomes.</p></li>
</ul>
<section id="scenario-testing-the-effects-of-image-styles-post-times-and-caption-lengths-on-user-engagement" class="level4">
<h4 class="anchored" data-anchor-id="scenario-testing-the-effects-of-image-styles-post-times-and-caption-lengths-on-user-engagement">Scenario: Testing the Effects of Image Styles, Post Times, and Caption Lengths on User Engagement</h4>
<p>Let’s assume Instagram wants to test the combined effects of different image styles, post times, and caption lengths on user engagement (likes and comments).</p>
<section id="factors-to-test-1" class="level5">
<h5 class="anchored" data-anchor-id="factors-to-test-1">Factors to Test</h5>
<ul>
<li><strong>Factor 1 (Image Style)</strong>: style_a, style_b</li>
<li><strong>Factor 2 (Post Time)</strong>: morning, evening</li>
<li><strong>Factor 3 (Caption Length)</strong>: short, long</li>
</ul>
</section>
<section id="objective-10" class="level5">
<h5 class="anchored" data-anchor-id="objective-10">Objective</h5>
<p>Use a three-factor factorial design to assess the main effects and interactions among image styles, post times, and caption lengths on user engagement.</p>
<div id="e8064080" class="cell" data-execution_count="12">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.formula.api <span class="im">import</span> ols</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the levels for each factor</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>image_styles <span class="op">=</span> [<span class="st">'style_a'</span>, <span class="st">'style_b'</span>]</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>post_times <span class="op">=</span> [<span class="st">'morning'</span>, <span class="st">'evening'</span>]</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>caption_lengths <span class="op">=</span> [<span class="st">'short'</span>, <span class="st">'long'</span>]</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate user engagement data</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">0</span>)</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>n_samples <span class="op">=</span> <span class="dv">50</span>  <span class="co"># Number of samples per combination</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> []</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> style <span class="kw">in</span> image_styles:</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> time <span class="kw">in</span> post_times:</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> length <span class="kw">in</span> caption_lengths:</span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(n_samples):</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>                base_engagement <span class="op">=</span> (<span class="dv">10</span> <span class="cf">if</span> style <span class="op">==</span> <span class="st">'style_a'</span> <span class="cf">else</span> <span class="dv">15</span>) <span class="op">+</span> (<span class="dv">5</span> <span class="cf">if</span> time <span class="op">==</span> <span class="st">'morning'</span> <span class="cf">else</span> <span class="dv">10</span>) <span class="op">+</span> (<span class="dv">3</span> <span class="cf">if</span> length <span class="op">==</span> <span class="st">'short'</span> <span class="cf">else</span> <span class="dv">7</span>)</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>                engagement <span class="op">=</span> np.random.normal(loc<span class="op">=</span>base_engagement, scale<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>                data.append([style, time, length, engagement])</span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a DataFrame</span></span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(data, columns<span class="op">=</span>[<span class="st">'image_style'</span>, <span class="st">'post_time'</span>, <span class="st">'caption_length'</span>, <span class="st">'engagement'</span>])</span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform ANOVA</span></span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ols(<span class="st">'engagement ~ C(image_style) * C(post_time) * C(caption_length)'</span>, data<span class="op">=</span>df).fit()</span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>anova_table <span class="op">=</span> sm.stats.anova_lm(model, typ<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(anova_table)</span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the interaction</span></span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a>interaction_plot <span class="op">=</span> sns.catplot(x<span class="op">=</span><span class="st">'image_style'</span>, y<span class="op">=</span><span class="st">'engagement'</span>, hue<span class="op">=</span><span class="st">'caption_length'</span>, col<span class="op">=</span><span class="st">'post_time'</span>, kind<span class="op">=</span><span class="st">'point'</span>, data<span class="op">=</span>df, markers<span class="op">=</span>[<span class="st">"o"</span>, <span class="st">"s"</span>], linestyles<span class="op">=</span>[<span class="st">"-"</span>, <span class="st">"--"</span>])</span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(top<span class="op">=</span><span class="fl">0.9</span>)</span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a>interaction_plot.fig.suptitle(<span class="st">'Interaction Plot of Image Style, Post Time, and Caption Length'</span>)</span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                                    sum_sq     df          F  \
C(image_style)                                 1604.302982    1.0  65.936571   
C(post_time)                                   2219.918656    1.0  91.238266   
C(caption_length)                              1244.862354    1.0  51.163624   
C(image_style):C(post_time)                      15.953913    1.0   0.655703   
C(image_style):C(caption_length)                 64.742353    1.0   2.660899   
C(post_time):C(caption_length)                   15.643143    1.0   0.642930   
C(image_style):C(post_time):C(caption_length)     0.537860    1.0   0.022106   
Residual                                       9537.753694  392.0        NaN   

                                                     PR(&gt;F)  
C(image_style)                                 6.106055e-15  
C(post_time)                                   1.415302e-19  
C(caption_length)                              4.200052e-12  
C(image_style):C(post_time)                    4.185723e-01  
C(image_style):C(caption_length)               1.036457e-01  
C(post_time):C(caption_length)                 4.231374e-01  
C(image_style):C(post_time):C(caption_length)  8.818821e-01  
Residual                                                NaN  </code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="11_experimental_design_files/figure-html/cell-13-output-2.png" width="1060" height="473" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="explanation-5" class="level5">
<h5 class="anchored" data-anchor-id="explanation-5">Explanation</h5>
<section id="data-simulation-4" class="level6">
<h6 class="anchored" data-anchor-id="data-simulation-4">Data Simulation</h6>
<p>The code simulates user engagement data for different combinations of image styles, post times, and caption lengths. Engagement is normally distributed with means that depend on the combination of these factors.</p>
</section>
<section id="anova-model-1" class="level6">
<h6 class="anchored" data-anchor-id="anova-model-1">ANOVA Model</h6>
<p>An ANOVA (Analysis of Variance) model is used to analyze the data. The formula ‘engagement ~ C(image_style) * C(post_time) * C(caption_length)’ specifies that the model should consider main effects and all possible interactions among the three factors.</p>
</section>
<section id="anova-table-1" class="level6">
<h6 class="anchored" data-anchor-id="anova-table-1">ANOVA Table</h6>
<p>The ANOVA table summarizes the results of the analysis, including the sum of squares, degrees of freedom, F-statistic, and p-value for each factor and their interactions. Significant p-values (typically p &lt; 0.05) indicate that the factor or interaction has a significant effect on user engagement.</p>
</section>
<section id="interaction-plot-1" class="level6">
<h6 class="anchored" data-anchor-id="interaction-plot-1">Interaction Plot</h6>
<p>The interaction plot visually represents the interactions among the three factors. It shows the mean engagement for each combination of image style, post time, and caption length, helping to identify any interaction effects.</p>
</section>
<section id="interpretation-1" class="level6">
<h6 class="anchored" data-anchor-id="interpretation-1">Interpretation</h6>
<p><strong>Main Effects</strong>: The ANOVA table allows you to assess the main effects of image style, post time, and caption length on user engagement.</p>
<p><strong>Interaction Effects</strong>: The interaction terms in the ANOVA table and the interaction plot help identify whether the effect of one factor depends on the levels of the other factors.</p>
<p><strong>Practical Implications</strong>: By understanding the main effects and interactions, Instagram can make data-driven decisions about the optimal combination of image styles, post times, and caption lengths to maximize user engagement.</p>
<p>This example demonstrates how a three-factor factorial design can be used to test multiple factors simultaneously and understand their individual and combined effects on an outcome of interest. As the number of factors increases, the complexity of the analysis and the potential for interaction effects also increase, providing a richer understanding of the factors influencing the outcome.</p>
<hr>
</section>
</section>
</section>
</section>
<section id="full-factorial-designs" class="level3">
<h3 class="anchored" data-anchor-id="full-factorial-designs">Full Factorial Designs</h3>
<ul>
<li><p><strong>Definition</strong>: Full factorial designs test all possible combinations of factors and levels, providing comprehensive insights but requiring large sample sizes.</p></li>
<li><p><strong>Example</strong>: In an agricultural study, testing the effects of different fertilizers, watering schedules, and plant varieties on crop yield.</p></li>
</ul>
<section id="scenario-testing-the-effects-of-image-styles-post-times-and-caption-lengths-on-user-engagement-1" class="level4">
<h4 class="anchored" data-anchor-id="scenario-testing-the-effects-of-image-styles-post-times-and-caption-lengths-on-user-engagement-1">Scenario: Testing the Effects of Image Styles, Post Times, and Caption Lengths on User Engagement</h4>
<p>Let’s assume Instagram wants to test all possible combinations of different image styles, post times, and caption lengths on user engagement (likes and comments).</p>
<section id="factors-to-test-2" class="level5">
<h5 class="anchored" data-anchor-id="factors-to-test-2">Factors to Test</h5>
<ul>
<li><strong>Factor 1 (Image Style)</strong>: style_a, style_b</li>
<li><strong>Factor 2 (Post Time)</strong>: morning, afternoon, evening</li>
<li><strong>Factor 3 (Caption Length)</strong>: short, medium, long</li>
</ul>
</section>
<section id="objective-11" class="level5">
<h5 class="anchored" data-anchor-id="objective-11">Objective</h5>
<p>Use a full factorial design to assess the main effects and interactions among image styles, post times, and caption lengths on user engagement.</p>
<div id="2780af7c" class="cell" data-execution_count="13">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.formula.api <span class="im">import</span> ols</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the levels for each factor</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>image_styles <span class="op">=</span> [<span class="st">'style_a'</span>, <span class="st">'style_b'</span>]</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>post_times <span class="op">=</span> [<span class="st">'morning'</span>, <span class="st">'afternoon'</span>, <span class="st">'evening'</span>]</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>caption_lengths <span class="op">=</span> [<span class="st">'short'</span>, <span class="st">'medium'</span>, <span class="st">'long'</span>]</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate user engagement data</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">0</span>)</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>n_samples <span class="op">=</span> <span class="dv">30</span>  <span class="co"># Number of samples per combination</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> []</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> style <span class="kw">in</span> image_styles:</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> time <span class="kw">in</span> post_times:</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> length <span class="kw">in</span> caption_lengths:</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(n_samples):</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>                base_engagement <span class="op">=</span> (<span class="dv">10</span> <span class="cf">if</span> style <span class="op">==</span> <span class="st">'style_a'</span> <span class="cf">else</span> <span class="dv">15</span>) <span class="op">+</span> <span class="op">\</span></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>                                  (<span class="dv">5</span> <span class="cf">if</span> time <span class="op">==</span> <span class="st">'morning'</span> <span class="cf">else</span> <span class="dv">7</span> <span class="cf">if</span> time <span class="op">==</span> <span class="st">'afternoon'</span> <span class="cf">else</span> <span class="dv">10</span>) <span class="op">+</span> <span class="op">\</span></span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>                                  (<span class="dv">3</span> <span class="cf">if</span> length <span class="op">==</span> <span class="st">'short'</span> <span class="cf">else</span> <span class="dv">5</span> <span class="cf">if</span> length <span class="op">==</span> <span class="st">'medium'</span> <span class="cf">else</span> <span class="dv">7</span>)</span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>                engagement <span class="op">=</span> np.random.normal(loc<span class="op">=</span>base_engagement, scale<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>                data.append([style, time, length, engagement])</span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a DataFrame</span></span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(data, columns<span class="op">=</span>[<span class="st">'image_style'</span>, <span class="st">'post_time'</span>, <span class="st">'caption_length'</span>, <span class="st">'engagement'</span>])</span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform ANOVA</span></span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ols(<span class="st">'engagement ~ C(image_style) * C(post_time) * C(caption_length)'</span>, data<span class="op">=</span>df).fit()</span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a>anova_table <span class="op">=</span> sm.stats.anova_lm(model, typ<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(anova_table)</span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the interactions</span></span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a>sns.catplot(x<span class="op">=</span><span class="st">'image_style'</span>, y<span class="op">=</span><span class="st">'engagement'</span>, hue<span class="op">=</span><span class="st">'post_time'</span>, col<span class="op">=</span><span class="st">'caption_length'</span>, kind<span class="op">=</span><span class="st">'point'</span>, data<span class="op">=</span>df, markers<span class="op">=</span>[<span class="st">"o"</span>, <span class="st">"s"</span>, <span class="st">"D"</span>], linestyles<span class="op">=</span>[<span class="st">"-"</span>, <span class="st">"--"</span>, <span class="st">"-."</span>])</span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(top<span class="op">=</span><span class="fl">0.9</span>)</span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a>plt.suptitle(<span class="st">'Interaction Plot of Image Style, Post Time, and Caption Length'</span>)</span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                                     sum_sq     df  \
C(image_style)                                  2784.767809    1.0   
C(post_time)                                    1932.160978    2.0   
C(caption_length)                                533.539229    2.0   
C(image_style):C(post_time)                       62.444957    2.0   
C(image_style):C(caption_length)                  90.169740    2.0   
C(post_time):C(caption_length)                   164.811810    4.0   
C(image_style):C(post_time):C(caption_length)     71.124399    4.0   
Residual                                       12902.758981  522.0   

                                                        F        PR(&gt;F)  
C(image_style)                                 112.661858  5.793696e-24  
C(post_time)                                    39.084200  1.523055e-16  
C(caption_length)                               10.792555  2.553702e-05  
C(image_style):C(post_time)                      1.263151  2.836244e-01  
C(image_style):C(caption_length)                 1.823974  1.624101e-01  
C(post_time):C(caption_length)                   1.666926  1.562916e-01  
C(image_style):C(post_time):C(caption_length)    0.719360  5.789520e-01  
Residual                                              NaN           NaN  </code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="11_experimental_design_files/figure-html/cell-14-output-2.png" width="1545" height="473" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="explanation-6" class="level5">
<h5 class="anchored" data-anchor-id="explanation-6">Explanation</h5>
<section id="data-simulation-5" class="level6">
<h6 class="anchored" data-anchor-id="data-simulation-5">Data Simulation</h6>
<p>The code simulates user engagement data for different combinations of image styles, post times, and caption lengths. Engagement is normally distributed with means that depend on the combination of these factors.</p>
</section>
<section id="anova-model-2" class="level6">
<h6 class="anchored" data-anchor-id="anova-model-2">ANOVA Model</h6>
<p>An ANOVA (Analysis of Variance) model is used to analyze the data. The formula ‘engagement ~ C(image_style) * C(post_time) * C(caption_length)’ specifies that the model should consider main effects and all possible interactions among the three factors.</p>
</section>
<section id="anova-table-2" class="level6">
<h6 class="anchored" data-anchor-id="anova-table-2">ANOVA Table</h6>
<p>The ANOVA table summarizes the results of the analysis, including the sum of squares, degrees of freedom, F-statistic, and p-value for each factor and their interactions. Significant p-values (typically p &lt; 0.05) indicate that the factor or interaction has a significant effect on user engagement.</p>
</section>
<section id="interaction-plot-2" class="level6">
<h6 class="anchored" data-anchor-id="interaction-plot-2">Interaction Plot</h6>
<p>The interaction plot visually represents the interactions among the three factors. It shows the mean engagement for each combination of image style, post time, and caption length, helping to identify any interaction effects.</p>
</section>
<section id="interpretation-2" class="level6">
<h6 class="anchored" data-anchor-id="interpretation-2">Interpretation</h6>
<p><strong>Main Effects</strong>: The ANOVA table allows you to assess the main effects of image style, post time, and caption length on user engagement.</p>
<p><strong>Interaction Effects</strong>: The interaction terms in the ANOVA table and the interaction plot help identify whether the effect of one factor depends on the levels of the other factors.</p>
<p><strong>Practical Implications</strong>: By understanding the main effects and interactions, Instagram can make data-driven decisions about the optimal combination of image styles, post times, and caption lengths to maximize user engagement.</p>
<p>This example demonstrates how a full factorial design can be used to test all possible combinations of factors and levels, providing comprehensive insights into their individual and combined effects on an outcome of interest. While this approach can be resource-intensive due to the large sample sizes required, it offers a thorough understanding of the factors influencing the outcome.</p>
<hr>
</section>
</section>
</section>
</section>
<section id="fractional-factorial-designs" class="level3">
<h3 class="anchored" data-anchor-id="fractional-factorial-designs">Fractional Factorial Designs</h3>
<ul>
<li><p><strong>Definition</strong>: Fractional factorial designs test a subset of all possible combinations, reducing the sample size needed while still providing insights into main effects and some interactions.</p></li>
<li><p><strong>Example</strong>: In a manufacturing study, testing a subset of machine settings and material types to determine optimal production conditions.</p></li>
</ul>
<hr>
<section id="half-fraction-designs" class="level4">
<h4 class="anchored" data-anchor-id="half-fraction-designs">Half-Fraction Designs</h4>
<ul>
<li><p><strong>Definition</strong>: Half-fraction designs test half of the possible combinations, balancing the reduction in sample size with the ability to detect main effects and primary interactions.</p></li>
<li><p><strong>Example</strong>: Testing 8 out of 16 possible combinations of temperature and pressure settings in a chemical reaction experiment.</p></li>
</ul>
</section>
<section id="quarter-fraction-designs" class="level4">
<h4 class="anchored" data-anchor-id="quarter-fraction-designs">Quarter-Fraction Designs</h4>
<ul>
<li><p><strong>Definition</strong>: Quarter-fraction designs test a quarter of the possible combinations, further reducing sample size requirements but increasing the risk of confounding interactions.</p></li>
<li><p><strong>Example</strong>: Testing 4 out of 16 possible combinations in a study on the effects of different marketing strategies and budget allocations.</p></li>
</ul>
<div id="ca3832cf" class="cell" data-execution_count="14">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.formula.api <span class="im">import</span> ols</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itertools <span class="im">import</span> product</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the levels for each factor</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>image_styles <span class="op">=</span> [<span class="st">'style_a'</span>, <span class="st">'style_b'</span>]</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>post_times <span class="op">=</span> [<span class="st">'morning'</span>, <span class="st">'afternoon'</span>, <span class="st">'evening'</span>]</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>caption_lengths <span class="op">=</span> [<span class="st">'short'</span>, <span class="st">'medium'</span>, <span class="st">'long'</span>]</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate all possible combinations (full factorial design)</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>all_combinations <span class="op">=</span> <span class="bu">list</span>(product(image_styles, post_times, caption_lengths))</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate user engagement data for all combinations</span></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>n_samples <span class="op">=</span> <span class="dv">30</span>  <span class="co"># Number of samples per combination</span></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> []</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> style, time, length <span class="kw">in</span> all_combinations:</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(n_samples):</span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>        base_engagement <span class="op">=</span> (<span class="dv">10</span> <span class="cf">if</span> style <span class="op">==</span> <span class="st">'style_a'</span> <span class="cf">else</span> <span class="dv">15</span>) <span class="op">+</span> <span class="op">\</span></span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>                          (<span class="dv">5</span> <span class="cf">if</span> time <span class="op">==</span> <span class="st">'morning'</span> <span class="cf">else</span> <span class="dv">7</span> <span class="cf">if</span> time <span class="op">==</span> <span class="st">'afternoon'</span> <span class="cf">else</span> <span class="dv">10</span>) <span class="op">+</span> <span class="op">\</span></span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>                          (<span class="dv">3</span> <span class="cf">if</span> length <span class="op">==</span> <span class="st">'short'</span> <span class="cf">else</span> <span class="dv">5</span> <span class="cf">if</span> length <span class="op">==</span> <span class="st">'medium'</span> <span class="cf">else</span> <span class="dv">7</span>)</span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Add more noise to reduce perfect collinearity</span></span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>        engagement <span class="op">=</span> np.random.normal(loc<span class="op">=</span>base_engagement, scale<span class="op">=</span><span class="dv">7</span>)</span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>        data.append([style, time, length, engagement])</span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a DataFrame</span></span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(data, columns<span class="op">=</span>[<span class="st">'image_style'</span>, <span class="st">'post_time'</span>, <span class="st">'caption_length'</span>, <span class="st">'engagement'</span>])</span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform ANOVA (Type III)</span></span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ols(<span class="st">'engagement ~ C(image_style) + C(post_time) + C(caption_length) + C(image_style):C(post_time) + C(image_style):C(caption_length) + C(post_time):C(caption_length)'</span>, data<span class="op">=</span>df).fit()</span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a>anova_table <span class="op">=</span> sm.stats.anova_lm(model, typ<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(anova_table)</span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the interactions</span></span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a>sns.catplot(x<span class="op">=</span><span class="st">'image_style'</span>, y<span class="op">=</span><span class="st">'engagement'</span>, hue<span class="op">=</span><span class="st">'post_time'</span>, col<span class="op">=</span><span class="st">'caption_length'</span>, kind<span class="op">=</span><span class="st">'point'</span>, data<span class="op">=</span>df, markers<span class="op">=</span>[<span class="st">"o"</span>, <span class="st">"s"</span>, <span class="st">"D"</span>], linestyles<span class="op">=</span>[<span class="st">"-"</span>, <span class="st">"--"</span>, <span class="st">"-."</span>])</span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(top<span class="op">=</span><span class="fl">0.9</span>)</span>
<span id="cb27-41"><a href="#cb27-41" aria-hidden="true" tabindex="-1"></a>plt.suptitle(<span class="st">'Interaction Plot of Image Style, Post Time, and Caption Length (Full Factorial Design)'</span>)</span>
<span id="cb27-42"><a href="#cb27-42" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                        sum_sq     df           F  \
Intercept                         23036.110477    1.0  510.724363   
C(image_style)                      995.853018    1.0   22.078658   
C(post_time)                        836.809968    2.0    9.276289   
C(caption_length)                   633.309019    2.0    7.020420   
C(image_style):C(post_time)           9.602640    2.0    0.106448   
C(image_style):C(caption_length)     31.422877    2.0    0.348332   
C(post_time):C(caption_length)      231.712071    4.0    1.284299   
Residual                          23725.114717  526.0         NaN   

                                        PR(&gt;F)  
Intercept                         1.562923e-79  
C(image_style)                    3.345622e-06  
C(post_time)                      1.098445e-04  
C(caption_length)                 9.796113e-04  
C(image_style):C(post_time)       8.990410e-01  
C(image_style):C(caption_length)  7.060272e-01  
C(post_time):C(caption_length)    2.750097e-01  
Residual                                   NaN  </code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="11_experimental_design_files/figure-html/cell-15-output-2.png" width="1544" height="473" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="99570905" class="cell" data-execution_count="15">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.formula.api <span class="im">import</span> ols</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itertools <span class="im">import</span> product</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the levels for each factor</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>image_styles <span class="op">=</span> [<span class="st">'style_a'</span>, <span class="st">'style_b'</span>]</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>post_times <span class="op">=</span> [<span class="st">'morning'</span>, <span class="st">'afternoon'</span>, <span class="st">'evening'</span>]</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>caption_lengths <span class="op">=</span> [<span class="st">'short'</span>, <span class="st">'medium'</span>, <span class="st">'long'</span>]</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate all possible combinations</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>all_combinations <span class="op">=</span> <span class="bu">list</span>(product(image_styles, post_times, caption_lengths))</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Select a quarter-fraction of the combinations</span></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">0</span>)  <span class="co"># for reproducibility</span></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>selected_combinations_quarter <span class="op">=</span> np.random.choice(<span class="bu">len</span>(all_combinations), size<span class="op">=</span><span class="bu">len</span>(all_combinations)<span class="op">//</span><span class="dv">4</span>, replace<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>selected_combinations_quarter <span class="op">=</span> [all_combinations[i] <span class="cf">for</span> i <span class="kw">in</span> selected_combinations_quarter]</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate user engagement data for the selected combinations</span></span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>n_samples <span class="op">=</span> <span class="dv">40</span>  <span class="co"># Increase the number of samples per combination</span></span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>data_quarter <span class="op">=</span> []</span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> style, time, length <span class="kw">in</span> selected_combinations_quarter:</span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(n_samples):</span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>        base_engagement <span class="op">=</span> (<span class="dv">10</span> <span class="cf">if</span> style <span class="op">==</span> <span class="st">'style_a'</span> <span class="cf">else</span> <span class="dv">15</span>) <span class="op">+</span> <span class="op">\</span></span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>                          (<span class="dv">5</span> <span class="cf">if</span> time <span class="op">==</span> <span class="st">'morning'</span> <span class="cf">else</span> <span class="dv">7</span> <span class="cf">if</span> time <span class="op">==</span> <span class="st">'afternoon'</span> <span class="cf">else</span> <span class="dv">10</span>) <span class="op">+</span> <span class="op">\</span></span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>                          (<span class="dv">3</span> <span class="cf">if</span> length <span class="op">==</span> <span class="st">'short'</span> <span class="cf">else</span> <span class="dv">5</span> <span class="cf">if</span> length <span class="op">==</span> <span class="st">'medium'</span> <span class="cf">else</span> <span class="dv">7</span>)</span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Add more noise to reduce perfect collinearity</span></span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a>        engagement <span class="op">=</span> np.random.normal(loc<span class="op">=</span>base_engagement, scale<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a>        data_quarter.append([style, time, length, engagement])</span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a DataFrame</span></span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a>df_quarter <span class="op">=</span> pd.DataFrame(data_quarter, columns<span class="op">=</span>[<span class="st">'image_style'</span>, <span class="st">'post_time'</span>, <span class="st">'caption_length'</span>, <span class="st">'engagement'</span>])</span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-37"><a href="#cb29-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform ANOVA (Type III)</span></span>
<span id="cb29-38"><a href="#cb29-38" aria-hidden="true" tabindex="-1"></a>model_quarter <span class="op">=</span> ols(<span class="st">'engagement ~ C(image_style) + C(post_time) + C(caption_length) + C(image_style):C(post_time) + C(image_style):C(caption_length) + C(post_time):C(caption_length)'</span>, data<span class="op">=</span>df_quarter).fit()</span>
<span id="cb29-39"><a href="#cb29-39" aria-hidden="true" tabindex="-1"></a>anova_table_quarter <span class="op">=</span> sm.stats.anova_lm(model_quarter, typ<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb29-40"><a href="#cb29-40" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"ANOVA Table (Quarter-Fraction Design):"</span>)</span>
<span id="cb29-41"><a href="#cb29-41" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(anova_table_quarter)</span>
<span id="cb29-42"><a href="#cb29-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-43"><a href="#cb29-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the interactions</span></span>
<span id="cb29-44"><a href="#cb29-44" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb29-45"><a href="#cb29-45" aria-hidden="true" tabindex="-1"></a>sns.catplot(x<span class="op">=</span><span class="st">'image_style'</span>, y<span class="op">=</span><span class="st">'engagement'</span>, hue<span class="op">=</span><span class="st">'post_time'</span>, col<span class="op">=</span><span class="st">'caption_length'</span>, kind<span class="op">=</span><span class="st">'point'</span>, data<span class="op">=</span>df_quarter, markers<span class="op">=</span>[<span class="st">"o"</span>, <span class="st">"s"</span>, <span class="st">"D"</span>], linestyles<span class="op">=</span>[<span class="st">"-"</span>, <span class="st">"--"</span>, <span class="st">"-."</span>], height<span class="op">=</span><span class="dv">5</span>, aspect<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb29-46"><a href="#cb29-46" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(top<span class="op">=</span><span class="fl">0.9</span>)</span>
<span id="cb29-47"><a href="#cb29-47" aria-hidden="true" tabindex="-1"></a>plt.suptitle(<span class="st">'Interaction Plot of Image Style, Post Time, and Caption Length (Quarter-Fraction Design)'</span>)</span>
<span id="cb29-48"><a href="#cb29-48" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb29-49"><a href="#cb29-49" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>ANOVA Table (Quarter-Fraction Design):
                                        sum_sq     df           F  \
Intercept                         26538.628300    1.0  383.164565   
C(image_style)                      503.384097    1.0    7.267857   
C(post_time)                        412.991766    1.0    5.962773   
C(caption_length)                   413.972200    2.0    2.988464   
C(image_style):C(post_time)         503.384097    1.0    7.267857   
C(image_style):C(caption_length)   1006.768193    2.0    7.267857   
C(post_time):C(caption_length)      825.983532    2.0    5.962773   
Residual                          10804.824840  156.0         NaN   

                                        PR(&gt;F)  
Intercept                         7.365321e-44  
C(image_style)                    7.790585e-03  
C(post_time)                      1.572853e-02  
C(caption_length)                 5.325646e-02  
C(image_style):C(post_time)       7.790585e-03  
C(image_style):C(caption_length)  7.790585e-03  
C(post_time):C(caption_length)    1.572853e-02  
Residual                                   NaN  </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/Users/ravishankar/miniforge3/lib/python3.10/site-packages/statsmodels/base/model.py:1894: ValueWarning:

covariance of constraints does not have full rank. The number of constraints is 2, but rank is 1

/Users/ravishankar/miniforge3/lib/python3.10/site-packages/statsmodels/base/model.py:1894: ValueWarning:

covariance of constraints does not have full rank. The number of constraints is 2, but rank is 1
</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>&lt;Figure size 1152x576 with 0 Axes&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="11_experimental_design_files/figure-html/cell-16-output-4.png" width="1253" height="473" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="mixed-level-factorial-designs" class="level3">
<h3 class="anchored" data-anchor-id="mixed-level-factorial-designs">Mixed-Level Factorial Designs</h3>
<ul>
<li><p><strong>Definition</strong>: Mixed-level factorial designs involve factors with different numbers of levels, allowing for flexibility in experimental design.</p></li>
<li><p><strong>Example</strong>: Testing three different types of advertising media (TV, radio, online) and two different budget levels for each medium.</p></li>
</ul>
<hr>
</section>
<section id="confounding-in-factorial-designs" class="level3">
<h3 class="anchored" data-anchor-id="confounding-in-factorial-designs">Confounding in Factorial Designs</h3>
<ul>
<li><p><strong>Definition</strong>: Confounding occurs when the effects of two factors cannot be separated, often due to the structure of the experimental design.</p></li>
<li><p><strong>Considerations</strong>: This must be accounted for in the analysis. For example, if the effect of temperature on a reaction cannot be separated from the effect of pressure, the results might be confounded.</p></li>
</ul>
<hr>
</section>
<section id="interaction-effects" class="level3">
<h3 class="anchored" data-anchor-id="interaction-effects">Interaction Effects</h3>
<ul>
<li><strong>Definition</strong>: Interaction effects occur when the effect of one factor depends on the level of another factor.</li>
</ul>
<section id="two-way-interactions" class="level4">
<h4 class="anchored" data-anchor-id="two-way-interactions">Two-Way Interactions</h4>
<ul>
<li><p><strong>Definition</strong>: Two-way interactions involve two factors and their combined effect on the outcome.</p></li>
<li><p><strong>Example</strong>: In a study on educational interventions, the combined effect of teaching method (factor 1) and class size (factor 2) on student performance.</p></li>
</ul>
<hr>
</section>
<section id="higher-order-interactions" class="level4">
<h4 class="anchored" data-anchor-id="higher-order-interactions">Higher-Order Interactions</h4>
<ul>
<li><p><strong>Definition</strong>: Higher-order interactions involve three or more factors, increasing complexity and interpretative challenges.</p></li>
<li><p><strong>Example</strong>: In a study on agricultural productivity, the combined effects of fertilizer type, irrigation level, and planting density on crop yield.</p></li>
</ul>
<hr>
</section>
</section>
</section>
<section id="latin-square-designs" class="level2">
<h2 class="anchored" data-anchor-id="latin-square-designs">Latin Square Designs</h2>
<p><strong>Definition</strong>: Latin Square designs are used to control for two sources of variability in experimental design.</p>
<section id="standard-latin-square" class="level3">
<h3 class="anchored" data-anchor-id="standard-latin-square">Standard Latin Square</h3>
<ul>
<li><p><strong>Definition</strong>: A standard Latin square involves an equal number of rows and columns, with each treatment appearing exactly once in each row and column.</p></li>
<li><p><strong>Example</strong>: Testing four different teaching methods (A, B, C, D) in four different classrooms, ensuring each method is used once in each classroom and time period.</p></li>
</ul>
</section>
<section id="graeco-latin-square" class="level3">
<h3 class="anchored" data-anchor-id="graeco-latin-square">Graeco-Latin Square</h3>
<ul>
<li><p><strong>Definition</strong>: A Graeco-Latin square is an extension of the Latin square that includes an additional dimension, controlling for three sources of variability.</p></li>
<li><p><strong>Example</strong>: In an agricultural study, testing different fertilizers (rows), irrigation levels (columns), and planting methods (additional dimension).</p></li>
</ul>
</section>
<section id="hyper-graeco-latin-square" class="level3">
<h3 class="anchored" data-anchor-id="hyper-graeco-latin-square">Hyper-Graeco-Latin Square</h3>
<ul>
<li><p><strong>Definition</strong>: A Hyper-Graeco-Latin square extends the concept further to control for four sources of variability.</p></li>
<li><p><strong>Example</strong>: In a complex clinical trial, controlling for drug type, dosage, patient age group, and treatment duration.</p></li>
</ul>
</section>
<section id="balanced-incomplete-latin-square" class="level3">
<h3 class="anchored" data-anchor-id="balanced-incomplete-latin-square">Balanced Incomplete Latin Square</h3>
<ul>
<li><p><strong>Definition</strong>: A balanced incomplete Latin square is used when the number of treatments exceeds the number of rows and columns, ensuring each treatment appears an equal number of times.</p></li>
<li><p><strong>Example</strong>: In a study with six different fertilizers but only four plots, each fertilizer is tested twice in a balanced manner.</p></li>
</ul>
</section>
<section id="cyclic-latin-square" class="level3">
<h3 class="anchored" data-anchor-id="cyclic-latin-square">Cyclic Latin Square</h3>
<ul>
<li><p><strong>Definition</strong>: A cyclic Latin square rotates treatments systematically, ensuring balanced treatment allocation.</p></li>
<li><p><strong>Example</strong>: In a psychological experiment, rotating tasks across different time periods and participants to ensure balance.</p></li>
</ul>
</section>
<section id="sudoku-designs" class="level3">
<h3 class="anchored" data-anchor-id="sudoku-designs">Sudoku Designs</h3>
<ul>
<li><p><strong>Definition</strong>: Sudoku designs use Sudoku puzzles’ principles to create complex Latin squares, controlling for multiple sources of variability.</p></li>
<li><p><strong>Example</strong>: Using a Sudoku-based design to balance treatments in a multi-faceted clinical trial involving multiple drugs and patient characteristics.</p></li>
</ul>
</section>
<section id="applications-in-crossover-trials" class="level3">
<h3 class="anchored" data-anchor-id="applications-in-crossover-trials">Applications in Crossover Trials</h3>
<ul>
<li><p><strong>Definition</strong>: Latin square designs are often used in crossover trials to balance treatments and control for order effects.</p></li>
<li><p><strong>Example</strong>: In a dietary study, different meal plans are rotated among participants to control for meal order effects on weight loss.</p></li>
</ul>
</section>
</section>
<section id="blocking-and-stratification" class="level2">
<h2 class="anchored" data-anchor-id="blocking-and-stratification">Blocking and Stratification</h2>
<p><strong>Definition</strong>: Blocking and stratification are techniques to control for variability in experimental design.</p>
<section id="complete-block-designs" class="level3">
<h3 class="anchored" data-anchor-id="complete-block-designs">Complete Block Designs</h3>
<ul>
<li><p><strong>Definition</strong>: Complete block designs ensure that all treatments are tested within each block, controlling for block-to-block variability.</p></li>
<li><p><strong>Example</strong>: In an agricultural study, each block of land receives all treatment types, controlling for soil variability.</p></li>
</ul>
</section>
<section id="incomplete-block-designs" class="level3">
<h3 class="anchored" data-anchor-id="incomplete-block-designs">Incomplete Block Designs</h3>
<ul>
<li><p><strong>Definition</strong>: Incomplete block designs do not test all treatments within each block, reducing the number of required comparisons.</p></li>
<li><p><strong>Example</strong>: In a study on different teaching methods, each school receives a subset of the methods, reducing logistical complexity.</p></li>
</ul>
</section>
<section id="balanced-incomplete-block-designs-bibd" class="level3">
<h3 class="anchored" data-anchor-id="balanced-incomplete-block-designs-bibd">Balanced Incomplete Block Designs (BIBD)</h3>
<ul>
<li><p><strong>Definition</strong>: BIBD ensures that each treatment appears an equal number of times across all blocks, maintaining balance despite incomplete blocks.</p></li>
<li><p><strong>Example</strong>: Testing five different fertilizers in three plots each, ensuring balanced comparison without testing all fertilizers in every plot.</p></li>
</ul>
</section>
<section id="randomized-complete-block-designs-rcbd" class="level3">
<h3 class="anchored" data-anchor-id="randomized-complete-block-designs-rcbd">Randomized Complete Block Designs (RCBD)</h3>
<ul>
<li><p><strong>Definition</strong>: RCBD randomly assigns treatments within each block, ensuring that each treatment appears in every block, controlling for block-to-block variability.</p></li>
<li><p><strong>Example</strong>: In a clinical trial, each block (e.g., hospital) randomly assigns patients to different treatments to control for hospital-level differences.</p></li>
</ul>
</section>
<section id="stratified-block-designs" class="level3">
<h3 class="anchored" data-anchor-id="stratified-block-designs">Stratified Block Designs</h3>
<ul>
<li><p><strong>Definition</strong>: Stratified block designs combine stratification and blocking to control for multiple sources of variability.</p></li>
<li><p><strong>Example</strong>: In a study on educational outcomes, stratifying by grade level and then blocking by classroom to control for both grade and classroom effects.</p></li>
</ul>
</section>
<section id="covariate-adaptive-designs" class="level3">
<h3 class="anchored" data-anchor-id="covariate-adaptive-designs">Covariate-Adaptive Designs</h3>
<ul>
<li><p><strong>Definition</strong>: Covariate-adaptive designs adjust treatment allocation based on covariates, ensuring balanced groups concerning important variables.</p></li>
<li><p><strong>Example</strong>: In a clinical trial, adjusting allocation to balance groups by age, gender, and baseline health status.</p></li>
</ul>
</section>
<section id="minimization-methods" class="level3">
<h3 class="anchored" data-anchor-id="minimization-methods">Minimization Methods</h3>
<ul>
<li><p><strong>Definition</strong>: Minimization methods adjust treatment allocation to minimize imbalances across multiple covariates.</p></li>
<li><p><strong>Example</strong>: In a study on a new drug, dynamically adjusting the assignment of participants to balance groups by multiple baseline characteristics.</p></li>
</ul>
</section>
<section id="propensity-score-stratification" class="level3">
<h3 class="anchored" data-anchor-id="propensity-score-stratification">Propensity Score Stratification</h3>
<ul>
<li><p><strong>Definition</strong>: Propensity score stratification uses propensity scores to create strata of participants with similar likelihoods of receiving the treatment, reducing confounding.</p></li>
<li><p><strong>Example</strong>: In an observational study on the effects of a new teaching method, using propensity scores to stratify students based on their likelihood of receiving the new method.</p></li>
</ul>
</section>
</section>
<section id="power-analysis-and-sample-size-calculation" class="level2">
<h2 class="anchored" data-anchor-id="power-analysis-and-sample-size-calculation">Power Analysis and Sample Size Calculation</h2>
<p><strong>Definition</strong>: Power analysis and sample size calculation are statistical techniques used to determine the minimum sample size required to detect a meaningful effect in an experiment. This ensures that the study is adequately powered to avoid Type II errors (failing to detect a true effect).</p>
<section id="effect-size-estimation" class="level3">
<h3 class="anchored" data-anchor-id="effect-size-estimation">Effect Size Estimation</h3>
<ul>
<li><strong>Definition</strong>: Effect size estimation quantifies the magnitude of the difference between groups.</li>
</ul>
<section id="cohens-d" class="level4">
<h4 class="anchored" data-anchor-id="cohens-d">Cohen’s d</h4>
<ul>
<li><p><strong>Definition</strong>: Cohen’s d measures the effect size in terms of standard deviation units, commonly used in t-tests.</p></li>
<li><p><strong>Example</strong>: An effect size of 0.5 indicates a medium effect, suggesting that the mean difference between groups is half a standard deviation.</p></li>
</ul>
</section>
<section id="odds-ratio" class="level4">
<h4 class="anchored" data-anchor-id="odds-ratio">Odds Ratio</h4>
<ul>
<li><p><strong>Definition</strong>: The odds ratio compares the odds of an event occurring in the treatment group to the control group, commonly used in binary outcomes.</p></li>
<li><p><strong>Example</strong>: An odds ratio of 2 indicates that the event is twice as likely in the treatment group compared to the control group.</p></li>
</ul>
</section>
<section id="relative-risk" class="level4">
<h4 class="anchored" data-anchor-id="relative-risk">Relative Risk</h4>
<ul>
<li><p><strong>Definition</strong>: Relative risk compares the probability of an event occurring in the treatment group to the control group, used in cohort studies.</p></li>
<li><p><strong>Example</strong>: A relative risk of 1.5 indicates that the event is 1.5 times more likely in the treatment group compared to the control group.</p></li>
</ul>
</section>
</section>
<section id="type-i-error-α-and-type-ii-error-β" class="level3">
<h3 class="anchored" data-anchor-id="type-i-error-α-and-type-ii-error-β">Type I Error (α) and Type II Error (β)</h3>
<ul>
<li><p><strong>Definition</strong>: Type I error (α) is the probability of falsely rejecting the null hypothesis.</p></li>
<li><p><strong>Definition</strong>: Type II error (β) is the probability of failing to reject the null hypothesis when it is false.</p></li>
<li><p><strong>Example</strong>: In a clinical trial, a Type I error might occur if we conclude that a drug is effective when it is not, and a Type II error might occur if we fail to detect the drug’s effectiveness when it actually is effective.</p></li>
</ul>
</section>
<section id="one-tailed-vs.-two-tailed-tests" class="level3">
<h3 class="anchored" data-anchor-id="one-tailed-vs.-two-tailed-tests">One-Tailed vs.&nbsp;Two-Tailed Tests</h3>
<ul>
<li><p><strong>Definition</strong>: One-tailed tests examine the effect in one direction.</p></li>
<li><p><strong>Definition</strong>: Two-tailed tests examine effects in both directions.</p></li>
<li><p><strong>Example</strong>: In testing whether a new drug lowers blood pressure, a one-tailed test would only look for a decrease, while a two-tailed test would look for both increases and decreases.</p></li>
</ul>
</section>
<section id="power-calculations-for-different-study-designs" class="level3">
<h3 class="anchored" data-anchor-id="power-calculations-for-different-study-designs">Power Calculations for Different Study Designs</h3>
<p><strong>Definition</strong>: Power calculations ensure sufficient sample size to detect effects in different study designs.</p>
<section id="t-tests" class="level4">
<h4 class="anchored" data-anchor-id="t-tests">t-Tests</h4>
<ul>
<li><p><strong>Definition</strong>: Power calculations for t-tests determine the sample size needed to detect differences between two means.</p></li>
<li><p><strong>Example</strong>: Calculating the sample size needed to detect a difference in test scores between two teaching methods.</p></li>
</ul>
</section>
<section id="anova" class="level4">
<h4 class="anchored" data-anchor-id="anova">ANOVA</h4>
<ul>
<li><p><strong>Definition</strong>: Power calculations for ANOVA determine the sample size needed to detect differences among multiple means.</p></li>
<li><p><strong>Example</strong>: Determining the sample size required to detect differences in crop yields among different fertilizers.</p></li>
</ul>
</section>
<section id="regression" class="level4">
<h4 class="anchored" data-anchor-id="regression">Regression</h4>
<ul>
<li><p><strong>Definition</strong>: Power calculations for regression determine the sample size needed to detect relationships between variables.</p></li>
<li><p><strong>Example</strong>: Calculating the sample size needed to detect a relationship between exercise and weight loss.</p></li>
</ul>
</section>
<section id="chi-square-tests" class="level4">
<h4 class="anchored" data-anchor-id="chi-square-tests">Chi-Square Tests</h4>
<ul>
<li><p><strong>Definition</strong>: Power calculations for chi-square tests determine the sample size needed to detect associations between categorical variables.</p></li>
<li><p><strong>Example</strong>: Determining the sample size required to detect an association between smoking status and lung cancer.</p></li>
</ul>
</section>
</section>
<section id="sample-size-for-non-inferiority-trials" class="level3">
<h3 class="anchored" data-anchor-id="sample-size-for-non-inferiority-trials">Sample Size for Non-Inferiority Trials</h3>
<ul>
<li><p><strong>Definition</strong>: Sample size calculations for non-inferiority trials ensure that the trial can demonstrate the new treatment is not worse than the control by a specified margin.</p></li>
<li><p><strong>Example</strong>: In a trial comparing a new generic drug to an established brand, calculating the sample size needed to show the new drug is not significantly worse.</p></li>
</ul>
</section>
<section id="sample-size-for-equivalence-trials" class="level3">
<h3 class="anchored" data-anchor-id="sample-size-for-equivalence-trials">Sample Size for Equivalence Trials</h3>
<ul>
<li><p><strong>Definition</strong>: Sample size calculations for equivalence trials ensure that the trial can demonstrate the new treatment is equivalent to the control within a specified margin.</p></li>
<li><p><strong>Example</strong>: In a trial comparing two formulations of the same drug, determining the sample size required to show they are equivalent in efficacy.</p></li>
</ul>
</section>
<section id="adjusting-for-attrition-and-non-compliance" class="level3">
<h3 class="anchored" data-anchor-id="adjusting-for-attrition-and-non-compliance">Adjusting for Attrition and Non-Compliance</h3>
<ul>
<li><p><strong>Definition</strong>: Sample size calculations adjust for expected dropout rates and non-compliance to maintain statistical power.</p></li>
<li><p><strong>Example</strong>: Increasing the sample size in a long-term study to account for participants who may drop out over time.</p></li>
</ul>
</section>
<section id="power-analysis-software-tools" class="level3">
<h3 class="anchored" data-anchor-id="power-analysis-software-tools">Power Analysis Software Tools</h3>
<ul>
<li><p><strong>Definition</strong>: Software tools such as G*Power, PASS, and SAS can perform complex power analyses and sample size calculations.</p></li>
<li><p><strong>Example</strong>: Using G*Power to calculate the required sample size for a study examining the effects of a new teaching method on student performance.</p></li>
</ul>
</section>
<section id="sequential-and-group-sequential-designs" class="level3">
<h3 class="anchored" data-anchor-id="sequential-and-group-sequential-designs">Sequential and Group Sequential Designs</h3>
<ul>
<li><p><strong>Definition</strong>: Sequential and group sequential designs allow for interim analyses and adjustments to the trial based on early results, potentially reducing sample size requirements.</p></li>
<li><p><strong>Example</strong>: In a clinical trial, conducting interim analyses at predefined points to determine whether to continue, stop, or adjust the study.</p></li>
</ul>
</section>
<section id="adaptive-sample-size-re-estimation" class="level3">
<h3 class="anchored" data-anchor-id="adaptive-sample-size-re-estimation">Adaptive Sample Size Re-Estimation</h3>
<ul>
<li><p><strong>Definition</strong>: Adaptive sample size re-estimation adjusts the sample size based on interim analyses to ensure the trial maintains adequate power.</p></li>
<li><p><strong>Example</strong>: In a clinical trial, increasing the sample size mid-study if interim results suggest that more participants are needed to achieve statistical significance.</p></li>
</ul>
</section>
</section>
<section id="crossover-designs-1" class="level2">
<h2 class="anchored" data-anchor-id="crossover-designs-1">Crossover Designs</h2>
<p><strong>Definition</strong>: Crossover designs are experiments where participants receive multiple treatments in a sequential order, with each participant acting as their own control. This design helps to reduce variability and improve the efficiency of the study.</p>
<section id="components" class="level3">
<h3 class="anchored" data-anchor-id="components">Components</h3>
<ul>
<li><p><strong>Treatment Periods</strong>: Different phases of the study during which participants receive specific treatments. Each treatment period is followed by a washout period to clear the effects of the previous treatment.</p></li>
<li><p><strong>Washout Periods</strong>: Intervals between treatment periods that allow the effects of the previous treatment to dissipate before the next treatment is administered.</p></li>
<li><p><strong>Randomization</strong>: Participants are randomly assigned to different sequences of treatments to ensure unbiased comparison of the treatments.</p></li>
</ul>
</section>
<section id="advantages" class="level3">
<h3 class="anchored" data-anchor-id="advantages">Advantages</h3>
<ul>
<li><p>Reduces the number of participants needed by allowing each participant to receive multiple treatments.</p></li>
<li><p>Controls for individual differences by having participants serve as their own controls.</p></li>
</ul>
</section>
<section id="challenges" class="level3">
<h3 class="anchored" data-anchor-id="challenges">Challenges</h3>
<ul>
<li><p>Requires careful planning to manage potential carryover effects from one treatment period to the next.</p></li>
<li><p>Washout periods must be sufficiently long to ensure no residual effects influence subsequent treatments.</p></li>
</ul>
</section>
<section id="example" class="level3">
<h3 class="anchored" data-anchor-id="example">Example</h3>
<p>A study testing the effects of two different diets on cholesterol levels uses a crossover design. Participants follow Diet A for 4 weeks, undergo a 2-week washout period, and then follow Diet B for 4 weeks. Cholesterol levels are measured at the end of each diet period to compare the effects.</p>
</section>
</section>
<section id="matched-pairs-design" class="level2">
<h2 class="anchored" data-anchor-id="matched-pairs-design">Matched Pairs Design</h2>
<p><strong>Definition</strong>: Matched pairs design is an experimental design in which subjects are paired based on specific characteristics, and then each pair is randomly assigned to different treatments. This design helps control for variability by ensuring that paired subjects are similar in key attributes.</p>
<section id="components-1" class="level3">
<h3 class="anchored" data-anchor-id="components-1">Components</h3>
<ul>
<li><p><strong>Matching Criteria</strong>: The specific characteristics used to pair subjects, such as age, gender, or baseline measurements.</p></li>
<li><p><strong>Random Assignment</strong>: Pairs of subjects are randomly assigned to different treatments, ensuring unbiased comparison between treatments.</p></li>
<li><p><strong>Comparison</strong>: Within each pair, the difference in outcomes between the treated and control subjects is analyzed, providing a more precise estimate of the treatment effect.</p></li>
</ul>
</section>
<section id="advantages-1" class="level3">
<h3 class="anchored" data-anchor-id="advantages-1">Advantages</h3>
<ul>
<li><p>Controls for variability by ensuring that paired subjects are similar in key attributes.</p></li>
<li><p>Provides more precise estimates of treatment effects compared to completely randomized designs.</p></li>
</ul>
</section>
<section id="challenges-1" class="level3">
<h3 class="anchored" data-anchor-id="challenges-1">Challenges</h3>
<ul>
<li><p>Requires accurate matching of subjects based on relevant characteristics.</p></li>
<li><p>May be difficult to find suitable pairs if the population is highly heterogeneous.</p></li>
</ul>
</section>
<section id="example-1" class="level3">
<h3 class="anchored" data-anchor-id="example-1">Example</h3>
<p>A study examining the effects of a new educational intervention on test scores pairs students based on their baseline test scores and then randomly assigns one student in each pair to the intervention group and the other to the control group. The differences in post-intervention test scores within each pair are analyzed to determine the intervention’s effectiveness.</p>
</section>
</section>
<section id="bayesian-experimental-design" class="level2">
<h2 class="anchored" data-anchor-id="bayesian-experimental-design">Bayesian Experimental Design</h2>
<p><strong>Definition</strong>: Bayesian experimental design incorporates Bayesian statistical methods to update the probability of a hypothesis as more data becomes available. This approach allows for continuous learning and adaptation of the experimental process based on observed results.</p>
<section id="components-2" class="level3">
<h3 class="anchored" data-anchor-id="components-2">Components</h3>
<ul>
<li><p><strong>Prior Distribution</strong>: The initial beliefs about the parameters or hypotheses before observing the data, expressed as a probability distribution.</p></li>
<li><p><strong>Likelihood</strong>: The probability of observing the data given the parameters or hypotheses. It represents the data-generating process.</p></li>
<li><p><strong>Posterior Distribution</strong>: The updated beliefs about the parameters or hypotheses after observing the data, obtained by combining the prior distribution and the likelihood using Bayes’ theorem.</p></li>
<li><p><strong>Adaptive Design</strong>: An approach where the experimental design is continuously updated based on the posterior distribution, allowing for more efficient and informative experiments.</p></li>
</ul>
</section>
<section id="advantages-2" class="level3">
<h3 class="anchored" data-anchor-id="advantages-2">Advantages</h3>
<ul>
<li><p>Allows for the incorporation of prior knowledge and continuous updating of beliefs.</p></li>
<li><p>Can lead to more efficient and informative experiments by adapting the design based on observed results.</p></li>
</ul>
</section>
<section id="challenges-2" class="level3">
<h3 class="anchored" data-anchor-id="challenges-2">Challenges</h3>
<ul>
<li><p>Requires careful selection of prior distributions and computational resources for updating the posterior distribution.</p></li>
<li><p>May be complex to implement and interpret compared to traditional frequentist methods.</p></li>
</ul>
</section>
<section id="example-2" class="level3">
<h3 class="anchored" data-anchor-id="example-2">Example</h3>
<p>A pharmaceutical company uses Bayesian experimental design to test a new drug. Initial beliefs about the drug’s effectiveness are updated continuously as trial data is collected. The design adapts by adjusting dosages or allocating more participants to promising treatment groups, improving the efficiency and effectiveness of the trial.</p>
</section>
</section>
<section id="questions" class="level2">
<h2 class="anchored" data-anchor-id="questions">Questions</h2>
<section id="ab-testing-1" class="level3">
<h3 class="anchored" data-anchor-id="ab-testing-1">A/B Testing</h3>
<section id="sample-size-determination" class="level4">
<h4 class="anchored" data-anchor-id="sample-size-determination">1. Sample Size Determination</h4>
<p><strong>Question:</strong> How would you determine the sample size for an A/B test to evaluate a new feature on Instagram?</p>
<p><strong>Answer:</strong> To determine the sample size for an A/B test, we consider the following factors:</p>
<ul>
<li><p><strong>Significance level (())</strong>: The probability of Type I error (e.g., 0.05).</p></li>
<li><p><strong>Power (1-())</strong>: The probability of detecting a true effect (e.g., 0.8).</p></li>
<li><p><strong>Effect size</strong>: The expected difference between the control and treatment groups.</p></li>
<li><p><strong>Baseline conversion rate</strong>: The current conversion rate for the control group.</p></li>
</ul>
<p>Using these inputs, we can use power analysis formulas or tools (e.g., G*Power) to calculate the required sample size.</p>
<p>Example: If the baseline conversion rate is 10%, the expected improvement is 2%, (= 0.05), and power = 0.8, the required sample size might be calculated to be approximately 1,000 users per group.</p>
</section>
<section id="randomization" class="level4">
<h4 class="anchored" data-anchor-id="randomization">2. Randomization</h4>
<p><strong>Question:</strong> Explain the importance of randomization in A/B testing and how you would implement it on Facebook.</p>
<p><strong>Answer:</strong> Randomization ensures that each participant has an equal chance of being assigned to either the control or treatment group, reducing selection bias and confounding variables.</p>
<p>Implementation:</p>
<ul>
<li><p><strong>Simple randomization:</strong> Assign users to control or treatment groups using random number generation.</p></li>
<li><p><strong>Stratified randomization:</strong> Ensure balanced groups by stratifying on key variables (e.g., age, location) before random assignment.</p></li>
</ul>
<p>Example: For an A/B test on a new feature, we randomly assign users to either the feature group or the control group, ensuring no systematic differences between the groups.</p>
</section>
<section id="statistical-significance-in-ab-tests" class="level4">
<h4 class="anchored" data-anchor-id="statistical-significance-in-ab-tests">3. Statistical Significance in A/B Tests</h4>
<p><strong>Question:</strong> How do you determine statistical significance in an A/B test for a new advertising strategy on Instagram?</p>
<p><strong>Answer:</strong> Statistical significance is determined by calculating the p-value, which measures the probability of observing the test results under the null hypothesis (no effect).</p>
<p>Steps: 1. <strong>Formulate hypotheses:</strong> - (H_0): No difference in advertising strategy effectiveness. - (H_1): Difference in advertising strategy effectiveness. 2. <strong>Select significance level (())</strong>: Typically 0.05. 3. <strong>Conduct the test</strong>: Use a t-test or z-test depending on sample size and variance. 4. <strong>Calculate p-value</strong>: Compare the test statistic to the critical value.</p>
<p>Example: If the p-value is 0.03, it is less than (= 0.05), so we reject (H_0) and conclude the new advertising strategy is effective.</p>
</section>
<section id="multiple-testing-correction" class="level4">
<h4 class="anchored" data-anchor-id="multiple-testing-correction">4. Multiple Testing Correction</h4>
<p><strong>Question:</strong> How would you correct for multiple testing in an A/B test evaluating several features simultaneously on Facebook?</p>
<p><strong>Answer:</strong> Multiple testing increases the risk of Type I errors. Correction methods include: - <strong>Bonferroni correction</strong>: Adjust () by dividing it by the number of tests. [ <em>{adj} = ] Example: For 5 tests with (= 0.05), the adjusted (</em>{adj} = = 0.01). - <strong>False Discovery Rate (FDR)</strong>: Control the proportion of false positives among significant results using the Benjamini-Hochberg procedure.</p>
<p>Example: If testing 10 features, the Bonferroni correction ensures each test must meet a stricter significance level, reducing the likelihood of false positives.</p>
</section>
<section id="sequential-ab-testing" class="level4">
<h4 class="anchored" data-anchor-id="sequential-ab-testing">5. Sequential A/B Testing</h4>
<p><strong>Question:</strong> Describe how you would conduct sequential A/B testing to evaluate a new user interface on Instagram.</p>
<p><strong>Answer:</strong> Sequential A/B testing allows for continuous monitoring and early stopping based on interim results, reducing sample size and time.</p>
<p>Steps: 1. <strong>Define stopping rules</strong>: Pre-determine criteria for stopping early (e.g., significance level, minimum sample size). 2. <strong>Monitor continuously</strong>: Analyze data at regular intervals. 3. <strong>Decision-making</strong>: Stop the test if results are statistically significant or if a pre-determined maximum sample size is reached.</p>
<p>Example: For a new user interface test, monitor engagement metrics weekly, stopping the test early if a significant improvement is detected or after reaching the maximum sample size.</p>
</section>
</section>
<section id="multivariate-testing" class="level3">
<h3 class="anchored" data-anchor-id="multivariate-testing">Multivariate Testing</h3>
<section id="multivariate-testing-1" class="level4">
<h4 class="anchored" data-anchor-id="multivariate-testing-1">6. Multivariate Testing</h4>
<p><strong>Question:</strong> How would you design a multivariate test to optimize the layout of a Facebook ad?</p>
<p><strong>Answer:</strong> Multivariate testing evaluates multiple variables simultaneously to understand their combined effect on the outcome.</p>
<p>Steps: 1. <strong>Identify variables</strong>: Select multiple elements to test (e.g., headline, image, call-to-action). 2. <strong>Create combinations</strong>: Generate all possible combinations of the variables. 3. <strong>Assign users</strong>: Randomly assign users to different combinations. 4. <strong>Analyze results</strong>: Use regression analysis to identify the most effective combination.</p>
<p>Example: Testing 2 headlines, 3 images, and 2 call-to-actions creates 12 combinations. Analyze which combination results in the highest click-through rate.</p>
</section>
</section>
<section id="factorial-designs-1" class="level3">
<h3 class="anchored" data-anchor-id="factorial-designs-1">Factorial Designs</h3>
<section id="full-factorial-designs-1" class="level4">
<h4 class="anchored" data-anchor-id="full-factorial-designs-1">7. Full Factorial Designs</h4>
<p><strong>Question:</strong> Explain how you would use a full factorial design to test the effects of different content types and posting times on user engagement on Instagram.</p>
<p><strong>Answer:</strong> A full factorial design tests all possible combinations of factors, capturing interactions between them.</p>
<p>Steps: 1. <strong>Identify factors</strong>: Content type (e.g., photo, video) and posting time (e.g., morning, evening). 2. <strong>Create combinations</strong>: Each factor level is combined with every other factor level. 3. <strong>Assign users</strong>: Randomly assign users to each combination. 4. <strong>Analyze results</strong>: Use ANOVA to understand main effects and interactions.</p>
<p>Example: With 2 content types and 2 posting times, we test 4 combinations, analyzing which combination maximizes user engagement and if there’s an interaction effect.</p>
</section>
<section id="fractional-factorial-designs-1" class="level4">
<h4 class="anchored" data-anchor-id="fractional-factorial-designs-1">8. Fractional Factorial Designs</h4>
<p><strong>Question:</strong> How would you use a fractional factorial design to reduce the number of tests needed for optimizing Facebook ad components?</p>
<p><strong>Answer:</strong> Fractional factorial designs test a subset of combinations, reducing the number of experiments while still providing insights.</p>
<p>Steps: 1. <strong>Identify factors and levels</strong>: Select factors (e.g., image, text) and levels (e.g., high, low). 2. <strong>Choose a fraction</strong>: Select a fraction of the full factorial design (e.g., half). 3. <strong>Assign users</strong>: Randomly assign users to selected combinations. 4. <strong>Analyze results</strong>: Identify main effects and significant interactions.</p>
<p>Example: For 3 factors with 2 levels each, a full factorial design has (2^3 = 8) combinations. A half fraction tests 4 combinations, providing efficient insights with fewer tests.</p>
</section>
</section>
<section id="response-surface-methodology" class="level3">
<h3 class="anchored" data-anchor-id="response-surface-methodology">Response Surface Methodology</h3>
<section id="response-surface-methodology-1" class="level4">
<h4 class="anchored" data-anchor-id="response-surface-methodology-1">9. Response Surface Methodology</h4>
<p><strong>Question:</strong> Describe how you would use response surface methodology (RSM) to optimize user engagement on Instagram through various content strategies.</p>
<p><strong>Answer:</strong> RSM explores the relationships between factors and the response, identifying optimal conditions.</p>
<p>Steps: 1. <strong>Identify factors</strong>: Select content strategies (e.g., frequency, type). 2. <strong>Design experiments</strong>: Use central composite design (CCD) to cover factor ranges. 3. <strong>Conduct experiments</strong>: Measure user engagement for each combination. 4. <strong>Build a model</strong>: Fit a quadratic model to the data. 5. <strong>Optimize</strong>: Use the model to find the optimal factor levels for maximum engagement.</p>
<p>Example: If testing content frequency and type, RSM identifies the combination that maximizes user engagement, guiding content strategy.</p>
</section>
</section>
<section id="taguchi-methods" class="level3">
<h3 class="anchored" data-anchor-id="taguchi-methods">Taguchi Methods</h3>
<section id="taguchi-methods-1" class="level4">
<h4 class="anchored" data-anchor-id="taguchi-methods-1">10. Taguchi Methods</h4>
<p><strong>Question:</strong> Explain how Taguchi methods can be used to improve the robustness of ad performance on Facebook.</p>
<p><strong>Answer:</strong> Taguchi methods optimize performance by minimizing variability due to uncontrollable factors (noise).</p>
<p>Steps: 1. <strong>Identify factors and levels</strong>: Select controllable factors (e.g., ad copy, image) and noise factors (e.g., time of day). 2. <strong>Design experiments</strong>: Use orthogonal arrays to systematically test factor combinations. 3. <strong>Conduct experiments</strong>: Measure ad performance for each combination. 4. <strong>Analyze results</strong>: Identify optimal settings and robust configurations.</p>
<p>Example: Optimizing ad copy and image to ensure consistent performance across different times of day, leading to more reliable ad outcomes.</p>
</section>
</section>
<section id="sequential-experimental-design" class="level3">
<h3 class="anchored" data-anchor-id="sequential-experimental-design">Sequential Experimental Design</h3>
<section id="sequential-experimental-design-1" class="level4">
<h4 class="anchored" data-anchor-id="sequential-experimental-design-1">11. Sequential Experimental Design</h4>
<p><strong>Question:</strong> How would you use sequential experimental design to test and optimize new features on Instagram?</p>
<p><strong>Answer:</strong> Sequential experimental design involves iterative testing and refinement.</p>
<p>Steps: 1. <strong>Initial experiment</strong>: Conduct a small-scale experiment with initial settings. 2. <strong>Analyze results</strong>: Identify promising settings and areas for improvement. 3. <strong>Refine design</strong>: Adjust factors and levels based on results. 4. <strong>Repeat</strong>: Conduct further experiments iteratively, refining the design until optimal settings are found.</p>
<p>Example: Testing a new feature by starting with a small user group, analyzing engagement, refining the feature, and repeating until desired performance is achieved.</p>
</section>
</section>
<section id="crossover-designs-2" class="level3">
<h3 class="anchored" data-anchor-id="crossover-designs-2">Crossover Designs</h3>
<section id="crossover-designs-3" class="level4">
<h4 class="anchored" data-anchor-id="crossover-designs-3">12. Crossover Designs</h4>
<p><strong>Question:</strong> Describe how you would use a crossover design to evaluate the effectiveness of different user interface changes on Instagram.</p>
<p><strong>Answer:</strong> Crossover designs involve participants experiencing multiple treatments in a specific order, reducing variability and improving efficiency.</p>
<p>Steps: 1. <strong>Randomize order</strong>: Randomly assign the order of treatments for each participant. 2. <strong>Conduct study</strong>: Each participant experiences all treatments, separated by washout periods. 3. <strong>Measure outcomes</strong>: Collect data for each treatment period. 4. <strong>Analyze results</strong>: Use paired analysis to compare treatments.</p>
<p>Example: Users experience different interface designs in random order, measuring engagement and satisfaction for each design, leading to more accurate comparisons.</p>
</section>
</section>
<section id="split-plot-designs" class="level3">
<h3 class="anchored" data-anchor-id="split-plot-designs">Split-Plot Designs</h3>
<section id="split-plot-designs-1" class="level4">
<h4 class="anchored" data-anchor-id="split-plot-designs-1">13. Split-Plot Designs</h4>
<p><strong>Question:</strong> Explain how split-plot designs can be used to test different ad strategies on Facebook, considering both main effects and interaction effects.</p>
<p><strong>Answer:</strong> Split-plot designs handle experiments with factors that are hard or easy to change, allowing efficient testing of main and interaction effects.</p>
<p>Steps: 1. <strong>Identify factors</strong>: Hard-to-change (e.g., ad platform) and easy-to-change (e.g., ad copy). 2. <strong>Assign plots</strong>: Assign hard-to-change factors to main plots and easy-to-change factors to subplots within main plots. 3. <strong>Conduct experiment</strong>: Measure outcomes for each combination. 4. <strong>Analyze results</strong>: Use mixed-model ANOVA to analyze main and interaction effects.</p>
<p>Example: Testing ad strategies across different platforms and varying ad copy within each platform, analyzing both main effects and interactions efficiently.</p>
</section>
</section>
<section id="nested-designs" class="level3">
<h3 class="anchored" data-anchor-id="nested-designs">Nested Designs</h3>
<section id="nested-designs-1" class="level4">
<h4 class="anchored" data-anchor-id="nested-designs-1">14. Nested Designs</h4>
<p><strong>Question:</strong> How would you use nested designs to analyze user engagement data from different geographic regions on Instagram?</p>
<p><strong>Answer:</strong> Nested designs handle hierarchical data structures, where one factor is nested within another.</p>
<p>Steps: 1. <strong>Identify factors</strong>: Geographic region (main factor) and user groups within regions (nested factor). 2. <strong>Assign users</strong>: Measure engagement within each group and region. 3. <strong>Analyze results</strong>: Use nested ANOVA to analyze differences within and between regions.</p>
<p>Example: Comparing engagement across regions and within different user groups in each region, providing insights into regional and group-specific patterns.</p>
</section>
</section>
<section id="latin-square-designs-1" class="level3">
<h3 class="anchored" data-anchor-id="latin-square-designs-1">Latin Square Designs</h3>
<section id="latin-square-designs-2" class="level4">
<h4 class="anchored" data-anchor-id="latin-square-designs-2">15. Latin Square Designs</h4>
<p><strong>Question:</strong> Explain how Latin square designs can be used to control for two sources of variability when testing content formats on Facebook.</p>
<p><strong>Answer:</strong> Latin square designs control for two nuisance factors while testing the primary factor of interest.</p>
<p>Steps: 1. <strong>Identify factors</strong>: Primary factor (content format) and two nuisance factors (e.g., time of day, day of the week). 2. <strong>Create Latin square</strong>: Arrange treatments in a square matrix ensuring each treatment appears once in each row and column. 3. <strong>Assign users</strong>: Randomly assign users to each cell of the matrix. 4. <strong>Analyze results</strong>: Use Latin square ANOVA to isolate the effect of the primary factor.</p>
<p>Example: Testing content formats while controlling for time of day and day of the week, ensuring unbiased results.</p>
</section>
</section>
<section id="graeco-latin-square-designs" class="level3">
<h3 class="anchored" data-anchor-id="graeco-latin-square-designs">Graeco-Latin Square Designs</h3>
<section id="graeco-latin-square-designs-1" class="level4">
<h4 class="anchored" data-anchor-id="graeco-latin-square-designs-1">16. Graeco-Latin Square Designs</h4>
<p><strong>Question:</strong> How would you use a Graeco-Latin square design to test multiple features on Instagram, controlling for three sources of variability?</p>
<p><strong>Answer:</strong> Graeco-Latin square designs control for three nuisance factors, allowing efficient testing of multiple features.</p>
<p>Steps: 1. <strong>Identify factors</strong>: Primary factor (feature) and three nuisance factors. 2. <strong>Create design</strong>: Arrange treatments in a Graeco-Latin square ensuring each treatment appears once in each row, column, and additional dimension. 3. <strong>Assign users</strong>: Randomly assign users to each cell of the matrix. 4. <strong>Analyze results</strong>: Use ANOVA to isolate the effect of the primary factor.</p>
<p>Example: Testing features while controlling for time of day, user demographics, and device type, ensuring comprehensive and unbiased results.</p>
</section>
</section>
<section id="incomplete-block-designs-1" class="level3">
<h3 class="anchored" data-anchor-id="incomplete-block-designs-1">Incomplete Block Designs</h3>
<section id="incomplete-block-designs-2" class="level4">
<h4 class="anchored" data-anchor-id="incomplete-block-designs-2">17. Incomplete Block Designs</h4>
<p><strong>Question:</strong> Describe how incomplete block designs can be used to test different advertising strategies on Facebook with limited resources.</p>
<p><strong>Answer:</strong> Incomplete block designs test a subset of all possible treatments, balancing efficiency and completeness.</p>
<p>Steps: 1. <strong>Identify factors</strong>: Advertising strategies. 2. <strong>Create blocks</strong>: Divide treatments into smaller blocks, ensuring each treatment appears in a balanced number of blocks. 3. <strong>Assign users</strong>: Randomly assign users to each block. 4. <strong>Analyze results</strong>: Use incomplete block ANOVA to analyze treatment effects.</p>
<p>Example: Testing multiple advertising strategies with limited budget by using an incomplete block design, providing insights with fewer resources.</p>
</section>
</section>
<section id="adaptive-designs" class="level3">
<h3 class="anchored" data-anchor-id="adaptive-designs">Adaptive Designs</h3>
<section id="adaptive-designs-1" class="level4">
<h4 class="anchored" data-anchor-id="adaptive-designs-1">18. Adaptive Designs</h4>
<p><strong>Question:</strong> How would you use adaptive designs to optimize a new feature rollout on Instagram?</p>
<p><strong>Answer:</strong> Adaptive designs allow modifications to the experiment based on interim results, improving efficiency and effectiveness.</p>
<p>Steps: 1. <strong>Initial phase</strong>: Start with a pilot test of the new feature. 2. <strong>Interim analysis</strong>: Analyze early results and make adjustments (e.g., sample size, treatment allocation). 3. <strong>Adapt design</strong>: Implement changes based on interim findings. 4. <strong>Final analysis</strong>: Conduct a full analysis after the experiment concludes.</p>
<p>Example: Rolling out a new feature, monitoring user engagement, and adapting the design based on initial feedback to optimize performance and resource use.</p>
</section>
</section>
<section id="optimal-design-theory" class="level3">
<h3 class="anchored" data-anchor-id="optimal-design-theory">Optimal Design Theory</h3>
<section id="optimal-design-theory-1" class="level4">
<h4 class="anchored" data-anchor-id="optimal-design-theory-1">19. Optimal Design Theory</h4>
<p><strong>Question:</strong> Explain how optimal design theory can be used to design efficient experiments for testing multiple features on Facebook.</p>
<p><strong>Answer:</strong> Optimal design theory selects the best experimental setup to maximize information gained while minimizing costs.</p>
<p>Steps: 1. <strong>Define objectives</strong>: Determine what needs to be estimated (e.g., main effects, interactions). 2. <strong>Select design</strong>: Choose the optimal design criteria (e.g., D-optimality, minimizing variance of estimates). 3. <strong>Construct design</strong>: Use algorithms to generate the most efficient experimental setup. 4. <strong>Conduct experiment</strong>: Implement the design and collect data.</p>
<p>Example: Designing an experiment to test multiple features on Facebook efficiently, ensuring high-quality estimates with minimal resources.</p>
</section>
</section>
<section id="multi-arm-bandit-algorithms" class="level3">
<h3 class="anchored" data-anchor-id="multi-arm-bandit-algorithms">Multi-Arm Bandit Algorithms</h3>
<section id="multi-arm-bandit-algorithms-1" class="level4">
<h4 class="anchored" data-anchor-id="multi-arm-bandit-algorithms-1">20. Multi-Arm Bandit Algorithms</h4>
<p><strong>Question:</strong> How would you use multi-arm bandit algorithms to dynamically optimize ad placements on Instagram?</p>
<p><strong>Answer:</strong> Multi-arm bandit algorithms balance exploration and exploitation to maximize cumulative rewards.</p>
<p>Steps: 1. <strong>Initialize arms</strong>: Define different ad placements as arms. 2. <strong>Select strategy</strong>: Choose an algorithm (e.g., epsilon-greedy, UCB). 3. <strong>Deploy ads</strong>: Allocate initial traffic to different placements. 4. <strong>Update strategy</strong>: Continuously update placement probabilities based on observed performance. 5. <strong>Optimize</strong>: Focus on the best-performing placements while still exploring others.</p>
<p>Example: Using a multi-arm bandit algorithm to dynamically allocate ad placements, optimizing for highest engagement and conversion rates.</p>
<p>This detailed set of questions and answers, including examples, provides a robust framework to prepare for interviews focusing on experimental design in the context of social media data science roles. Each question is designed to test the understanding and application of various experimental design techniques, critical for analyzing and deriving insights from social media data.</p>
</section>
</section>
</section>
</section>



</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>