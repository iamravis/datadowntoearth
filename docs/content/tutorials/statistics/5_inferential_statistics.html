<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.47">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Ravi Shankar">

<title>inferential_statistics – Data Down To Earth</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../logo.png" rel="icon" type="image/png">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../../styles.css">
<link rel="stylesheet" href="../../content.css">
<meta property="og:title" content="– Data Down To Earth">
<meta property="og:site_name" content="Data Down To Earth">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../../logo.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Data Down To Earth</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-projects" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Projects</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-projects">    
        <li>
    <a class="dropdown-item" href="../../../projects/dsml_projects.html">
 <span class="dropdown-text">Data Science and ML Projects</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../projects/genai_projects.html">
 <span class="dropdown-text">Generative AI Projects</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-tutorials" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Tutorials</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-tutorials">    
        <li>
    <a class="dropdown-item" href="../../../topics/statistics.html">
 <span class="dropdown-text">Statistics &amp; Probability</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../topics/machine_learning.html">
 <span class="dropdown-text">Machine Learning</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../topics/de.html">
 <span class="dropdown-text">Data Engineering</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../topics/generative_ai.html">
 <span class="dropdown-text">Generative AI</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../topics/public_health.html">
 <span class="dropdown-text">Public Health</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../topics/product_sense.html">
 <span class="dropdown-text">Product Sense</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../../notes/notes.html"> 
<span class="menu-text">Notes</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/iamrsps"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/iamravishankar/"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content column-page" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
</div>



<div class="quarto-title-meta column-page">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Ravi Shankar </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="chapter-5-inferential-statistics" class="level1 text-content">
<h1>Chapter 5: Inferential Statistics</h1>
<section id="population-vs.-sample" class="level2">
<h2 class="anchored" data-anchor-id="population-vs.-sample">Population vs.&nbsp;Sample</h2>
<section id="definition" class="level3">
<h3 class="anchored" data-anchor-id="definition">Definition</h3>
<p>Inferential statistics often involve drawing conclusions about a population based on information obtained from a sample. Understanding the distinction between a population and a sample is fundamental to inferential statistics.</p>
</section>
<section id="population" class="level3">
<h3 class="anchored" data-anchor-id="population">Population</h3>
<p>A population includes all members of a defined group that we are studying or collecting information on for data-driven decisions. It can be finite or infinite, depending on the context. For instance, the population could be all adult males in a city or all possible outcomes of rolling a fair die.</p>
</section>
<section id="sample" class="level3">
<h3 class="anchored" data-anchor-id="sample">Sample</h3>
<p>A sample is a subset of the population that is selected for the actual study. This subset is used to make inferences about the population due to practical constraints like time, cost, and accessibility. The quality of the sample often determines the reliability of the inferences.</p>
</section>
<section id="example" class="level3">
<h3 class="anchored" data-anchor-id="example">Example</h3>
<p>If we are studying the heights of all adult males in a city, the population is all adult males in the city. A sample might be 100 adult males chosen randomly. The sample should ideally represent the population’s characteristics to draw accurate inferences.</p>
</section>
</section>
<section id="sampling-methods" class="level2">
<h2 class="anchored" data-anchor-id="sampling-methods">Sampling Methods</h2>
<section id="simple-random-sampling" class="level3">
<h3 class="anchored" data-anchor-id="simple-random-sampling">Simple Random Sampling</h3>
<section id="definition-1" class="level4">
<h4 class="anchored" data-anchor-id="definition-1">Definition</h4>
<p>Simple random sampling is a fundamental sampling technique where each member of the population has an equal chance of being included in the sample. This method ensures that the sample is unbiased and representative of the population.</p>
</section>
<section id="procedure" class="level4">
<h4 class="anchored" data-anchor-id="procedure">Procedure</h4>
<p>Assign a unique number to each member of the population. Use a random number generator or a similar randomization method to select the sample. The selection process should be completely random, without any influence or bias.</p>
</section>
<section id="example-1" class="level4">
<h4 class="anchored" data-anchor-id="example-1">Example</h4>
<p>Choosing 10 students randomly from a class of 30 students. Each student has an equal probability of being selected, ensuring that the sample is representative of the class.</p>
<div id="d7a815c6" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># List of social media usernames (population)</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>population <span class="op">=</span> [<span class="st">'user1'</span>, <span class="st">'user2'</span>, <span class="st">'user3'</span>, <span class="st">'user4'</span>, <span class="st">'user5'</span>,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>              <span class="st">'user6'</span>, <span class="st">'user7'</span>, <span class="st">'user8'</span>, <span class="st">'user9'</span>, <span class="st">'user10'</span>,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>              <span class="st">'user11'</span>, <span class="st">'user12'</span>, <span class="st">'user13'</span>, <span class="st">'user14'</span>, <span class="st">'user15'</span>]</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of samples to select</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>sample_size <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform simple random sampling</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>sample <span class="op">=</span> random.sample(population, sample_size)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the sample</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Randomly selected sample of"</span>, sample_size, <span class="st">"social media usernames:"</span>)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sample)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Randomly selected sample of 5 social media usernames:
['user12', 'user14', 'user9', 'user13', 'user2']</code></pre>
</div>
</div>
<hr>
</section>
</section>
<section id="stratified-sampling" class="level3">
<h3 class="anchored" data-anchor-id="stratified-sampling">Stratified Sampling</h3>
<section id="definition-2" class="level4">
<h4 class="anchored" data-anchor-id="definition-2">Definition</h4>
<p>Stratified sampling involves dividing the population into distinct subgroups or strata that share similar characteristics. Samples are then taken from each stratum proportionally. This method ensures that all subgroups are represented in the sample, improving the precision of the estimates.</p>
</section>
<section id="procedure-1" class="level4">
<h4 class="anchored" data-anchor-id="procedure-1">Procedure</h4>
<p>Divide the population into strata based on a characteristic (e.g., age, gender). Then, take a random sample from each stratum. The size of each sample should be proportional to the size of the stratum in the population.</p>
</section>
<section id="example-2" class="level4">
<h4 class="anchored" data-anchor-id="example-2">Example</h4>
<p>Sampling from different age groups in a population to ensure representation from each age group. For instance, if the population consists of 60% adults and 40% children, the sample should reflect this ratio.</p>
<div id="18ff94e7" class="cell" data-execution_count="2">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Population (list of individuals with age groups)</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>population <span class="op">=</span> [</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'name'</span>: <span class="st">'Person1'</span>, <span class="st">'age_group'</span>: <span class="st">'Adult'</span>},</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'name'</span>: <span class="st">'Person2'</span>, <span class="st">'age_group'</span>: <span class="st">'Child'</span>},</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'name'</span>: <span class="st">'Person3'</span>, <span class="st">'age_group'</span>: <span class="st">'Adult'</span>},</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'name'</span>: <span class="st">'Person4'</span>, <span class="st">'age_group'</span>: <span class="st">'Child'</span>},</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'name'</span>: <span class="st">'Person5'</span>, <span class="st">'age_group'</span>: <span class="st">'Adult'</span>},</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'name'</span>: <span class="st">'Person6'</span>, <span class="st">'age_group'</span>: <span class="st">'Adult'</span>},</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'name'</span>: <span class="st">'Person7'</span>, <span class="st">'age_group'</span>: <span class="st">'Child'</span>},</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'name'</span>: <span class="st">'Person8'</span>, <span class="st">'age_group'</span>: <span class="st">'Adult'</span>},</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'name'</span>: <span class="st">'Person9'</span>, <span class="st">'age_group'</span>: <span class="st">'Child'</span>},</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'name'</span>: <span class="st">'Person10'</span>, <span class="st">'age_group'</span>: <span class="st">'Adult'</span>},</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'name'</span>: <span class="st">'Person11'</span>, <span class="st">'age_group'</span>: <span class="st">'Adult'</span>},</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'name'</span>: <span class="st">'Person12'</span>, <span class="st">'age_group'</span>: <span class="st">'Child'</span>},</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'name'</span>: <span class="st">'Person13'</span>, <span class="st">'age_group'</span>: <span class="st">'Child'</span>},</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'name'</span>: <span class="st">'Person14'</span>, <span class="st">'age_group'</span>: <span class="st">'Adult'</span>},</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'name'</span>: <span class="st">'Person15'</span>, <span class="st">'age_group'</span>: <span class="st">'Child'</span>}</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Define strata based on age groups</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>strata <span class="op">=</span> {</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Adult'</span>: [],</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Child'</span>: []</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign individuals to respective strata</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> person <span class="kw">in</span> population:</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>    strata[person[<span class="st">'age_group'</span>]].append(person)</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of samples to select from each stratum</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>sample_size_per_stratum <span class="op">=</span> {</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Adult'</span>: <span class="dv">3</span>,   <span class="co"># proportional to 60% of the population</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Child'</span>: <span class="dv">2</span>    <span class="co"># proportional to 40% of the population</span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform stratified sampling</span></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>sample <span class="op">=</span> []</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> stratum, size <span class="kw">in</span> sample_size_per_stratum.items():</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>    sample.extend(random.sample(strata[stratum], size))</span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the sample</span></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Stratified sample:"</span>)</span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> person <span class="kw">in</span> sample:</span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(person[<span class="st">'name'</span>], <span class="st">'-'</span>, person[<span class="st">'age_group'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Stratified sample:
Person8 - Adult
Person1 - Adult
Person11 - Adult
Person15 - Child
Person12 - Child</code></pre>
</div>
</div>
<hr>
</section>
</section>
<section id="cluster-sampling" class="level3">
<h3 class="anchored" data-anchor-id="cluster-sampling">Cluster Sampling</h3>
<section id="definition-3" class="level4">
<h4 class="anchored" data-anchor-id="definition-3">Definition</h4>
<p>Cluster sampling involves dividing the population into clusters, usually based on geographical areas or natural groupings, and then randomly selecting entire clusters for the study. This method is useful when the population is large and spread out.</p>
</section>
<section id="procedure-2" class="level4">
<h4 class="anchored" data-anchor-id="procedure-2">Procedure</h4>
<p>Divide the population into clusters (e.g., geographical areas). Randomly select some clusters, and then sample all members within those clusters. This approach can be more practical and cost-effective than simple random sampling, especially for large populations.</p>
</section>
<section id="example-3" class="level4">
<h4 class="anchored" data-anchor-id="example-3">Example</h4>
<p>Selecting several schools at random from a district and then surveying all students in those schools. This method reduces the cost and time required to collect data from the entire population.</p>
<div id="5bb3ed71" class="cell" data-execution_count="3">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Population (list of schools with students)</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>population <span class="op">=</span> [</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'school'</span>: <span class="st">'School1'</span>, <span class="st">'students'</span>: [<span class="st">'Student1'</span>, <span class="st">'Student2'</span>, <span class="st">'Student3'</span>]},</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'school'</span>: <span class="st">'School2'</span>, <span class="st">'students'</span>: [<span class="st">'Student4'</span>, <span class="st">'Student5'</span>, <span class="st">'Student6'</span>]},</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'school'</span>: <span class="st">'School3'</span>, <span class="st">'students'</span>: [<span class="st">'Student7'</span>, <span class="st">'Student8'</span>, <span class="st">'Student9'</span>]},</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'school'</span>: <span class="st">'School4'</span>, <span class="st">'students'</span>: [<span class="st">'Student10'</span>, <span class="st">'Student11'</span>, <span class="st">'Student12'</span>]},</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'school'</span>: <span class="st">'School5'</span>, <span class="st">'students'</span>: [<span class="st">'Student13'</span>, <span class="st">'Student14'</span>, <span class="st">'Student15'</span>]}</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of clusters (schools) to select</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>num_clusters <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform cluster sampling</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>selected_clusters <span class="op">=</span> random.sample(population, num_clusters)</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Collect all students from selected clusters</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>sample <span class="op">=</span> []</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> cluster <span class="kw">in</span> selected_clusters:</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>    sample.extend(cluster[<span class="st">'students'</span>])</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the sample</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Cluster sample of students:"</span>)</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sample)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Cluster sample of students:
['Student7', 'Student8', 'Student9', 'Student1', 'Student2', 'Student3']</code></pre>
</div>
</div>
<hr>
</section>
</section>
<section id="systematic-sampling" class="level3">
<h3 class="anchored" data-anchor-id="systematic-sampling">Systematic Sampling</h3>
<section id="definition-4" class="level4">
<h4 class="anchored" data-anchor-id="definition-4">Definition</h4>
<p>Systematic sampling involves selecting every nth member from a list of the population. This method is straightforward and ensures a degree of randomness, although it can introduce bias if there is a hidden pattern in the population list.</p>
</section>
<section id="procedure-3" class="level4">
<h4 class="anchored" data-anchor-id="procedure-3">Procedure</h4>
<p>Arrange the population in some order (e.g., alphabetical, by date). Choose a starting point at random and then select every nth member. The value of n is typically determined by dividing the population size by the desired sample size.</p>
</section>
<section id="example-4" class="level4">
<h4 class="anchored" data-anchor-id="example-4">Example</h4>
<p>Choosing every 10th person on a list of registered voters. This method is easy to implement and ensures that the sample is spread evenly across the population.</p>
<div id="8233fe63" class="cell" data-execution_count="4">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Population (list of individuals)</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>population <span class="op">=</span> [<span class="st">'Person1'</span>, <span class="st">'Person2'</span>, <span class="st">'Person3'</span>, <span class="st">'Person4'</span>, <span class="st">'Person5'</span>,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>              <span class="st">'Person6'</span>, <span class="st">'Person7'</span>, <span class="st">'Person8'</span>, <span class="st">'Person9'</span>, <span class="st">'Person10'</span>,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>              <span class="st">'Person11'</span>, <span class="st">'Person12'</span>, <span class="st">'Person13'</span>, <span class="st">'Person14'</span>, <span class="st">'Person15'</span>,</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>              <span class="st">'Person16'</span>, <span class="st">'Person17'</span>, <span class="st">'Person18'</span>, <span class="st">'Person19'</span>, <span class="st">'Person20'</span>]</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Determine sample size</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>sample_size <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate interval (n)</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>interval <span class="op">=</span> <span class="bu">len</span>(population) <span class="op">//</span> sample_size</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Randomly choose a starting point</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>start_index <span class="op">=</span> random.randint(<span class="dv">0</span>, interval <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform systematic sampling</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>sample <span class="op">=</span> []</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(start_index, <span class="bu">len</span>(population), interval):</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>    sample.append(population[i])</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the sample</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Systematic sample of"</span>, sample_size, <span class="st">"individuals:"</span>)</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sample)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Systematic sample of 5 individuals:
['Person1', 'Person5', 'Person9', 'Person13', 'Person17']</code></pre>
</div>
</div>
<hr>
</section>
</section>
<section id="multistage-sampling" class="level3">
<h3 class="anchored" data-anchor-id="multistage-sampling">Multistage Sampling</h3>
<section id="definition-5" class="level4">
<h4 class="anchored" data-anchor-id="definition-5">Definition</h4>
<p>Multistage sampling involves combining several sampling methods. It typically involves selecting clusters first and then performing further sampling within those clusters.</p>
</section>
<section id="procedure-4" class="level4">
<h4 class="anchored" data-anchor-id="procedure-4">Procedure</h4>
<p>First, divide the population into large clusters. Randomly select clusters, and then perform random or systematic sampling within the selected clusters.</p>
</section>
<section id="example-5" class="level4">
<h4 class="anchored" data-anchor-id="example-5">Example</h4>
<p>Selecting districts randomly, then schools within those districts, and finally students within those schools for a nationwide educational survey.</p>
<div id="b307805b" class="cell" data-execution_count="5">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Population (list of districts with schools and students)</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>population <span class="op">=</span> [</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'district'</span>: <span class="st">'District1'</span>, <span class="st">'schools'</span>: [</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>        {<span class="st">'school'</span>: <span class="st">'School1'</span>, <span class="st">'students'</span>: [<span class="st">'Student1'</span>, <span class="st">'Student2'</span>, <span class="st">'Student3'</span>]},</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>        {<span class="st">'school'</span>: <span class="st">'School2'</span>, <span class="st">'students'</span>: [<span class="st">'Student4'</span>, <span class="st">'Student5'</span>, <span class="st">'Student6'</span>]}</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    ]},</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'district'</span>: <span class="st">'District2'</span>, <span class="st">'schools'</span>: [</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>        {<span class="st">'school'</span>: <span class="st">'School3'</span>, <span class="st">'students'</span>: [<span class="st">'Student7'</span>, <span class="st">'Student8'</span>, <span class="st">'Student9'</span>]},</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>        {<span class="st">'school'</span>: <span class="st">'School4'</span>, <span class="st">'students'</span>: [<span class="st">'Student10'</span>, <span class="st">'Student11'</span>, <span class="st">'Student12'</span>]}</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    ]},</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'district'</span>: <span class="st">'District3'</span>, <span class="st">'schools'</span>: [</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>        {<span class="st">'school'</span>: <span class="st">'School5'</span>, <span class="st">'students'</span>: [<span class="st">'Student13'</span>, <span class="st">'Student14'</span>, <span class="st">'Student15'</span>]},</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>        {<span class="st">'school'</span>: <span class="st">'School6'</span>, <span class="st">'students'</span>: [<span class="st">'Student16'</span>, <span class="st">'Student17'</span>, <span class="st">'Student18'</span>]}</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    ]}</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of districts to select</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>num_districts <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform multistage sampling</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>selected_districts <span class="op">=</span> random.sample(population, num_districts)</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Collect all students from selected districts and schools</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>sample <span class="op">=</span> []</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> district <span class="kw">in</span> selected_districts:</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> school <span class="kw">in</span> district[<span class="st">'schools'</span>]:</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>        sample.extend(school[<span class="st">'students'</span>])</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the sample</span></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Multistage sample of students:"</span>)</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sample)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Multistage sample of students:
['Student13', 'Student14', 'Student15', 'Student16', 'Student17', 'Student18', 'Student7', 'Student8', 'Student9', 'Student10', 'Student11', 'Student12']</code></pre>
</div>
</div>
<hr>
</section>
</section>
<section id="bootstrapping" class="level3">
<h3 class="anchored" data-anchor-id="bootstrapping">Bootstrapping</h3>
<section id="definition-6" class="level4">
<h4 class="anchored" data-anchor-id="definition-6">Definition</h4>
<p>Bootstrapping is a resampling technique used to estimate the distribution of a statistic by repeatedly sampling with replacement from the observed data.</p>
</section>
<section id="procedure-5" class="level4">
<h4 class="anchored" data-anchor-id="procedure-5">Procedure</h4>
<p>Generate multiple bootstrap samples by randomly sampling with replacement from the original sample. Calculate the statistic of interest for each bootstrap sample to build a distribution.</p>
</section>
<section id="example-6" class="level4">
<h4 class="anchored" data-anchor-id="example-6">Example</h4>
<p>Estimating the confidence interval for the mean income of a sample of households by generating thousands of bootstrap samples and calculating the mean for each sample.</p>
</section>
<section id="parametric-bootstrap" class="level4">
<h4 class="anchored" data-anchor-id="parametric-bootstrap">Parametric Bootstrap</h4>
<section id="definition-7" class="level5">
<h5 class="anchored" data-anchor-id="definition-7">Definition</h5>
<p>Involves resampling based on an assumed parametric distribution of the data.</p>
</section>
<section id="example-7" class="level5">
<h5 class="anchored" data-anchor-id="example-7">Example</h5>
<p>Assuming the data follows a normal distribution, generate bootstrap samples from this distribution to estimate parameters.</p>
<div id="9b27a633" class="cell" data-execution_count="6">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample data (income of households)</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>sample_data <span class="op">=</span> np.array([<span class="dv">30000</span>, <span class="dv">35000</span>, <span class="dv">40000</span>, <span class="dv">45000</span>, <span class="dv">50000</span>, <span class="dv">55000</span>, <span class="dv">60000</span>, <span class="dv">65000</span>, <span class="dv">70000</span>, <span class="dv">75000</span>])</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of bootstrap samples</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>num_bootstrap_samples <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate bootstrap samples and calculate mean for each sample</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>bootstrap_means <span class="op">=</span> []</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(num_bootstrap_samples):</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    bootstrap_sample <span class="op">=</span> np.random.choice(sample_data, size<span class="op">=</span><span class="bu">len</span>(sample_data), replace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>    bootstrap_mean <span class="op">=</span> np.mean(bootstrap_sample)</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>    bootstrap_means.append(bootstrap_mean)</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate 95% confidence interval</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>confidence_interval <span class="op">=</span> np.percentile(bootstrap_means, [<span class="fl">2.5</span>, <span class="fl">97.5</span>])</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Print results</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Bootstrap estimated mean income:"</span>, np.mean(sample_data))</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"95% Confidence Interval for the mean income:"</span>, confidence_interval)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Bootstrap estimated mean income: 52500.0
95% Confidence Interval for the mean income: [44000. 61500.]</code></pre>
</div>
</div>
<hr>
</section>
</section>
<section id="non-parametric-bootstrap" class="level4">
<h4 class="anchored" data-anchor-id="non-parametric-bootstrap">Non-Parametric Bootstrap</h4>
<section id="definition-8" class="level5">
<h5 class="anchored" data-anchor-id="definition-8">Definition</h5>
<p>Involves resampling directly from the observed data without assuming any parametric distribution.</p>
</section>
<section id="example-8" class="level5">
<h5 class="anchored" data-anchor-id="example-8">Example</h5>
<p>Generating bootstrap samples by resampling with replacement directly from the observed data of household incomes.</p>
<div id="514e7f28" class="cell" data-execution_count="7">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample data (income of households)</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>sample_data <span class="op">=</span> np.array([<span class="dv">30000</span>, <span class="dv">35000</span>, <span class="dv">40000</span>, <span class="dv">45000</span>, <span class="dv">50000</span>, <span class="dv">55000</span>, <span class="dv">60000</span>, <span class="dv">65000</span>, <span class="dv">70000</span>, <span class="dv">75000</span>])</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of bootstrap samples</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>num_bootstrap_samples <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate bootstrap samples and calculate mean for each sample</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>bootstrap_means <span class="op">=</span> []</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(num_bootstrap_samples):</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    bootstrap_sample <span class="op">=</span> np.random.choice(sample_data, size<span class="op">=</span><span class="bu">len</span>(sample_data), replace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>    bootstrap_mean <span class="op">=</span> np.mean(bootstrap_sample)</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>    bootstrap_means.append(bootstrap_mean)</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate 95% confidence interval</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>confidence_interval <span class="op">=</span> np.percentile(bootstrap_means, [<span class="fl">2.5</span>, <span class="fl">97.5</span>])</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Print results</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Bootstrap estimated mean income:"</span>, np.mean(sample_data))</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"95% Confidence Interval for the mean income (non-parametric bootstrap):"</span>, confidence_interval)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Bootstrap estimated mean income: 52500.0
95% Confidence Interval for the mean income (non-parametric bootstrap): [43500. 61000.]</code></pre>
</div>
</div>
<hr>
</section>
</section>
</section>
<section id="jackknife-resampling" class="level3">
<h3 class="anchored" data-anchor-id="jackknife-resampling">Jackknife Resampling</h3>
<section id="definition-9" class="level4">
<h4 class="anchored" data-anchor-id="definition-9">Definition</h4>
<p>The jackknife is a resampling technique used to estimate the bias and variance of a statistic. It involves systematically leaving out one observation at a time from the sample set and calculating the statistic for each subsample.</p>
</section>
<section id="procedure-6" class="level4">
<h4 class="anchored" data-anchor-id="procedure-6">Procedure</h4>
<p>Remove one observation from the sample, calculate the statistic for the remaining data, and repeat this process for each observation in the sample.</p>
</section>
<section id="example-9" class="level4">
<h4 class="anchored" data-anchor-id="example-9">Example</h4>
<p>Estimating the variance of the sample mean by computing the mean for each subsample created by leaving out one observation at a time.</p>
<div id="8cb94bb2" class="cell" data-execution_count="8">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample data (income of households)</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>sample_data <span class="op">=</span> np.array([<span class="dv">30000</span>, <span class="dv">35000</span>, <span class="dv">40000</span>, <span class="dv">45000</span>, <span class="dv">50000</span>, <span class="dv">55000</span>, <span class="dv">60000</span>, <span class="dv">65000</span>, <span class="dv">70000</span>, <span class="dv">75000</span>])</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of observations</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="bu">len</span>(sample_data)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Jackknife resampling to estimate variance of the mean</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>jackknife_means <span class="op">=</span> []</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create subsample by leaving out one observation</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>    subsample <span class="op">=</span> np.delete(sample_data, i)</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate mean of the subsample</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>    subsample_mean <span class="op">=</span> np.mean(subsample)</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Store mean in jackknife means</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>    jackknife_means.append(subsample_mean)</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate variance of the mean using jackknife</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>jackknife_variance <span class="op">=</span> (n <span class="op">-</span> <span class="dv">1</span>) <span class="op">/</span> n <span class="op">*</span> np.<span class="bu">sum</span>((np.array(jackknife_means) <span class="op">-</span> np.mean(sample_data))<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Print results</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Jackknife estimated mean income:"</span>, np.mean(sample_data))</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Jackknife estimated variance of the mean income:"</span>, jackknife_variance)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Jackknife estimated mean income: 52500.0
Jackknife estimated variance of the mean income: 22916666.666666694</code></pre>
</div>
</div>
<hr>
</section>
</section>
<section id="importance-sampling" class="level3">
<h3 class="anchored" data-anchor-id="importance-sampling">Importance Sampling</h3>
<section id="definition-10" class="level4">
<h4 class="anchored" data-anchor-id="definition-10">Definition</h4>
<p>Importance sampling is a technique used to estimate properties of a particular distribution while only having samples generated from a different distribution.</p>
</section>
<section id="procedure-7" class="level4">
<h4 class="anchored" data-anchor-id="procedure-7">Procedure</h4>
<p>Generate samples from an easy-to-sample distribution, reweight the samples based on the ratio of the target distribution to the sampling distribution, and use these weighted samples to estimate the desired properties.</p>
</section>
<section id="example-10" class="level4">
<h4 class="anchored" data-anchor-id="example-10">Example</h4>
<p>Estimating the tail probabilities of a complex distribution by sampling from a simpler, related distribution and adjusting the weights accordingly.</p>
<div id="7eebb879" class="cell" data-execution_count="9">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the target distribution (complex distribution)</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> target_distribution(x):</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.exp(<span class="op">-</span>x) <span class="op">/</span> (<span class="dv">1</span> <span class="op">+</span> np.exp(<span class="op">-</span>x))<span class="op">**</span><span class="dv">2</span>  <span class="co"># Example complex distribution</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the sampling distribution (easy-to-sample distribution)</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> sampling_distribution(x):</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.exp(<span class="op">-</span>x)  <span class="co"># Example easier distribution, could be a normal distribution, uniform distribution, etc.</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of samples</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>num_samples <span class="op">=</span> <span class="dv">10000</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate samples from the sampling distribution</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> np.random.exponential(size<span class="op">=</span>num_samples)</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate weights using the ratio of target to sampling distribution</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>weights <span class="op">=</span> target_distribution(samples) <span class="op">/</span> sampling_distribution(samples)</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate tail probability (e.g., P(X &gt; 5))</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>tail_probability_estimate <span class="op">=</span> np.mean(weights <span class="op">*</span> (samples <span class="op">&gt;</span> <span class="dv">5</span>))</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Print results</span></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Estimated tail probability using importance sampling:"</span>, tail_probability_estimate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Estimated tail probability using importance sampling: 0.005659504070675571</code></pre>
</div>
</div>
<hr>
</section>
</section>
<section id="reservoir-sampling" class="level3">
<h3 class="anchored" data-anchor-id="reservoir-sampling">Reservoir Sampling</h3>
<section id="definition-11" class="level4">
<h4 class="anchored" data-anchor-id="definition-11">Definition</h4>
<p>Reservoir sampling is an algorithm for sampling <span class="math inline">\(k\)</span> items from a large or unknown-sized stream of items.</p>
</section>
<section id="procedure-8" class="level4">
<h4 class="anchored" data-anchor-id="procedure-8">Procedure</h4>
<p>Maintain a reservoir of the first <span class="math inline">\(k\)</span> items. For each subsequent item in the stream, replace a randomly chosen item in the reservoir with decreasing probability.</p>
</section>
<section id="example-11" class="level4">
<h4 class="anchored" data-anchor-id="example-11">Example</h4>
<p>Selecting a random sample of 10 elements from a very large file that cannot be loaded into memory.</p>
<div id="d71e9215" class="cell" data-execution_count="10">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reservoir_sampling(stream, k):</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    reservoir <span class="op">=</span> []</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fill the reservoir with the first k elements</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> item <span class="kw">in</span> stream:</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>        n <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(reservoir) <span class="op">&lt;</span> k:</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>            reservoir.append(item)</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Randomly replace elements in the reservoir</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>            j <span class="op">=</span> random.randint(<span class="dv">0</span>, n <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> j <span class="op">&lt;</span> k:</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>                reservoir[j] <span class="op">=</span> item</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> reservoir</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Example usage</span></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">"__main__"</span>:</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Simulating a large stream of numbers (could be from a file or generator)</span></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>    stream <span class="op">=</span> <span class="bu">range</span>(<span class="dv">1000</span>)</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Number of items to sample</span></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>    k <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Perform reservoir sampling</span></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>    sampled_items <span class="op">=</span> reservoir_sampling(stream, k)</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Print the sampled items</span></span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Random sample of"</span>, k, <span class="st">"elements:"</span>, sampled_items)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Random sample of 10 elements: [449, 156, 592, 697, 493, 970, 714, 82, 210, 610]</code></pre>
</div>
</div>
<hr>
</section>
</section>
<section id="acceptance-rejection-sampling" class="level3">
<h3 class="anchored" data-anchor-id="acceptance-rejection-sampling">Acceptance-Rejection Sampling</h3>
<section id="definition-12" class="level4">
<h4 class="anchored" data-anchor-id="definition-12">Definition</h4>
<p>Acceptance-rejection sampling is a technique used to generate observations from a target distribution by sampling from a proposal distribution and accepting or rejecting the samples based on a criterion.</p>
</section>
<section id="procedure-9" class="level4">
<h4 class="anchored" data-anchor-id="procedure-9">Procedure</h4>
<p>Sample from a proposal distribution and accept the sample with a probability proportional to the ratio of the target density to the proposal density at that sample point.</p>
</section>
<section id="example-12" class="level4">
<h4 class="anchored" data-anchor-id="example-12">Example</h4>
<p>Generating samples from a complex distribution using a simpler, uniform distribution and accepting samples based on their likelihood ratios.</p>
<div id="aa43803b" class="cell" data-execution_count="11">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the target distribution (complex distribution)</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> target_distribution(x):</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fl">0.3</span> <span class="op">*</span> np.exp(<span class="op">-</span><span class="fl">0.2</span> <span class="op">*</span> x<span class="op">**</span><span class="dv">2</span>) <span class="op">+</span> <span class="fl">0.7</span> <span class="op">*</span> np.exp(<span class="op">-</span><span class="fl">0.2</span> <span class="op">*</span> (x <span class="op">-</span> <span class="dv">10</span>)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the proposal distribution (uniform distribution in this example)</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> proposal_distribution(low, high, size<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.random.uniform(low, high, size)</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform acceptance-rejection sampling</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> acceptance_rejection_sampling(target_dist, proposal_dist, proposal_low, proposal_high, num_samples):</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>    samples <span class="op">=</span> []</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>    max_target <span class="op">=</span> np.<span class="bu">max</span>(target_dist(np.linspace(proposal_low, proposal_high, <span class="dv">1000</span>)))</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="bu">len</span>(samples) <span class="op">&lt;</span> num_samples:</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> proposal_dist(proposal_low, proposal_high)</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>        u <span class="op">=</span> np.random.uniform(<span class="dv">0</span>, max_target)</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> u <span class="op">&lt;</span> target_dist(x):</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>            samples.append(x)</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.array(samples)</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameters</span></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>proposal_low <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>proposal_high <span class="op">=</span> <span class="dv">20</span></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>num_samples <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate samples using acceptance-rejection sampling</span></span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> acceptance_rejection_sampling(target_distribution, proposal_distribution, proposal_low, proposal_high, num_samples)</span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting</span></span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>x_vals <span class="op">=</span> np.linspace(proposal_low, proposal_high, <span class="dv">1000</span>)</span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a>plt.plot(x_vals, target_distribution(x_vals), label<span class="op">=</span><span class="st">'Target Distribution'</span>)</span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a>plt.hist(samples, bins<span class="op">=</span><span class="dv">30</span>, density<span class="op">=</span><span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, label<span class="op">=</span><span class="st">'Samples from Target Distribution'</span>)</span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Acceptance-Rejection Sampling'</span>)</span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'x'</span>)</span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Density'</span>)</span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="5_inferential_statistics_files/figure-html/cell-12-output-1.png" width="663" height="523" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="gibbs-sampling" class="level3">
<h3 class="anchored" data-anchor-id="gibbs-sampling">Gibbs Sampling</h3>
<section id="definition-13" class="level4">
<h4 class="anchored" data-anchor-id="definition-13">Definition</h4>
<p>Gibbs sampling is a Markov Chain Monte Carlo (MCMC) algorithm used to generate samples from a multivariate probability distribution by iteratively sampling from the conditional distributions of each variable.</p>
</section>
<section id="procedure-10" class="level4">
<h4 class="anchored" data-anchor-id="procedure-10">Procedure</h4>
<p>Iteratively sample each variable from its conditional distribution given the current values of the other variables.</p>
</section>
<section id="example-13" class="level4">
<h4 class="anchored" data-anchor-id="example-13">Example</h4>
<p>Sampling from a joint distribution of multiple correlated variables, such as in Bayesian networks or spatial statistics.</p>
<div id="96e7ab58" class="cell" data-execution_count="12">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Define parameters for the bivariate normal distribution</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>mean <span class="op">=</span> np.array([<span class="dv">5</span>, <span class="dv">10</span>])</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>covariance <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="fl">0.7</span>], [<span class="fl">0.7</span>, <span class="dv">1</span>]])</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to sample from conditional distribution of X1 given X2</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> sample_X1_given_X2(x2):</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    mean_x1_given_x2 <span class="op">=</span> mean[<span class="dv">0</span>] <span class="op">+</span> covariance[<span class="dv">0</span>, <span class="dv">1</span>] <span class="op">/</span> covariance[<span class="dv">1</span>, <span class="dv">1</span>] <span class="op">*</span> (x2 <span class="op">-</span> mean[<span class="dv">1</span>])</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    variance_x1_given_x2 <span class="op">=</span> covariance[<span class="dv">0</span>, <span class="dv">0</span>] <span class="op">-</span> covariance[<span class="dv">0</span>, <span class="dv">1</span>] <span class="op">/</span> covariance[<span class="dv">1</span>, <span class="dv">1</span>] <span class="op">*</span> covariance[<span class="dv">1</span>, <span class="dv">0</span>]</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.random.normal(mean_x1_given_x2, np.sqrt(variance_x1_given_x2))</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to sample from conditional distribution of X2 given X1</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> sample_X2_given_X1(x1):</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>    mean_x2_given_x1 <span class="op">=</span> mean[<span class="dv">1</span>] <span class="op">+</span> covariance[<span class="dv">1</span>, <span class="dv">0</span>] <span class="op">/</span> covariance[<span class="dv">0</span>, <span class="dv">0</span>] <span class="op">*</span> (x1 <span class="op">-</span> mean[<span class="dv">0</span>])</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>    variance_x2_given_x1 <span class="op">=</span> covariance[<span class="dv">1</span>, <span class="dv">1</span>] <span class="op">-</span> covariance[<span class="dv">1</span>, <span class="dv">0</span>] <span class="op">/</span> covariance[<span class="dv">0</span>, <span class="dv">0</span>] <span class="op">*</span> covariance[<span class="dv">0</span>, <span class="dv">1</span>]</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.random.normal(mean_x2_given_x1, np.sqrt(variance_x2_given_x1))</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Gibbs sampling function</span></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> gibbs_sampling(initial_state, num_samples, burn_in<span class="op">=</span><span class="dv">100</span>):</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>    samples <span class="op">=</span> np.zeros((num_samples, <span class="dv">2</span>))</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>    current_state <span class="op">=</span> initial_state</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_samples <span class="op">+</span> burn_in):</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>        current_state[<span class="dv">0</span>] <span class="op">=</span> sample_X1_given_X2(current_state[<span class="dv">1</span>])</span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>        current_state[<span class="dv">1</span>] <span class="op">=</span> sample_X2_given_X1(current_state[<span class="dv">0</span>])</span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> i <span class="op">&gt;=</span> burn_in:</span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>            samples[i <span class="op">-</span> burn_in] <span class="op">=</span> current_state</span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> samples</span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Initial state</span></span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a>initial_state <span class="op">=</span> np.array([<span class="dv">0</span>, <span class="dv">0</span>])</span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of samples to generate</span></span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a>num_samples <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform Gibbs sampling</span></span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> gibbs_sampling(initial_state, num_samples)</span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting</span></span>
<span id="cb22-41"><a href="#cb22-41" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb22-42"><a href="#cb22-42" aria-hidden="true" tabindex="-1"></a>plt.scatter(samples[:, <span class="dv">0</span>], samples[:, <span class="dv">1</span>], alpha<span class="op">=</span><span class="fl">0.6</span>, label<span class="op">=</span><span class="st">'Samples'</span>)</span>
<span id="cb22-43"><a href="#cb22-43" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Gibbs Sampling for Bivariate Normal Distribution'</span>)</span>
<span id="cb22-44"><a href="#cb22-44" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'X1'</span>)</span>
<span id="cb22-45"><a href="#cb22-45" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'X2'</span>)</span>
<span id="cb22-46"><a href="#cb22-46" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb22-47"><a href="#cb22-47" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb22-48"><a href="#cb22-48" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="5_inferential_statistics_files/figure-html/cell-13-output-1.png" width="659" height="523" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="metropolis-hastings-algorithm" class="level3">
<h3 class="anchored" data-anchor-id="metropolis-hastings-algorithm">Metropolis-Hastings Algorithm</h3>
<section id="definition-14" class="level4">
<h4 class="anchored" data-anchor-id="definition-14">Definition</h4>
<p>The Metropolis-Hastings algorithm is an MCMC method used to obtain a sequence of random samples from a probability distribution for which direct sampling is difficult.</p>
</section>
<section id="procedure-11" class="level4">
<h4 class="anchored" data-anchor-id="procedure-11">Procedure</h4>
<p>Generate a candidate sample from a proposal distribution, accept or reject the candidate based on a criterion involving the ratio of the target distribution densities, and repeat this process to generate a chain of samples.</p>
</section>
<section id="example-14" class="level4">
<h4 class="anchored" data-anchor-id="example-14">Example</h4>
<p>Sampling from a posterior distribution in Bayesian inference where the likelihood and prior are complex.</p>
<div id="8f9e046f" class="cell" data-execution_count="13">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> norm</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Target distribution (posterior)</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> target_distribution(x):</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> norm.pdf(x, loc<span class="op">=</span><span class="dv">3</span>, scale<span class="op">=</span><span class="dv">2</span>) <span class="op">*</span> norm.pdf(x, loc<span class="op">=</span><span class="dv">7</span>, scale<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Proposal distribution (normal distribution)</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> proposal_distribution(x, sigma):</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.random.normal(x, sigma)</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Metropolis-Hastings algorithm</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> metropolis_hastings(num_samples, sigma):</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>    samples <span class="op">=</span> np.zeros(num_samples)</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>    current_sample <span class="op">=</span> np.random.normal(<span class="dv">0</span>, <span class="dv">1</span>)  <span class="co"># Start from a random initial point</span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_samples):</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>        candidate <span class="op">=</span> proposal_distribution(current_sample, sigma)</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>        acceptance_ratio <span class="op">=</span> target_distribution(candidate) <span class="op">/</span> target_distribution(current_sample)</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> np.random.rand() <span class="op">&lt;</span> acceptance_ratio:</span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>            current_sample <span class="op">=</span> candidate</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>        samples[i] <span class="op">=</span> current_sample</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> samples</span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameters</span></span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>num_samples <span class="op">=</span> <span class="dv">10000</span>  <span class="co"># Number of samples to generate</span></span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>sigma <span class="op">=</span> <span class="fl">1.0</span>  <span class="co"># Standard deviation of the proposal distribution</span></span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform Metropolis-Hastings sampling</span></span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> metropolis_hastings(num_samples, sigma)</span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting</span></span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">5</span>, <span class="dv">15</span>, <span class="dv">500</span>)</span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a>plt.plot(x, target_distribution(x), <span class="st">'r-'</span>, label<span class="op">=</span><span class="st">'Target Distribution (Posterior)'</span>)</span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a>plt.hist(samples, bins<span class="op">=</span><span class="dv">50</span>, density<span class="op">=</span><span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.6</span>, label<span class="op">=</span><span class="st">'Samples from Metropolis-Hastings'</span>)</span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Metropolis-Hastings Sampling'</span>)</span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'x'</span>)</span>
<span id="cb23-39"><a href="#cb23-39" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Density'</span>)</span>
<span id="cb23-40"><a href="#cb23-40" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb23-41"><a href="#cb23-41" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb23-42"><a href="#cb23-42" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="5_inferential_statistics_files/figure-html/cell-14-output-1.png" width="812" height="523" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="quota-sampling" class="level3">
<h3 class="anchored" data-anchor-id="quota-sampling">Quota Sampling</h3>
<section id="definition-15" class="level4">
<h4 class="anchored" data-anchor-id="definition-15">Definition</h4>
<p>Quota sampling involves dividing the population into subgroups and then taking a non-random sample from each subgroup to ensure that the sample represents certain characteristics of the population.</p>
</section>
<section id="procedure-12" class="level4">
<h4 class="anchored" data-anchor-id="procedure-12">Procedure</h4>
<p>Define quotas for each subgroup based on characteristics such as age, gender, or income. Select participants non-randomly until the quotas are met.</p>
</section>
<section id="example-15" class="level4">
<h4 class="anchored" data-anchor-id="example-15">Example</h4>
<p>Ensuring that a survey sample matches the population demographics by setting quotas for age groups, genders, and income levels.</p>
<div id="5498b7c6" class="cell" data-execution_count="14">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Define the Population</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)  <span class="co"># For reproducibility</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a synthetic dataset</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>population_size <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>population <span class="op">=</span> pd.DataFrame({</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'age'</span>: np.random.choice([<span class="st">'18-25'</span>, <span class="st">'26-35'</span>, <span class="st">'36-45'</span>, <span class="st">'46-60'</span>, <span class="st">'60+'</span>], size<span class="op">=</span>population_size),</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'gender'</span>: np.random.choice([<span class="st">'Male'</span>, <span class="st">'Female'</span>], size<span class="op">=</span>population_size),</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'income'</span>: np.random.choice([<span class="st">'Low'</span>, <span class="st">'Medium'</span>, <span class="st">'High'</span>], size<span class="op">=</span>population_size)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the first few rows of the population dataset</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Population Data:"</span>)</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(population.head())</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Define Quotas</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>quotas <span class="op">=</span> {</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">'age'</span>: {<span class="st">'18-25'</span>: <span class="dv">50</span>, <span class="st">'26-35'</span>: <span class="dv">50</span>, <span class="st">'36-45'</span>: <span class="dv">50</span>, <span class="st">'46-60'</span>: <span class="dv">50</span>, <span class="st">'60+'</span>: <span class="dv">50</span>},</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">'gender'</span>: {<span class="st">'Male'</span>: <span class="dv">125</span>, <span class="st">'Female'</span>: <span class="dv">125</span>},</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">'income'</span>: {<span class="st">'Low'</span>: <span class="dv">50</span>, <span class="st">'Medium'</span>: <span class="dv">100</span>, <span class="st">'High'</span>: <span class="dv">100</span>}</span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Select Participants</span></span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>sample <span class="op">=</span> pd.DataFrame(columns<span class="op">=</span>population.columns)</span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> feature, quota <span class="kw">in</span> quotas.items():</span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> category, count <span class="kw">in</span> quota.items():</span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>        selected <span class="op">=</span> population[population[feature] <span class="op">==</span> category].sample(n<span class="op">=</span>count, replace<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>        sample <span class="op">=</span> pd.concat([sample, selected])</span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>        population <span class="op">=</span> population.drop(selected.index)</span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Reset the index of the sample</span></span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a>sample.reset_index(drop<span class="op">=</span><span class="va">True</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the first few rows of the sample dataset</span></span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Sample Data:"</span>)</span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sample.head())</span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the distribution of the sample to verify quotas</span></span>
<span id="cb24-43"><a href="#cb24-43" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Sample Distribution:"</span>)</span>
<span id="cb24-44"><a href="#cb24-44" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sample.groupby([<span class="st">'age'</span>, <span class="st">'gender'</span>, <span class="st">'income'</span>]).size())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Population Data:
     age  gender income
0  46-60  Female   High
1    60+  Female    Low
2  36-45  Female   High
3    60+  Female    Low
4    60+  Female   High

Sample Data:
     age  gender  income
0  18-25    Male    High
1  18-25    Male  Medium
2  18-25  Female  Medium
3  18-25  Female    High
4  18-25  Female  Medium

Sample Distribution:
age    gender  income
18-25  Female  High      27
               Low       18
               Medium    29
       Male    High      37
               Low       17
               Medium    24
26-35  Female  High      27
               Low       14
               Medium    24
       Male    High      26
               Low       19
               Medium    28
36-45  Female  High      13
               Low       35
               Medium    30
       Male    High      17
               Low       25
               Medium    26
46-60  Female  High      26
               Low       25
               Medium    26
       Male    High      23
               Low       20
               Medium    35
60+    Female  High      31
               Low       30
               Medium    22
       Male    High      27
               Low       25
               Medium    24
dtype: int64</code></pre>
</div>
</div>
<hr>
</section>
</section>
<section id="snowball-sampling" class="level3">
<h3 class="anchored" data-anchor-id="snowball-sampling">Snowball Sampling</h3>
<section id="definition-16" class="level4">
<h4 class="anchored" data-anchor-id="definition-16">Definition</h4>
<p>Snowball sampling is a non-probability sampling technique where existing study subjects recruit future subjects from among their acquaintances.</p>
</section>
<section id="procedure-13" class="level4">
<h4 class="anchored" data-anchor-id="procedure-13">Procedure</h4>
<p>Initial subjects are selected and asked to recruit additional participants. This process continues until the desired sample size is reached.</p>
</section>
<section id="example-16" class="level4">
<h4 class="anchored" data-anchor-id="example-16">Example</h4>
<p>Studying hidden or hard-to-reach populations, such as drug users or undocumented immigrants, by leveraging social networks.</p>
<div id="235cfac5" class="cell" data-execution_count="15">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> networkx <span class="im">as</span> nx</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Define the Population</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)  <span class="co"># For reproducibility</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a synthetic dataset</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>population_size <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>population <span class="op">=</span> pd.DataFrame({</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'id'</span>: <span class="bu">range</span>(population_size),</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'name'</span>: [<span class="ss">f'Person_</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">'</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(population_size)],</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">'hidden_population'</span>: np.random.choice([<span class="va">True</span>, <span class="va">False</span>], size<span class="op">=</span>population_size, p<span class="op">=</span>[<span class="fl">0.1</span>, <span class="fl">0.9</span>])  <span class="co"># 10% hidden population</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a social network graph</span></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>G <span class="op">=</span> nx.erdos_renyi_graph(population_size, <span class="fl">0.05</span>, seed<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>nx.set_node_attributes(G, population.set_index(<span class="st">'id'</span>).to_dict(<span class="st">'index'</span>))</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Initial Subjects</span></span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>initial_subjects <span class="op">=</span> random.sample([n <span class="cf">for</span> n, d <span class="kw">in</span> G.nodes(data<span class="op">=</span><span class="va">True</span>) <span class="cf">if</span> d[<span class="st">'hidden_population'</span>]], <span class="dv">5</span>)  <span class="co"># Start with 5 hidden individuals</span></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Recruit Additional Participants</span></span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>sample <span class="op">=</span> <span class="bu">set</span>(initial_subjects)</span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>new_recruits <span class="op">=</span> <span class="bu">set</span>(initial_subjects)</span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> <span class="bu">len</span>(sample) <span class="op">&lt;</span> <span class="dv">50</span>:  <span class="co"># Desired sample size</span></span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>    next_recruits <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> subject <span class="kw">in</span> new_recruits:</span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a>        neighbors <span class="op">=</span> <span class="bu">list</span>(G.neighbors(subject))</span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a>        hidden_neighbors <span class="op">=</span> [n <span class="cf">for</span> n <span class="kw">in</span> neighbors <span class="cf">if</span> G.nodes[n][<span class="st">'hidden_population'</span>]]</span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a>        next_recruits.update(hidden_neighbors)</span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a>    new_recruits <span class="op">=</span> next_recruits <span class="op">-</span> sample</span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a>    sample.update(new_recruits)</span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> new_recruits:  <span class="co"># If no new recruits can be found, break the loop</span></span>
<span id="cb26-37"><a href="#cb26-37" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span></span>
<span id="cb26-38"><a href="#cb26-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-39"><a href="#cb26-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert sample to DataFrame</span></span>
<span id="cb26-40"><a href="#cb26-40" aria-hidden="true" tabindex="-1"></a>sample_df <span class="op">=</span> pd.DataFrame([G.nodes[n] <span class="cf">for</span> n <span class="kw">in</span> sample])</span>
<span id="cb26-41"><a href="#cb26-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-42"><a href="#cb26-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the sample</span></span>
<span id="cb26-43"><a href="#cb26-43" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Sample Data:"</span>)</span>
<span id="cb26-44"><a href="#cb26-44" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sample_df)</span>
<span id="cb26-45"><a href="#cb26-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-46"><a href="#cb26-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the size of the sample</span></span>
<span id="cb26-47"><a href="#cb26-47" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Sample Size:"</span>)</span>
<span id="cb26-48"><a href="#cb26-48" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(sample_df))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Sample Data:
          name  hidden_population
0   Person_514               True
1   Person_259               True
2   Person_515               True
3     Person_6               True
4    Person_10               True
..         ...                ...
73  Person_476               True
74  Person_222               True
75  Person_486               True
76  Person_244               True
77  Person_764               True

[78 rows x 2 columns]

Sample Size:
78</code></pre>
</div>
</div>
<hr>
</section>
</section>
<section id="adaptive-sampling" class="level3">
<h3 class="anchored" data-anchor-id="adaptive-sampling">Adaptive Sampling</h3>
<section id="definition-17" class="level4">
<h4 class="anchored" data-anchor-id="definition-17">Definition</h4>
<p>Adaptive sampling is a technique where the sampling scheme is adjusted based on the observed data during the survey process.</p>
</section>
<section id="procedure-14" class="level4">
<h4 class="anchored" data-anchor-id="procedure-14">Procedure</h4>
<p>Start with an initial sample, analyze the data, and adjust the sampling plan to focus on areas or strata with higher variability or interest.</p>
</section>
<section id="example-17" class="level4">
<h4 class="anchored" data-anchor-id="example-17">Example</h4>
<p>Environmental surveys where initial data indicates regions of higher biodiversity, prompting increased sampling efforts in those regions.</p>
<div id="cab15121" class="cell" data-execution_count="16">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Set random seed for reproducibility</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Define the Environment</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_environment(size<span class="op">=</span><span class="dv">100</span>):</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Create a 2D environment with varying biodiversity levels"""</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>    env <span class="op">=</span> np.zeros((size, size))</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create some hotspots of biodiversity</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>    env[<span class="dv">20</span>:<span class="dv">40</span>, <span class="dv">20</span>:<span class="dv">40</span>] <span class="op">=</span> np.random.normal(<span class="dv">10</span>, <span class="dv">2</span>, (<span class="dv">20</span>, <span class="dv">20</span>))</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>    env[<span class="dv">60</span>:<span class="dv">80</span>, <span class="dv">60</span>:<span class="dv">80</span>] <span class="op">=</span> np.random.normal(<span class="dv">15</span>, <span class="dv">3</span>, (<span class="dv">20</span>, <span class="dv">20</span>))</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>    env <span class="op">+=</span> np.<span class="bu">abs</span>(np.random.normal(<span class="dv">0</span>, <span class="dv">1</span>, (size, size)))  <span class="co"># Add some noise</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> env</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>environment <span class="op">=</span> create_environment()</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Initial Sampling</span></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> initial_sampling(env, sample_size<span class="op">=</span><span class="dv">100</span>):</span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Take initial random samples"""</span></span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> np.random.randint(<span class="dv">0</span>, env.shape[<span class="dv">0</span>], sample_size)</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> np.random.randint(<span class="dv">0</span>, env.shape[<span class="dv">1</span>], sample_size)</span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>    biodiversity <span class="op">=</span> env[x, y]</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pd.DataFrame({<span class="st">'x'</span>: x, <span class="st">'y'</span>: y, <span class="st">'biodiversity'</span>: biodiversity})</span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>initial_samples <span class="op">=</span> initial_sampling(environment)</span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Analyze Data</span></span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> identify_hotspots(samples, threshold):</span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Identify areas of high biodiversity"""</span></span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> samples[samples[<span class="st">'biodiversity'</span>] <span class="op">&gt;</span> threshold]</span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a>hotspots <span class="op">=</span> identify_hotspots(initial_samples, threshold<span class="op">=</span>np.percentile(initial_samples[<span class="st">'biodiversity'</span>], <span class="dv">75</span>))</span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Adjust Sampling Plan</span></span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> adaptive_sampling(env, hotspots, additional_samples<span class="op">=</span><span class="dv">100</span>):</span>
<span id="cb28-40"><a href="#cb28-40" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Take additional samples near identified hotspots"""</span></span>
<span id="cb28-41"><a href="#cb28-41" aria-hidden="true" tabindex="-1"></a>    new_samples <span class="op">=</span> []</span>
<span id="cb28-42"><a href="#cb28-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _, hotspot <span class="kw">in</span> hotspots.iterrows():</span>
<span id="cb28-43"><a href="#cb28-43" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> np.random.normal(hotspot[<span class="st">'x'</span>], <span class="dv">5</span>, additional_samples <span class="op">//</span> <span class="bu">len</span>(hotspots))</span>
<span id="cb28-44"><a href="#cb28-44" aria-hidden="true" tabindex="-1"></a>        y <span class="op">=</span> np.random.normal(hotspot[<span class="st">'y'</span>], <span class="dv">5</span>, additional_samples <span class="op">//</span> <span class="bu">len</span>(hotspots))</span>
<span id="cb28-45"><a href="#cb28-45" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> np.clip(x, <span class="dv">0</span>, env.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">1</span>).astype(<span class="bu">int</span>)</span>
<span id="cb28-46"><a href="#cb28-46" aria-hidden="true" tabindex="-1"></a>        y <span class="op">=</span> np.clip(y, <span class="dv">0</span>, env.shape[<span class="dv">1</span>] <span class="op">-</span> <span class="dv">1</span>).astype(<span class="bu">int</span>)</span>
<span id="cb28-47"><a href="#cb28-47" aria-hidden="true" tabindex="-1"></a>        biodiversity <span class="op">=</span> env[x, y]</span>
<span id="cb28-48"><a href="#cb28-48" aria-hidden="true" tabindex="-1"></a>        new_samples.append(pd.DataFrame({<span class="st">'x'</span>: x, <span class="st">'y'</span>: y, <span class="st">'biodiversity'</span>: biodiversity}))</span>
<span id="cb28-49"><a href="#cb28-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pd.concat(new_samples)</span>
<span id="cb28-50"><a href="#cb28-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-51"><a href="#cb28-51" aria-hidden="true" tabindex="-1"></a>additional_samples <span class="op">=</span> adaptive_sampling(environment, hotspots)</span>
<span id="cb28-52"><a href="#cb28-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-53"><a href="#cb28-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine all samples</span></span>
<span id="cb28-54"><a href="#cb28-54" aria-hidden="true" tabindex="-1"></a>all_samples <span class="op">=</span> pd.concat([initial_samples, additional_samples])</span>
<span id="cb28-55"><a href="#cb28-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-56"><a href="#cb28-56" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5: Final Analysis</span></span>
<span id="cb28-57"><a href="#cb28-57" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_results(env, initial, additional, all_samples):</span>
<span id="cb28-58"><a href="#cb28-58" aria-hidden="true" tabindex="-1"></a>    fig, axs <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">15</span>))</span>
<span id="cb28-59"><a href="#cb28-59" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb28-60"><a href="#cb28-60" aria-hidden="true" tabindex="-1"></a>    sns.heatmap(env, ax<span class="op">=</span>axs[<span class="dv">0</span>, <span class="dv">0</span>], cmap<span class="op">=</span><span class="st">'viridis'</span>)</span>
<span id="cb28-61"><a href="#cb28-61" aria-hidden="true" tabindex="-1"></a>    axs[<span class="dv">0</span>, <span class="dv">0</span>].set_title(<span class="st">'True Environment'</span>)</span>
<span id="cb28-62"><a href="#cb28-62" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb28-63"><a href="#cb28-63" aria-hidden="true" tabindex="-1"></a>    axs[<span class="dv">0</span>, <span class="dv">1</span>].scatter(initial[<span class="st">'x'</span>], initial[<span class="st">'y'</span>], c<span class="op">=</span>initial[<span class="st">'biodiversity'</span>], cmap<span class="op">=</span><span class="st">'viridis'</span>)</span>
<span id="cb28-64"><a href="#cb28-64" aria-hidden="true" tabindex="-1"></a>    axs[<span class="dv">0</span>, <span class="dv">1</span>].set_title(<span class="st">'Initial Sampling'</span>)</span>
<span id="cb28-65"><a href="#cb28-65" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb28-66"><a href="#cb28-66" aria-hidden="true" tabindex="-1"></a>    axs[<span class="dv">1</span>, <span class="dv">0</span>].scatter(additional[<span class="st">'x'</span>], additional[<span class="st">'y'</span>], c<span class="op">=</span>additional[<span class="st">'biodiversity'</span>], cmap<span class="op">=</span><span class="st">'viridis'</span>)</span>
<span id="cb28-67"><a href="#cb28-67" aria-hidden="true" tabindex="-1"></a>    axs[<span class="dv">1</span>, <span class="dv">0</span>].set_title(<span class="st">'Adaptive Sampling'</span>)</span>
<span id="cb28-68"><a href="#cb28-68" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb28-69"><a href="#cb28-69" aria-hidden="true" tabindex="-1"></a>    axs[<span class="dv">1</span>, <span class="dv">1</span>].scatter(all_samples[<span class="st">'x'</span>], all_samples[<span class="st">'y'</span>], c<span class="op">=</span>all_samples[<span class="st">'biodiversity'</span>], cmap<span class="op">=</span><span class="st">'viridis'</span>)</span>
<span id="cb28-70"><a href="#cb28-70" aria-hidden="true" tabindex="-1"></a>    axs[<span class="dv">1</span>, <span class="dv">1</span>].set_title(<span class="st">'All Samples'</span>)</span>
<span id="cb28-71"><a href="#cb28-71" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb28-72"><a href="#cb28-72" aria-hidden="true" tabindex="-1"></a>    plt.tight_layout()</span>
<span id="cb28-73"><a href="#cb28-73" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb28-74"><a href="#cb28-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-75"><a href="#cb28-75" aria-hidden="true" tabindex="-1"></a>plot_results(environment, initial_samples, additional_samples, all_samples)</span>
<span id="cb28-76"><a href="#cb28-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-77"><a href="#cb28-77" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Initial samples: </span><span class="sc">{</span><span class="bu">len</span>(initial_samples)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb28-78"><a href="#cb28-78" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Additional samples: </span><span class="sc">{</span><span class="bu">len</span>(additional_samples)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb28-79"><a href="#cb28-79" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Total samples: </span><span class="sc">{</span><span class="bu">len</span>(all_samples)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb28-80"><a href="#cb28-80" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Average biodiversity (initial): </span><span class="sc">{</span>initial_samples[<span class="st">'biodiversity'</span>]<span class="sc">.</span>mean()<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb28-81"><a href="#cb28-81" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Average biodiversity (all): </span><span class="sc">{</span>all_samples[<span class="st">'biodiversity'</span>]<span class="sc">.</span>mean()<span class="sc">:.2f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="5_inferential_statistics_files/figure-html/cell-17-output-1.png" width="1430" height="1429" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Initial samples: 100
Additional samples: 100
Total samples: 200
Average biodiversity (initial): 1.47
Average biodiversity (all): 2.19</code></pre>
</div>
</div>
<hr>
</section>
</section>
</section>
<section id="sampling-distributions-and-central-limit-theorem" class="level2">
<h2 class="anchored" data-anchor-id="sampling-distributions-and-central-limit-theorem">Sampling Distributions and Central Limit Theorem</h2>
<section id="sampling-distributions" class="level3">
<h3 class="anchored" data-anchor-id="sampling-distributions">Sampling Distributions</h3>
<section id="definition-18" class="level4">
<h4 class="anchored" data-anchor-id="definition-18">Definition</h4>
<p>A sampling distribution is the probability distribution of a given statistic based on a random sample. It describes how the statistic would vary if we repeated the sampling process many times.</p>
</section>
<section id="properties" class="level4">
<h4 class="anchored" data-anchor-id="properties">Properties</h4>
<ul>
<li><p>The mean of the sampling distribution of the sample mean is equal to the population mean. This property, known as the unbiasedness of the sample mean, ensures that on average, the sample mean is a good estimator of the population mean.</p></li>
<li><p>The standard deviation of the sampling distribution (standard error) is equal to the population standard deviation divided by the square root of the sample size. This property indicates how much the sample mean would vary from sample to sample.</p></li>
</ul>
</section>
<section id="example-18" class="level4">
<h4 class="anchored" data-anchor-id="example-18">Example</h4>
<p>If you repeatedly sample the heights of 30 students from a large population and calculate the mean each time, the distribution of those means is the sampling distribution of the sample mean. This distribution helps in understanding the variability of the sample mean.</p>
<div id="3fe965b5" class="cell" data-execution_count="17">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Set random seed for reproducibility</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Define the population</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>population_size <span class="op">=</span> <span class="dv">100000</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>population <span class="op">=</span> stats.norm.rvs(loc<span class="op">=</span><span class="dv">170</span>, scale<span class="op">=</span><span class="dv">10</span>, size<span class="op">=</span>population_size)  <span class="co"># Normal distribution with mean 170 and std 10</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Function to draw samples and calculate sample means</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> draw_samples(population, sample_size, num_samples):</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>    sample_means <span class="op">=</span> []</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(num_samples):</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>        sample <span class="op">=</span> np.random.choice(population, size<span class="op">=</span>sample_size, replace<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>        sample_means.append(np.mean(sample))</span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.array(sample_means)</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Draw samples and calculate sample means</span></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>sample_size <span class="op">=</span> <span class="dv">30</span></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>num_samples <span class="op">=</span> <span class="dv">10000</span></span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>sample_means <span class="op">=</span> draw_samples(population, sample_size, num_samples)</span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Calculate theoretical properties</span></span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>population_mean <span class="op">=</span> np.mean(population)</span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>population_std <span class="op">=</span> np.std(population)</span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>theoretical_std_error <span class="op">=</span> population_std <span class="op">/</span> np.sqrt(sample_size)</span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5: Calculate observed properties</span></span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a>observed_mean <span class="op">=</span> np.mean(sample_means)</span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a>observed_std_error <span class="op">=</span> np.std(sample_means)</span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-36"><a href="#cb30-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 6: Visualize the sampling distribution</span></span>
<span id="cb30-37"><a href="#cb30-37" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb30-38"><a href="#cb30-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-39"><a href="#cb30-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Histogram of sample means</span></span>
<span id="cb30-40"><a href="#cb30-40" aria-hidden="true" tabindex="-1"></a>sns.histplot(sample_means, kde<span class="op">=</span><span class="va">True</span>, stat<span class="op">=</span><span class="st">"density"</span>, label<span class="op">=</span><span class="st">"Observed Distribution"</span>)</span>
<span id="cb30-41"><a href="#cb30-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-42"><a href="#cb30-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Theoretical normal distribution</span></span>
<span id="cb30-43"><a href="#cb30-43" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="bu">min</span>(sample_means), <span class="bu">max</span>(sample_means), <span class="dv">100</span>)</span>
<span id="cb30-44"><a href="#cb30-44" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> stats.norm.pdf(x, loc<span class="op">=</span>population_mean, scale<span class="op">=</span>theoretical_std_error)</span>
<span id="cb30-45"><a href="#cb30-45" aria-hidden="true" tabindex="-1"></a>plt.plot(x, y, <span class="st">'r-'</span>, label<span class="op">=</span><span class="st">"Theoretical Distribution"</span>)</span>
<span id="cb30-46"><a href="#cb30-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-47"><a href="#cb30-47" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="ss">f"Sampling Distribution of the Sample Mean (n=</span><span class="sc">{</span>sample_size<span class="sc">}</span><span class="ss">)"</span>)</span>
<span id="cb30-48"><a href="#cb30-48" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Sample Mean"</span>)</span>
<span id="cb30-49"><a href="#cb30-49" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Density"</span>)</span>
<span id="cb30-50"><a href="#cb30-50" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb30-51"><a href="#cb30-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-52"><a href="#cb30-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Add vertical lines for means</span></span>
<span id="cb30-53"><a href="#cb30-53" aria-hidden="true" tabindex="-1"></a>plt.axvline(population_mean, color<span class="op">=</span><span class="st">'g'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, label<span class="op">=</span><span class="st">"Population Mean"</span>)</span>
<span id="cb30-54"><a href="#cb30-54" aria-hidden="true" tabindex="-1"></a>plt.axvline(observed_mean, color<span class="op">=</span><span class="st">'b'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, label<span class="op">=</span><span class="st">"Observed Mean of Samples"</span>)</span>
<span id="cb30-55"><a href="#cb30-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-56"><a href="#cb30-56" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb30-57"><a href="#cb30-57" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb30-58"><a href="#cb30-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-59"><a href="#cb30-59" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 7: Print results</span></span>
<span id="cb30-60"><a href="#cb30-60" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Population Mean: </span><span class="sc">{</span>population_mean<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb30-61"><a href="#cb30-61" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Observed Mean of Sample Means: </span><span class="sc">{</span>observed_mean<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb30-62"><a href="#cb30-62" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Population Standard Deviation: </span><span class="sc">{</span>population_std<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb30-63"><a href="#cb30-63" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Theoretical Standard Error: </span><span class="sc">{</span>theoretical_std_error<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb30-64"><a href="#cb30-64" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Observed Standard Error: </span><span class="sc">{</span>observed_std_error<span class="sc">:.2f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>/Users/ravishankar/miniforge3/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning:

use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="5_inferential_statistics_files/figure-html/cell-18-output-2.png" width="981" height="523" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Population Mean: 170.01
Observed Mean of Sample Means: 170.02
Population Standard Deviation: 10.01
Theoretical Standard Error: 1.83
Observed Standard Error: 1.82</code></pre>
</div>
</div>
<hr>
</section>
</section>
<section id="central-limit-theorem" class="level3">
<h3 class="anchored" data-anchor-id="central-limit-theorem">Central Limit Theorem</h3>
<section id="definition-19" class="level4">
<h4 class="anchored" data-anchor-id="definition-19">Definition</h4>
<p>The Central Limit Theorem (CLT) states that the distribution of the sample means approaches a normal distribution as the sample size grows, regardless of the population’s distribution. This theorem is fundamental in inferential statistics as it allows for the use of normal probability methods.</p>
</section>
<section id="implications" class="level4">
<h4 class="anchored" data-anchor-id="implications">Implications</h4>
<ul>
<li><p>Allows us to use normal probability methods for inference even if the population is not normally distributed, provided the sample size is large enough. This is particularly useful for hypothesis testing and constructing confidence intervals.</p></li>
<li><p>Sample size of 30 is often considered sufficient for the CLT to hold. However, the required sample size can be larger for populations with extreme skewness or heavy tails.</p></li>
</ul>
</section>
<section id="example-19" class="level4">
<h4 class="anchored" data-anchor-id="example-19">Example</h4>
<p>If you take many samples of size 50 from a skewed population and plot the sample means, the resulting distribution will be approximately normal. This approximation enables the use of normal distribution properties to make inferences about the population mean.</p>
<div id="5f4cd43b" class="cell" data-execution_count="18">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Set random seed for reproducibility</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Define the population (exponential distribution)</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>population_size <span class="op">=</span> <span class="dv">100000</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>population <span class="op">=</span> np.random.exponential(scale<span class="op">=</span><span class="fl">1.0</span>, size<span class="op">=</span>population_size)</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Function to draw samples and calculate sample means</span></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> draw_samples(population, sample_size, num_samples):</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>    sample_means <span class="op">=</span> []</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(num_samples):</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>        sample <span class="op">=</span> np.random.choice(population, size<span class="op">=</span>sample_size, replace<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>        sample_means.append(np.mean(sample))</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.array(sample_means)</span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Draw samples for different sample sizes</span></span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>sample_sizes <span class="op">=</span> [<span class="dv">5</span>, <span class="dv">30</span>, <span class="dv">100</span>]</span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>num_samples <span class="op">=</span> <span class="dv">10000</span></span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Create subplots</span></span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a>fig, axs <span class="op">=</span> plt.subplots(<span class="bu">len</span>(sample_sizes), <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">5</span><span class="op">*</span><span class="bu">len</span>(sample_sizes)))</span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">"Central Limit Theorem Demonstration"</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, sample_size <span class="kw">in</span> <span class="bu">enumerate</span>(sample_sizes):</span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a>    sample_means <span class="op">=</span> draw_samples(population, sample_size, num_samples)</span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot histogram of sample means</span></span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a>    sns.histplot(sample_means, kde<span class="op">=</span><span class="va">True</span>, stat<span class="op">=</span><span class="st">"density"</span>, ax<span class="op">=</span>axs[i, <span class="dv">0</span>])</span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true" tabindex="-1"></a>    axs[i, <span class="dv">0</span>].set_title(<span class="ss">f"Distribution of Sample Means (n=</span><span class="sc">{</span>sample_size<span class="sc">}</span><span class="ss">)"</span>)</span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true" tabindex="-1"></a>    axs[i, <span class="dv">0</span>].set_xlabel(<span class="st">"Sample Mean"</span>)</span>
<span id="cb33-37"><a href="#cb33-37" aria-hidden="true" tabindex="-1"></a>    axs[i, <span class="dv">0</span>].set_ylabel(<span class="st">"Density"</span>)</span>
<span id="cb33-38"><a href="#cb33-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb33-39"><a href="#cb33-39" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot Q-Q plot</span></span>
<span id="cb33-40"><a href="#cb33-40" aria-hidden="true" tabindex="-1"></a>    stats.probplot(sample_means, dist<span class="op">=</span><span class="st">"norm"</span>, plot<span class="op">=</span>axs[i, <span class="dv">1</span>])</span>
<span id="cb33-41"><a href="#cb33-41" aria-hidden="true" tabindex="-1"></a>    axs[i, <span class="dv">1</span>].set_title(<span class="ss">f"Q-Q Plot (n=</span><span class="sc">{</span>sample_size<span class="sc">}</span><span class="ss">)"</span>)</span>
<span id="cb33-42"><a href="#cb33-42" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb33-43"><a href="#cb33-43" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate and display statistics</span></span>
<span id="cb33-44"><a href="#cb33-44" aria-hidden="true" tabindex="-1"></a>    mean <span class="op">=</span> np.mean(sample_means)</span>
<span id="cb33-45"><a href="#cb33-45" aria-hidden="true" tabindex="-1"></a>    std <span class="op">=</span> np.std(sample_means)</span>
<span id="cb33-46"><a href="#cb33-46" aria-hidden="true" tabindex="-1"></a>    skew <span class="op">=</span> stats.skew(sample_means)</span>
<span id="cb33-47"><a href="#cb33-47" aria-hidden="true" tabindex="-1"></a>    kurtosis <span class="op">=</span> stats.kurtosis(sample_means)</span>
<span id="cb33-48"><a href="#cb33-48" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb33-49"><a href="#cb33-49" aria-hidden="true" tabindex="-1"></a>    stats_text <span class="op">=</span> <span class="ss">f"Mean: </span><span class="sc">{</span>mean<span class="sc">:.4f}</span><span class="ch">\n</span><span class="ss">Std Dev: </span><span class="sc">{</span>std<span class="sc">:.4f}</span><span class="ch">\n</span><span class="ss">Skewness: </span><span class="sc">{</span>skew<span class="sc">:.4f}</span><span class="ch">\n</span><span class="ss">Kurtosis: </span><span class="sc">{</span>kurtosis<span class="sc">:.4f}</span><span class="ss">"</span></span>
<span id="cb33-50"><a href="#cb33-50" aria-hidden="true" tabindex="-1"></a>    axs[i, <span class="dv">0</span>].text(<span class="fl">0.95</span>, <span class="fl">0.95</span>, stats_text, transform<span class="op">=</span>axs[i, <span class="dv">0</span>].transAxes, </span>
<span id="cb33-51"><a href="#cb33-51" aria-hidden="true" tabindex="-1"></a>                   verticalalignment<span class="op">=</span><span class="st">'top'</span>, horizontalalignment<span class="op">=</span><span class="st">'right'</span>,</span>
<span id="cb33-52"><a href="#cb33-52" aria-hidden="true" tabindex="-1"></a>                   bbox<span class="op">=</span><span class="bu">dict</span>(boxstyle<span class="op">=</span><span class="st">'round'</span>, facecolor<span class="op">=</span><span class="st">'white'</span>, alpha<span class="op">=</span><span class="fl">0.8</span>))</span>
<span id="cb33-53"><a href="#cb33-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-54"><a href="#cb33-54" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb33-55"><a href="#cb33-55" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb33-56"><a href="#cb33-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-57"><a href="#cb33-57" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5: Print population statistics</span></span>
<span id="cb33-58"><a href="#cb33-58" aria-hidden="true" tabindex="-1"></a>pop_mean <span class="op">=</span> np.mean(population)</span>
<span id="cb33-59"><a href="#cb33-59" aria-hidden="true" tabindex="-1"></a>pop_std <span class="op">=</span> np.std(population)</span>
<span id="cb33-60"><a href="#cb33-60" aria-hidden="true" tabindex="-1"></a>pop_skew <span class="op">=</span> stats.skew(population)</span>
<span id="cb33-61"><a href="#cb33-61" aria-hidden="true" tabindex="-1"></a>pop_kurtosis <span class="op">=</span> stats.kurtosis(population)</span>
<span id="cb33-62"><a href="#cb33-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-63"><a href="#cb33-63" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Population Statistics:"</span>)</span>
<span id="cb33-64"><a href="#cb33-64" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mean: </span><span class="sc">{</span>pop_mean<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb33-65"><a href="#cb33-65" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Standard Deviation: </span><span class="sc">{</span>pop_std<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb33-66"><a href="#cb33-66" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Skewness: </span><span class="sc">{</span>pop_skew<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb33-67"><a href="#cb33-67" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Kurtosis: </span><span class="sc">{</span>pop_kurtosis<span class="sc">:.4f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>/Users/ravishankar/miniforge3/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning:

use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.

/Users/ravishankar/miniforge3/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning:

use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.

/Users/ravishankar/miniforge3/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning:

use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="5_inferential_statistics_files/figure-html/cell-19-output-2.png" width="1429" height="1414" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Population Statistics:
Mean: 0.9960
Standard Deviation: 0.9930
Skewness: 1.9921
Kurtosis: 5.9284</code></pre>
</div>
</div>
<hr>
</section>
</section>
</section>
<section id="confidence-intervals" class="level2">
<h2 class="anchored" data-anchor-id="confidence-intervals">Confidence Intervals</h2>
<section id="definition-20" class="level3">
<h3 class="anchored" data-anchor-id="definition-20">Definition</h3>
<p>Confidence intervals provide a range of values within which the population parameter is expected to lie with a certain confidence level. They offer an estimate of the parameter and convey the uncertainty associated with the estimate.</p>
</section>
<section id="components" class="level3">
<h3 class="anchored" data-anchor-id="components">Components</h3>
<ul>
<li><p><strong>Point Estimate</strong>: The sample statistic (e.g., sample mean) used to estimate the population parameter. It is the best single estimate of the parameter.</p></li>
<li><p><strong>Margin of Error</strong>: The range within which the true population parameter is expected to lie. It reflects the precision of the estimate and is influenced by the sample size and variability.</p></li>
<li><p><strong>Confidence Level</strong>: The probability that the interval contains the population parameter (e.g., 95%). It indicates the degree of confidence we have that the interval includes the true parameter.</p></li>
</ul>
</section>
<section id="for-means" class="level3">
<h3 class="anchored" data-anchor-id="for-means">For Means</h3>
<section id="formula" class="level4">
<h4 class="anchored" data-anchor-id="formula">Formula</h4>
<p><span class="math display">\[
\text{CI} = \bar{x} \pm z \left( \frac{\sigma}{\sqrt{n}} \right)
\]</span> where <span class="math inline">\(\bar{x}\)</span> is the sample mean, <span class="math inline">\(z\)</span> is the critical value from the standard normal distribution, <span class="math inline">\(\sigma\)</span> is the population standard deviation, and <span class="math inline">\(n\)</span> is the sample size.</p>
</section>
<section id="example-20" class="level4">
<h4 class="anchored" data-anchor-id="example-20">Example</h4>
<p>95% CI for the mean height of a sample of 100 students with a mean height of 170 cm and a standard deviation of 10 cm: 170 ± 1.96*(10/√100) = 170 ± 1.96. This interval suggests that we are 95% confident that the true mean height of the population lies between 168.04 cm and 171.96 cm.</p>
<div id="d20503d2" class="cell" data-execution_count="19">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Set random seed for reproducibility</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Define the population</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>population_mean <span class="op">=</span> <span class="dv">170</span>  <span class="co"># cm</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>population_std <span class="op">=</span> <span class="dv">10</span>    <span class="co"># cm</span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>population_size <span class="op">=</span> <span class="dv">100000</span></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>population <span class="op">=</span> stats.norm.rvs(loc<span class="op">=</span>population_mean, scale<span class="op">=</span>population_std, size<span class="op">=</span>population_size)</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Function to calculate confidence interval</span></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_ci(sample, confidence<span class="op">=</span><span class="fl">0.95</span>):</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>    sample_mean <span class="op">=</span> np.mean(sample)</span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>    sample_std <span class="op">=</span> np.std(sample, ddof<span class="op">=</span><span class="dv">1</span>)  <span class="co"># ddof=1 for sample standard deviation</span></span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>    sample_size <span class="op">=</span> <span class="bu">len</span>(sample)</span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>    margin_of_error <span class="op">=</span> stats.t.ppf((<span class="dv">1</span> <span class="op">+</span> confidence) <span class="op">/</span> <span class="dv">2</span>, df<span class="op">=</span>sample_size<span class="op">-</span><span class="dv">1</span>) <span class="op">*</span> (sample_std <span class="op">/</span> np.sqrt(sample_size))</span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>    ci_lower <span class="op">=</span> sample_mean <span class="op">-</span> margin_of_error</span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>    ci_upper <span class="op">=</span> sample_mean <span class="op">+</span> margin_of_error</span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sample_mean, ci_lower, ci_upper</span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Draw samples and calculate confidence intervals</span></span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a>sample_size <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a>num_samples <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a>confidence_level <span class="op">=</span> <span class="fl">0.95</span></span>
<span id="cb36-33"><a href="#cb36-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-34"><a href="#cb36-34" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> []</span>
<span id="cb36-35"><a href="#cb36-35" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(num_samples):</span>
<span id="cb36-36"><a href="#cb36-36" aria-hidden="true" tabindex="-1"></a>    sample <span class="op">=</span> np.random.choice(population, size<span class="op">=</span>sample_size, replace<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb36-37"><a href="#cb36-37" aria-hidden="true" tabindex="-1"></a>    sample_mean, ci_lower, ci_upper <span class="op">=</span> calculate_ci(sample, confidence<span class="op">=</span>confidence_level)</span>
<span id="cb36-38"><a href="#cb36-38" aria-hidden="true" tabindex="-1"></a>    results.append({</span>
<span id="cb36-39"><a href="#cb36-39" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Sample Mean'</span>: sample_mean,</span>
<span id="cb36-40"><a href="#cb36-40" aria-hidden="true" tabindex="-1"></a>        <span class="st">'CI Lower'</span>: ci_lower,</span>
<span id="cb36-41"><a href="#cb36-41" aria-hidden="true" tabindex="-1"></a>        <span class="st">'CI Upper'</span>: ci_upper,</span>
<span id="cb36-42"><a href="#cb36-42" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Contains True Mean'</span>: ci_lower <span class="op">&lt;=</span> population_mean <span class="op">&lt;=</span> ci_upper</span>
<span id="cb36-43"><a href="#cb36-43" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb36-44"><a href="#cb36-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-45"><a href="#cb36-45" aria-hidden="true" tabindex="-1"></a>results_df <span class="op">=</span> pd.DataFrame(results)</span>
<span id="cb36-46"><a href="#cb36-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-47"><a href="#cb36-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Visualize the results</span></span>
<span id="cb36-48"><a href="#cb36-48" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb36-49"><a href="#cb36-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-50"><a href="#cb36-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot confidence intervals</span></span>
<span id="cb36-51"><a href="#cb36-51" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, (_, row) <span class="kw">in</span> <span class="bu">enumerate</span>(results_df.iterrows()):</span>
<span id="cb36-52"><a href="#cb36-52" aria-hidden="true" tabindex="-1"></a>    color <span class="op">=</span> <span class="st">'green'</span> <span class="cf">if</span> row[<span class="st">'Contains True Mean'</span>] <span class="cf">else</span> <span class="st">'red'</span></span>
<span id="cb36-53"><a href="#cb36-53" aria-hidden="true" tabindex="-1"></a>    plt.plot([i, i], [row[<span class="st">'CI Lower'</span>], row[<span class="st">'CI Upper'</span>]], color<span class="op">=</span>color, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb36-54"><a href="#cb36-54" aria-hidden="true" tabindex="-1"></a>    plt.plot(i, row[<span class="st">'Sample Mean'</span>], <span class="st">'o'</span>, color<span class="op">=</span>color, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb36-55"><a href="#cb36-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-56"><a href="#cb36-56" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot true population mean</span></span>
<span id="cb36-57"><a href="#cb36-57" aria-hidden="true" tabindex="-1"></a>plt.axhline(y<span class="op">=</span>population_mean, color<span class="op">=</span><span class="st">'blue'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, label<span class="op">=</span><span class="st">'True Population Mean'</span>)</span>
<span id="cb36-58"><a href="#cb36-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-59"><a href="#cb36-59" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="ss">f"</span><span class="sc">{</span>confidence_level<span class="op">*</span><span class="dv">100</span><span class="sc">}</span><span class="ss">% Confidence Intervals for </span><span class="sc">{</span>num_samples<span class="sc">}</span><span class="ss"> Samples"</span>)</span>
<span id="cb36-60"><a href="#cb36-60" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Sample Number"</span>)</span>
<span id="cb36-61"><a href="#cb36-61" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Height (cm)"</span>)</span>
<span id="cb36-62"><a href="#cb36-62" aria-hidden="true" tabindex="-1"></a>plt.ylim(<span class="dv">160</span>, <span class="dv">180</span>)</span>
<span id="cb36-63"><a href="#cb36-63" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb36-64"><a href="#cb36-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-65"><a href="#cb36-65" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb36-66"><a href="#cb36-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-67"><a href="#cb36-67" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5: Print summary statistics</span></span>
<span id="cb36-68"><a href="#cb36-68" aria-hidden="true" tabindex="-1"></a>coverage_probability <span class="op">=</span> results_df[<span class="st">'Contains True Mean'</span>].mean()</span>
<span id="cb36-69"><a href="#cb36-69" aria-hidden="true" tabindex="-1"></a>average_ci_width <span class="op">=</span> (results_df[<span class="st">'CI Upper'</span>] <span class="op">-</span> results_df[<span class="st">'CI Lower'</span>]).mean()</span>
<span id="cb36-70"><a href="#cb36-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-71"><a href="#cb36-71" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"True Population Mean: </span><span class="sc">{</span>population_mean<span class="sc">:.2f}</span><span class="ss"> cm"</span>)</span>
<span id="cb36-72"><a href="#cb36-72" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"True Population Standard Deviation: </span><span class="sc">{</span>population_std<span class="sc">:.2f}</span><span class="ss"> cm"</span>)</span>
<span id="cb36-73"><a href="#cb36-73" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Sample Size: </span><span class="sc">{</span>sample_size<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb36-74"><a href="#cb36-74" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Number of Samples: </span><span class="sc">{</span>num_samples<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb36-75"><a href="#cb36-75" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Confidence Level: </span><span class="sc">{</span>confidence_level<span class="op">*</span><span class="dv">100</span><span class="sc">}</span><span class="ss">%"</span>)</span>
<span id="cb36-76"><a href="#cb36-76" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Observed Coverage Probability: </span><span class="sc">{</span>coverage_probability<span class="sc">:.2%}</span><span class="ss">"</span>)</span>
<span id="cb36-77"><a href="#cb36-77" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Average CI Width: </span><span class="sc">{</span>average_ci_width<span class="sc">:.2f}</span><span class="ss"> cm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="5_inferential_statistics_files/figure-html/cell-20-output-1.png" width="978" height="523" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>True Population Mean: 170.00 cm
True Population Standard Deviation: 10.00 cm
Sample Size: 100
Number of Samples: 100
Confidence Level: 95.0%
Observed Coverage Probability: 98.00%
Average CI Width: 3.98 cm</code></pre>
</div>
</div>
<hr>
</section>
</section>
<section id="for-proportions" class="level3">
<h3 class="anchored" data-anchor-id="for-proportions">For Proportions</h3>
<section id="formula-1" class="level4">
<h4 class="anchored" data-anchor-id="formula-1">Formula</h4>
<p><span class="math display">\[
\text{CI} = \hat{p} \pm z \sqrt{ \frac{\hat{p}(1-\hat{p})}{n} }
\]</span> where <span class="math inline">\(\hat{p}\)</span> is the sample proportion, <span class="math inline">\(z\)</span> is the critical value from the standard normal distribution, and <span class="math inline">\(n\)</span> is the sample size.</p>
</section>
<section id="example-21" class="level4">
<h4 class="anchored" data-anchor-id="example-21">Example</h4>
<p>95% CI for the proportion of voters favoring a candidate in a sample of 1000 with 600 in favor: 0.6 ± 1.96<em>√(0.6</em>0.4/1000) = 0.6 ± 0.03. This interval suggests that we are 95% confident that the true proportion of voters favoring the candidate lies between 0.57 and 0.63.</p>
<div id="9a83ff05" class="cell" data-execution_count="20">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Set random seed for reproducibility</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Define the population</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>population_size <span class="op">=</span> <span class="dv">100000</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>population_proportion <span class="op">=</span> <span class="fl">0.6</span>  <span class="co"># 60% in favor</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>population <span class="op">=</span> np.random.choice([<span class="dv">0</span>, <span class="dv">1</span>], size<span class="op">=</span>population_size, p<span class="op">=</span>[<span class="dv">1</span><span class="op">-</span>population_proportion, population_proportion])</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Function to calculate confidence interval for proportion</span></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_ci_proportion(sample, confidence<span class="op">=</span><span class="fl">0.95</span>):</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>    sample_proportion <span class="op">=</span> np.mean(sample)</span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>    sample_size <span class="op">=</span> <span class="bu">len</span>(sample)</span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>    z_score <span class="op">=</span> stats.norm.ppf((<span class="dv">1</span> <span class="op">+</span> confidence) <span class="op">/</span> <span class="dv">2</span>)</span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>    margin_of_error <span class="op">=</span> z_score <span class="op">*</span> np.sqrt((sample_proportion <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> sample_proportion)) <span class="op">/</span> sample_size)</span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>    ci_lower <span class="op">=</span> <span class="bu">max</span>(<span class="dv">0</span>, sample_proportion <span class="op">-</span> margin_of_error)</span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>    ci_upper <span class="op">=</span> <span class="bu">min</span>(<span class="dv">1</span>, sample_proportion <span class="op">+</span> margin_of_error)</span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sample_proportion, ci_lower, ci_upper</span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Draw samples and calculate confidence intervals</span></span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a>sample_size <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a>num_samples <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a>confidence_level <span class="op">=</span> <span class="fl">0.95</span></span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> []</span>
<span id="cb38-34"><a href="#cb38-34" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(num_samples):</span>
<span id="cb38-35"><a href="#cb38-35" aria-hidden="true" tabindex="-1"></a>    sample <span class="op">=</span> np.random.choice(population, size<span class="op">=</span>sample_size, replace<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb38-36"><a href="#cb38-36" aria-hidden="true" tabindex="-1"></a>    sample_proportion, ci_lower, ci_upper <span class="op">=</span> calculate_ci_proportion(sample, confidence<span class="op">=</span>confidence_level)</span>
<span id="cb38-37"><a href="#cb38-37" aria-hidden="true" tabindex="-1"></a>    results.append({</span>
<span id="cb38-38"><a href="#cb38-38" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Sample Proportion'</span>: sample_proportion,</span>
<span id="cb38-39"><a href="#cb38-39" aria-hidden="true" tabindex="-1"></a>        <span class="st">'CI Lower'</span>: ci_lower,</span>
<span id="cb38-40"><a href="#cb38-40" aria-hidden="true" tabindex="-1"></a>        <span class="st">'CI Upper'</span>: ci_upper,</span>
<span id="cb38-41"><a href="#cb38-41" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Contains True Proportion'</span>: ci_lower <span class="op">&lt;=</span> population_proportion <span class="op">&lt;=</span> ci_upper</span>
<span id="cb38-42"><a href="#cb38-42" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb38-43"><a href="#cb38-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-44"><a href="#cb38-44" aria-hidden="true" tabindex="-1"></a>results_df <span class="op">=</span> pd.DataFrame(results)</span>
<span id="cb38-45"><a href="#cb38-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-46"><a href="#cb38-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Visualize the results</span></span>
<span id="cb38-47"><a href="#cb38-47" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb38-48"><a href="#cb38-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-49"><a href="#cb38-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot confidence intervals</span></span>
<span id="cb38-50"><a href="#cb38-50" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, (_, row) <span class="kw">in</span> <span class="bu">enumerate</span>(results_df.iterrows()):</span>
<span id="cb38-51"><a href="#cb38-51" aria-hidden="true" tabindex="-1"></a>    color <span class="op">=</span> <span class="st">'green'</span> <span class="cf">if</span> row[<span class="st">'Contains True Proportion'</span>] <span class="cf">else</span> <span class="st">'red'</span></span>
<span id="cb38-52"><a href="#cb38-52" aria-hidden="true" tabindex="-1"></a>    plt.plot([i, i], [row[<span class="st">'CI Lower'</span>], row[<span class="st">'CI Upper'</span>]], color<span class="op">=</span>color, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb38-53"><a href="#cb38-53" aria-hidden="true" tabindex="-1"></a>    plt.plot(i, row[<span class="st">'Sample Proportion'</span>], <span class="st">'o'</span>, color<span class="op">=</span>color, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb38-54"><a href="#cb38-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-55"><a href="#cb38-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot true population proportion</span></span>
<span id="cb38-56"><a href="#cb38-56" aria-hidden="true" tabindex="-1"></a>plt.axhline(y<span class="op">=</span>population_proportion, color<span class="op">=</span><span class="st">'blue'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, label<span class="op">=</span><span class="st">'True Population Proportion'</span>)</span>
<span id="cb38-57"><a href="#cb38-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-58"><a href="#cb38-58" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="ss">f"</span><span class="sc">{</span>confidence_level<span class="op">*</span><span class="dv">100</span><span class="sc">}</span><span class="ss">% Confidence Intervals for </span><span class="sc">{</span>num_samples<span class="sc">}</span><span class="ss"> Samples"</span>)</span>
<span id="cb38-59"><a href="#cb38-59" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Sample Number"</span>)</span>
<span id="cb38-60"><a href="#cb38-60" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Proportion"</span>)</span>
<span id="cb38-61"><a href="#cb38-61" aria-hidden="true" tabindex="-1"></a>plt.ylim(<span class="fl">0.5</span>, <span class="fl">0.7</span>)</span>
<span id="cb38-62"><a href="#cb38-62" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb38-63"><a href="#cb38-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-64"><a href="#cb38-64" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb38-65"><a href="#cb38-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-66"><a href="#cb38-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5: Print summary statistics</span></span>
<span id="cb38-67"><a href="#cb38-67" aria-hidden="true" tabindex="-1"></a>coverage_probability <span class="op">=</span> results_df[<span class="st">'Contains True Proportion'</span>].mean()</span>
<span id="cb38-68"><a href="#cb38-68" aria-hidden="true" tabindex="-1"></a>average_ci_width <span class="op">=</span> (results_df[<span class="st">'CI Upper'</span>] <span class="op">-</span> results_df[<span class="st">'CI Lower'</span>]).mean()</span>
<span id="cb38-69"><a href="#cb38-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-70"><a href="#cb38-70" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"True Population Proportion: </span><span class="sc">{</span>population_proportion<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb38-71"><a href="#cb38-71" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Sample Size: </span><span class="sc">{</span>sample_size<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb38-72"><a href="#cb38-72" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Number of Samples: </span><span class="sc">{</span>num_samples<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb38-73"><a href="#cb38-73" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Confidence Level: </span><span class="sc">{</span>confidence_level<span class="op">*</span><span class="dv">100</span><span class="sc">}</span><span class="ss">%"</span>)</span>
<span id="cb38-74"><a href="#cb38-74" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Observed Coverage Probability: </span><span class="sc">{</span>coverage_probability<span class="sc">:.2%}</span><span class="ss">"</span>)</span>
<span id="cb38-75"><a href="#cb38-75" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Average CI Width: </span><span class="sc">{</span>average_ci_width<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb38-76"><a href="#cb38-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-77"><a href="#cb38-77" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 6: Calculate theoretical margin of error</span></span>
<span id="cb38-78"><a href="#cb38-78" aria-hidden="true" tabindex="-1"></a>theoretical_margin_of_error <span class="op">=</span> stats.norm.ppf((<span class="dv">1</span> <span class="op">+</span> confidence_level) <span class="op">/</span> <span class="dv">2</span>) <span class="op">*</span> np.sqrt((population_proportion <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> population_proportion)) <span class="op">/</span> sample_size)</span>
<span id="cb38-79"><a href="#cb38-79" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Theoretical Margin of Error: </span><span class="sc">{</span>theoretical_margin_of_error<span class="sc">:.4f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="5_inferential_statistics_files/figure-html/cell-21-output-1.png" width="978" height="523" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>True Population Proportion: 0.60
Sample Size: 1000
Number of Samples: 100
Confidence Level: 95.0%
Observed Coverage Probability: 97.00%
Average CI Width: 0.0607
Theoretical Margin of Error: 0.0304</code></pre>
</div>
</div>
<hr>
</section>
</section>
<section id="for-variances" class="level3">
<h3 class="anchored" data-anchor-id="for-variances">For Variances</h3>
<section id="formula-2" class="level4">
<h4 class="anchored" data-anchor-id="formula-2">Formula</h4>
<p><span class="math display">\[
\text{CI} = \left[ \frac{(n-1)s^2}{\chi^2_{\alpha/2, n-1}}, \frac{(n-1)s^2}{\chi^2_{1-\alpha/2, n-1}} \right]
\]</span> where <span class="math inline">\(s^2\)</span> is the sample variance, <span class="math inline">\(n\)</span> is the sample size, and <span class="math inline">\(\chi^2\)</span> are the critical values from the chi-square distribution.</p>
</section>
<section id="example-22" class="level4">
<h4 class="anchored" data-anchor-id="example-22">Example</h4>
<p>95% CI for the variance of a sample of 20 with a sample variance of 4: [19<em>4/χ²(0.025,19), 19</em>4/χ²(0.975,19)] = [2.51, 8.89]. This interval suggests that we are 95% confident that the true variance lies between 2.51 and 8.89.</p>
<div id="ad53d74b" class="cell" data-execution_count="21">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Set random seed for reproducibility</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Define the population</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>population_mean <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>population_std <span class="op">=</span> <span class="dv">2</span>  <span class="co"># population standard deviation</span></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>population_var <span class="op">=</span> population_std<span class="op">**</span><span class="dv">2</span>  <span class="co"># population variance</span></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>population_size <span class="op">=</span> <span class="dv">100000</span></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>population <span class="op">=</span> stats.norm.rvs(loc<span class="op">=</span>population_mean, scale<span class="op">=</span>population_std, size<span class="op">=</span>population_size)</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Function to calculate confidence interval for variance</span></span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_ci_variance(sample, confidence<span class="op">=</span><span class="fl">0.95</span>):</span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>    sample_size <span class="op">=</span> <span class="bu">len</span>(sample)</span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>    sample_var <span class="op">=</span> np.var(sample, ddof<span class="op">=</span><span class="dv">1</span>)  <span class="co"># ddof=1 for sample variance</span></span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a>    chi2_lower <span class="op">=</span> stats.chi2.ppf((<span class="dv">1</span> <span class="op">-</span> confidence) <span class="op">/</span> <span class="dv">2</span>, df<span class="op">=</span>sample_size <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a>    chi2_upper <span class="op">=</span> stats.chi2.ppf((<span class="dv">1</span> <span class="op">+</span> confidence) <span class="op">/</span> <span class="dv">2</span>, df<span class="op">=</span>sample_size <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a>    ci_lower <span class="op">=</span> (sample_size <span class="op">-</span> <span class="dv">1</span>) <span class="op">*</span> sample_var <span class="op">/</span> chi2_upper</span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a>    ci_upper <span class="op">=</span> (sample_size <span class="op">-</span> <span class="dv">1</span>) <span class="op">*</span> sample_var <span class="op">/</span> chi2_lower</span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sample_var, ci_lower, ci_upper</span>
<span id="cb40-29"><a href="#cb40-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-30"><a href="#cb40-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Draw samples and calculate confidence intervals</span></span>
<span id="cb40-31"><a href="#cb40-31" aria-hidden="true" tabindex="-1"></a>sample_size <span class="op">=</span> <span class="dv">20</span></span>
<span id="cb40-32"><a href="#cb40-32" aria-hidden="true" tabindex="-1"></a>num_samples <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb40-33"><a href="#cb40-33" aria-hidden="true" tabindex="-1"></a>confidence_level <span class="op">=</span> <span class="fl">0.95</span></span>
<span id="cb40-34"><a href="#cb40-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-35"><a href="#cb40-35" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> []</span>
<span id="cb40-36"><a href="#cb40-36" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(num_samples):</span>
<span id="cb40-37"><a href="#cb40-37" aria-hidden="true" tabindex="-1"></a>    sample <span class="op">=</span> np.random.choice(population, size<span class="op">=</span>sample_size, replace<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb40-38"><a href="#cb40-38" aria-hidden="true" tabindex="-1"></a>    sample_var, ci_lower, ci_upper <span class="op">=</span> calculate_ci_variance(sample, confidence<span class="op">=</span>confidence_level)</span>
<span id="cb40-39"><a href="#cb40-39" aria-hidden="true" tabindex="-1"></a>    results.append({</span>
<span id="cb40-40"><a href="#cb40-40" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Sample Variance'</span>: sample_var,</span>
<span id="cb40-41"><a href="#cb40-41" aria-hidden="true" tabindex="-1"></a>        <span class="st">'CI Lower'</span>: ci_lower,</span>
<span id="cb40-42"><a href="#cb40-42" aria-hidden="true" tabindex="-1"></a>        <span class="st">'CI Upper'</span>: ci_upper,</span>
<span id="cb40-43"><a href="#cb40-43" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Contains True Variance'</span>: ci_lower <span class="op">&lt;=</span> population_var <span class="op">&lt;=</span> ci_upper</span>
<span id="cb40-44"><a href="#cb40-44" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb40-45"><a href="#cb40-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-46"><a href="#cb40-46" aria-hidden="true" tabindex="-1"></a>results_df <span class="op">=</span> pd.DataFrame(results)</span>
<span id="cb40-47"><a href="#cb40-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-48"><a href="#cb40-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Visualize the results</span></span>
<span id="cb40-49"><a href="#cb40-49" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb40-50"><a href="#cb40-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-51"><a href="#cb40-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot confidence intervals</span></span>
<span id="cb40-52"><a href="#cb40-52" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, (_, row) <span class="kw">in</span> <span class="bu">enumerate</span>(results_df.iterrows()):</span>
<span id="cb40-53"><a href="#cb40-53" aria-hidden="true" tabindex="-1"></a>    color <span class="op">=</span> <span class="st">'green'</span> <span class="cf">if</span> row[<span class="st">'Contains True Variance'</span>] <span class="cf">else</span> <span class="st">'red'</span></span>
<span id="cb40-54"><a href="#cb40-54" aria-hidden="true" tabindex="-1"></a>    plt.plot([i, i], [row[<span class="st">'CI Lower'</span>], row[<span class="st">'CI Upper'</span>]], color<span class="op">=</span>color, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb40-55"><a href="#cb40-55" aria-hidden="true" tabindex="-1"></a>    plt.plot(i, row[<span class="st">'Sample Variance'</span>], <span class="st">'o'</span>, color<span class="op">=</span>color, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb40-56"><a href="#cb40-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-57"><a href="#cb40-57" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot true population variance</span></span>
<span id="cb40-58"><a href="#cb40-58" aria-hidden="true" tabindex="-1"></a>plt.axhline(y<span class="op">=</span>population_var, color<span class="op">=</span><span class="st">'blue'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, label<span class="op">=</span><span class="st">'True Population Variance'</span>)</span>
<span id="cb40-59"><a href="#cb40-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-60"><a href="#cb40-60" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="ss">f"</span><span class="sc">{</span>confidence_level<span class="op">*</span><span class="dv">100</span><span class="sc">}</span><span class="ss">% Confidence Intervals for Variance (</span><span class="sc">{</span>num_samples<span class="sc">}</span><span class="ss"> Samples)"</span>)</span>
<span id="cb40-61"><a href="#cb40-61" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Sample Number"</span>)</span>
<span id="cb40-62"><a href="#cb40-62" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Variance"</span>)</span>
<span id="cb40-63"><a href="#cb40-63" aria-hidden="true" tabindex="-1"></a>plt.ylim(<span class="dv">0</span>, <span class="dv">10</span>)</span>
<span id="cb40-64"><a href="#cb40-64" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb40-65"><a href="#cb40-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-66"><a href="#cb40-66" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb40-67"><a href="#cb40-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-68"><a href="#cb40-68" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5: Print summary statistics</span></span>
<span id="cb40-69"><a href="#cb40-69" aria-hidden="true" tabindex="-1"></a>coverage_probability <span class="op">=</span> results_df[<span class="st">'Contains True Variance'</span>].mean()</span>
<span id="cb40-70"><a href="#cb40-70" aria-hidden="true" tabindex="-1"></a>average_ci_width <span class="op">=</span> (results_df[<span class="st">'CI Upper'</span>] <span class="op">-</span> results_df[<span class="st">'CI Lower'</span>]).mean()</span>
<span id="cb40-71"><a href="#cb40-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-72"><a href="#cb40-72" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"True Population Variance: </span><span class="sc">{</span>population_var<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb40-73"><a href="#cb40-73" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Sample Size: </span><span class="sc">{</span>sample_size<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb40-74"><a href="#cb40-74" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Number of Samples: </span><span class="sc">{</span>num_samples<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb40-75"><a href="#cb40-75" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Confidence Level: </span><span class="sc">{</span>confidence_level<span class="op">*</span><span class="dv">100</span><span class="sc">}</span><span class="ss">%"</span>)</span>
<span id="cb40-76"><a href="#cb40-76" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Observed Coverage Probability: </span><span class="sc">{</span>coverage_probability<span class="sc">:.2%}</span><span class="ss">"</span>)</span>
<span id="cb40-77"><a href="#cb40-77" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Average CI Width: </span><span class="sc">{</span>average_ci_width<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb40-78"><a href="#cb40-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-79"><a href="#cb40-79" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 6: Calculate theoretical CI for a specific sample</span></span>
<span id="cb40-80"><a href="#cb40-80" aria-hidden="true" tabindex="-1"></a>specific_sample <span class="op">=</span> np.random.choice(population, size<span class="op">=</span>sample_size, replace<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb40-81"><a href="#cb40-81" aria-hidden="true" tabindex="-1"></a>specific_sample_var, specific_ci_lower, specific_ci_upper <span class="op">=</span> calculate_ci_variance(specific_sample, confidence<span class="op">=</span>confidence_level)</span>
<span id="cb40-82"><a href="#cb40-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-83"><a href="#cb40-83" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Example for a specific sample:"</span>)</span>
<span id="cb40-84"><a href="#cb40-84" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Sample Variance: </span><span class="sc">{</span>specific_sample_var<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb40-85"><a href="#cb40-85" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"95% CI: [</span><span class="sc">{</span>specific_ci_lower<span class="sc">:.4f}</span><span class="ss">, </span><span class="sc">{</span>specific_ci_upper<span class="sc">:.4f}</span><span class="ss">]"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="5_inferential_statistics_files/figure-html/cell-22-output-1.png" width="957" height="523" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>True Population Variance: 4.00
Sample Size: 20
Number of Samples: 100
Confidence Level: 95.0%
Observed Coverage Probability: 96.00%
Average CI Width: 6.0136

Example for a specific sample:
Sample Variance: 2.1125
95% CI: [1.2217, 4.5065]</code></pre>
</div>
</div>
<hr>
</section>
</section>
<section id="one-sample-and-two-sample-cases" class="level3">
<h3 class="anchored" data-anchor-id="one-sample-and-two-sample-cases">One-Sample and Two-Sample Cases</h3>
<section id="one-sample" class="level4">
<h4 class="anchored" data-anchor-id="one-sample">One-Sample</h4>
<p>Confidence intervals for a single sample statistic provide an estimate of the population parameter based on the sample data. This is useful for determining the mean, proportion, or variance of a single group.</p>
</section>
<section id="two-sample" class="level4">
<h4 class="anchored" data-anchor-id="two-sample">Two-Sample</h4>
<p>Confidence intervals for the difference between two sample statistics compare two groups. This is useful for determining if there is a significant difference between the means, proportions, or variances of two independent samples.</p>
</section>
<section id="example-23" class="level4">
<h4 class="anchored" data-anchor-id="example-23">Example</h4>
<p>Comparing the means of two different classes’ test scores. If the 95% CI for the difference between the mean scores of Class A and Class B is [2, 10], we can be 95% confident that the mean score of Class A is between 2 and 10 points higher than that of Class B.</p>
</section>
<section id="one-sample-ci" class="level4">
<h4 class="anchored" data-anchor-id="one-sample-ci">One-Sample CI</h4>
<div id="2d9d225a" class="cell" data-execution_count="22">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Set random seed for reproducibility</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Define the population</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>population_mean <span class="op">=</span> <span class="dv">70</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>population_std <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>population_size <span class="op">=</span> <span class="dv">100000</span></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>population <span class="op">=</span> stats.norm.rvs(loc<span class="op">=</span>population_mean, scale<span class="op">=</span>population_std, size<span class="op">=</span>population_size)</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Draw a sample</span></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>sample_size <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>sample <span class="op">=</span> np.random.choice(population, size<span class="op">=</span>sample_size, replace<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Calculate one-sample confidence interval</span></span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_one_sample_ci(sample, confidence<span class="op">=</span><span class="fl">0.95</span>):</span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>    sample_mean <span class="op">=</span> np.mean(sample)</span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>    sample_std <span class="op">=</span> np.std(sample, ddof<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>    sample_size <span class="op">=</span> <span class="bu">len</span>(sample)</span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a>    margin_of_error <span class="op">=</span> stats.t.ppf((<span class="dv">1</span> <span class="op">+</span> confidence) <span class="op">/</span> <span class="dv">2</span>, df<span class="op">=</span>sample_size<span class="op">-</span><span class="dv">1</span>) <span class="op">*</span> (sample_std <span class="op">/</span> np.sqrt(sample_size))</span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a>    ci_lower <span class="op">=</span> sample_mean <span class="op">-</span> margin_of_error</span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a>    ci_upper <span class="op">=</span> sample_mean <span class="op">+</span> margin_of_error</span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sample_mean, ci_lower, ci_upper</span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-33"><a href="#cb42-33" aria-hidden="true" tabindex="-1"></a>sample_mean, ci_lower, ci_upper <span class="op">=</span> calculate_one_sample_ci(sample)</span>
<span id="cb42-34"><a href="#cb42-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-35"><a href="#cb42-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Print results</span></span>
<span id="cb42-36"><a href="#cb42-36" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Sample Mean: </span><span class="sc">{</span>sample_mean<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb42-37"><a href="#cb42-37" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"95% Confidence Interval: [</span><span class="sc">{</span>ci_lower<span class="sc">:.2f}</span><span class="ss">, </span><span class="sc">{</span>ci_upper<span class="sc">:.2f}</span><span class="ss">]"</span>)</span>
<span id="cb42-38"><a href="#cb42-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-39"><a href="#cb42-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5: Visualize the results</span></span>
<span id="cb42-40"><a href="#cb42-40" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">4</span>))</span>
<span id="cb42-41"><a href="#cb42-41" aria-hidden="true" tabindex="-1"></a>sns.histplot(sample, kde<span class="op">=</span><span class="va">True</span>, stat<span class="op">=</span><span class="st">"density"</span>, label<span class="op">=</span><span class="st">"Sample Distribution"</span>)</span>
<span id="cb42-42"><a href="#cb42-42" aria-hidden="true" tabindex="-1"></a>plt.axvline(sample_mean, color<span class="op">=</span><span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, label<span class="op">=</span><span class="st">'Sample Mean'</span>)</span>
<span id="cb42-43"><a href="#cb42-43" aria-hidden="true" tabindex="-1"></a>plt.axvline(ci_lower, color<span class="op">=</span><span class="st">'green'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, label<span class="op">=</span><span class="st">'95% CI Lower Bound'</span>)</span>
<span id="cb42-44"><a href="#cb42-44" aria-hidden="true" tabindex="-1"></a>plt.axvline(ci_upper, color<span class="op">=</span><span class="st">'green'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, label<span class="op">=</span><span class="st">'95% CI Upper Bound'</span>)</span>
<span id="cb42-45"><a href="#cb42-45" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"One-Sample Confidence Interval for Mean"</span>)</span>
<span id="cb42-46"><a href="#cb42-46" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Value"</span>)</span>
<span id="cb42-47"><a href="#cb42-47" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Density"</span>)</span>
<span id="cb42-48"><a href="#cb42-48" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb42-49"><a href="#cb42-49" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Sample Mean: 69.89
95% Confidence Interval: [67.80, 71.97]</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/Users/ravishankar/miniforge3/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning:

use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="5_inferential_statistics_files/figure-html/cell-23-output-3.png" width="680" height="376" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="two-sample-ci" class="level4">
<h4 class="anchored" data-anchor-id="two-sample-ci">Two-Sample CI</h4>
<div id="3cf5de3b" class="cell" data-execution_count="23">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Define the populations</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>population_mean_A <span class="op">=</span> <span class="dv">70</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>population_std_A <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>population_mean_B <span class="op">=</span> <span class="dv">65</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>population_std_B <span class="op">=</span> <span class="dv">12</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>population_size <span class="op">=</span> <span class="dv">100000</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>population_A <span class="op">=</span> stats.norm.rvs(loc<span class="op">=</span>population_mean_A, scale<span class="op">=</span>population_std_A, size<span class="op">=</span>population_size)</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>population_B <span class="op">=</span> stats.norm.rvs(loc<span class="op">=</span>population_mean_B, scale<span class="op">=</span>population_std_B, size<span class="op">=</span>population_size)</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Draw samples</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>sample_size <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>sample_A <span class="op">=</span> np.random.choice(population_A, size<span class="op">=</span>sample_size, replace<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>sample_B <span class="op">=</span> np.random.choice(population_B, size<span class="op">=</span>sample_size, replace<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Calculate two-sample confidence interval for the difference in means</span></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_two_sample_ci(sample_A, sample_B, confidence<span class="op">=</span><span class="fl">0.95</span>):</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>    mean_A <span class="op">=</span> np.mean(sample_A)</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>    mean_B <span class="op">=</span> np.mean(sample_B)</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>    var_A <span class="op">=</span> np.var(sample_A, ddof<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>    var_B <span class="op">=</span> np.var(sample_B, ddof<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>    size_A <span class="op">=</span> <span class="bu">len</span>(sample_A)</span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>    size_B <span class="op">=</span> <span class="bu">len</span>(sample_B)</span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>    mean_diff <span class="op">=</span> mean_A <span class="op">-</span> mean_B</span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a>    se_diff <span class="op">=</span> np.sqrt((var_A <span class="op">/</span> size_A) <span class="op">+</span> (var_B <span class="op">/</span> size_B))</span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a>    margin_of_error <span class="op">=</span> stats.t.ppf((<span class="dv">1</span> <span class="op">+</span> confidence) <span class="op">/</span> <span class="dv">2</span>, df<span class="op">=</span><span class="bu">min</span>(size_A, size_B)<span class="op">-</span><span class="dv">1</span>) <span class="op">*</span> se_diff</span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a>    ci_lower <span class="op">=</span> mean_diff <span class="op">-</span> margin_of_error</span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a>    ci_upper <span class="op">=</span> mean_diff <span class="op">+</span> margin_of_error</span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> mean_diff, ci_lower, ci_upper</span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a>mean_diff, ci_lower, ci_upper <span class="op">=</span> calculate_two_sample_ci(sample_A, sample_B)</span>
<span id="cb45-36"><a href="#cb45-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-37"><a href="#cb45-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Print results</span></span>
<span id="cb45-38"><a href="#cb45-38" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mean Difference: </span><span class="sc">{</span>mean_diff<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb45-39"><a href="#cb45-39" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"95% Confidence Interval for Difference: [</span><span class="sc">{</span>ci_lower<span class="sc">:.2f}</span><span class="ss">, </span><span class="sc">{</span>ci_upper<span class="sc">:.2f}</span><span class="ss">]"</span>)</span>
<span id="cb45-40"><a href="#cb45-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-41"><a href="#cb45-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5: Visualize the results</span></span>
<span id="cb45-42"><a href="#cb45-42" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb45-43"><a href="#cb45-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-44"><a href="#cb45-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot sample distributions</span></span>
<span id="cb45-45"><a href="#cb45-45" aria-hidden="true" tabindex="-1"></a>sns.histplot(sample_A, kde<span class="op">=</span><span class="va">True</span>, stat<span class="op">=</span><span class="st">"density"</span>, color<span class="op">=</span><span class="st">'blue'</span>, label<span class="op">=</span><span class="st">'Sample A Distribution'</span>)</span>
<span id="cb45-46"><a href="#cb45-46" aria-hidden="true" tabindex="-1"></a>sns.histplot(sample_B, kde<span class="op">=</span><span class="va">True</span>, stat<span class="op">=</span><span class="st">"density"</span>, color<span class="op">=</span><span class="st">'orange'</span>, label<span class="op">=</span><span class="st">'Sample B Distribution'</span>)</span>
<span id="cb45-47"><a href="#cb45-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-48"><a href="#cb45-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot means and confidence intervals</span></span>
<span id="cb45-49"><a href="#cb45-49" aria-hidden="true" tabindex="-1"></a>plt.axvline(np.mean(sample_A), color<span class="op">=</span><span class="st">'blue'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, label<span class="op">=</span><span class="st">'Sample A Mean'</span>)</span>
<span id="cb45-50"><a href="#cb45-50" aria-hidden="true" tabindex="-1"></a>plt.axvline(np.mean(sample_B), color<span class="op">=</span><span class="st">'orange'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, label<span class="op">=</span><span class="st">'Sample B Mean'</span>)</span>
<span id="cb45-51"><a href="#cb45-51" aria-hidden="true" tabindex="-1"></a>plt.axvline(mean_diff, color<span class="op">=</span><span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, label<span class="op">=</span><span class="st">'Mean Difference'</span>)</span>
<span id="cb45-52"><a href="#cb45-52" aria-hidden="true" tabindex="-1"></a>plt.axvline(ci_lower, color<span class="op">=</span><span class="st">'green'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, label<span class="op">=</span><span class="st">'95% CI Lower Bound'</span>)</span>
<span id="cb45-53"><a href="#cb45-53" aria-hidden="true" tabindex="-1"></a>plt.axvline(ci_upper, color<span class="op">=</span><span class="st">'green'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, label<span class="op">=</span><span class="st">'95% CI Upper Bound'</span>)</span>
<span id="cb45-54"><a href="#cb45-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-55"><a href="#cb45-55" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Two-Sample Confidence Interval for Difference in Means"</span>)</span>
<span id="cb45-56"><a href="#cb45-56" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Value"</span>)</span>
<span id="cb45-57"><a href="#cb45-57" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Density"</span>)</span>
<span id="cb45-58"><a href="#cb45-58" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb45-59"><a href="#cb45-59" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Mean Difference: 3.05
95% Confidence Interval for Difference: [0.01, 6.10]</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/Users/ravishankar/miniforge3/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning:

use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.

/Users/ravishankar/miniforge3/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning:

use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="5_inferential_statistics_files/figure-html/cell-24-output-3.png" width="969" height="523" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
</section>
</section>
<section id="hypothesis-testing" class="level2">
<h2 class="anchored" data-anchor-id="hypothesis-testing">Hypothesis Testing</h2>
<section id="null-and-alternative-hypotheses" class="level3">
<h3 class="anchored" data-anchor-id="null-and-alternative-hypotheses">Null and Alternative Hypotheses</h3>
<section id="definition-21" class="level4">
<h4 class="anchored" data-anchor-id="definition-21">Definition</h4>
<p>Hypothesis testing involves making an assumption (the null hypothesis) about a population parameter and then using sample data to test this assumption. The alternative hypothesis represents what we want to prove.</p>
</section>
<section id="null-hypothesis-h0" class="level4">
<h4 class="anchored" data-anchor-id="null-hypothesis-h0">Null Hypothesis (H0)</h4>
<p>The null hypothesis is a statement of no effect or no difference. It serves as the default assumption that there is no relationship between the variables or no difference between groups.</p>
</section>
<section id="alternative-hypothesis-h1" class="level4">
<h4 class="anchored" data-anchor-id="alternative-hypothesis-h1">Alternative Hypothesis (H1)</h4>
<p>The alternative hypothesis is a statement that contradicts the null hypothesis. It represents the presence of an effect or a difference.</p>
</section>
<section id="example-24" class="level4">
<h4 class="anchored" data-anchor-id="example-24">Example</h4>
<p>Testing whether a new drug is effective: H0: The drug has no effect. H1: The drug has an effect. The null hypothesis assumes no difference in outcomes between the treatment and control groups, while the alternative hypothesis suggests a difference.</p>
<div id="f65bf64d" class="cell" data-execution_count="24">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Set random seed for reproducibility</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Define the scenario</span></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Null Hypothesis (H0): The drug has no effect (mean blood pressure reduction = 0)</span></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternative Hypothesis (H1): The drug has an effect (mean blood pressure reduction ≠ 0)</span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Generate sample data</span></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>sample_size <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>true_effect <span class="op">=</span> <span class="dv">5</span>  <span class="co"># True mean reduction in blood pressure (unknown in real scenario)</span></span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>sample_data <span class="op">=</span> np.random.normal(loc<span class="op">=</span>true_effect, scale<span class="op">=</span><span class="dv">10</span>, size<span class="op">=</span>sample_size)</span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Perform one-sample t-test</span></span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>t_statistic, p_value <span class="op">=</span> stats.ttest_1samp(sample_data, popmean<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Print results</span></span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Hypothesis Test Results:"</span>)</span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Sample Mean: </span><span class="sc">{</span>np<span class="sc">.</span>mean(sample_data)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"t-statistic: </span><span class="sc">{</span>t_statistic<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"p-value: </span><span class="sc">{</span>p_value<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5: Interpret results</span></span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true" tabindex="-1"></a>alpha <span class="op">=</span> <span class="fl">0.05</span>  <span class="co"># Significance level</span></span>
<span id="cb48-30"><a href="#cb48-30" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> p_value <span class="op">&lt;</span> alpha:</span>
<span id="cb48-31"><a href="#cb48-31" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Reject the null hypothesis."</span>)</span>
<span id="cb48-32"><a href="#cb48-32" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"There is significant evidence to suggest that the drug has an effect."</span>)</span>
<span id="cb48-33"><a href="#cb48-33" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb48-34"><a href="#cb48-34" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Fail to reject the null hypothesis."</span>)</span>
<span id="cb48-35"><a href="#cb48-35" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"There is not enough evidence to suggest that the drug has an effect."</span>)</span>
<span id="cb48-36"><a href="#cb48-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-37"><a href="#cb48-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 6: Visualize the results</span></span>
<span id="cb48-38"><a href="#cb48-38" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb48-39"><a href="#cb48-39" aria-hidden="true" tabindex="-1"></a>sns.histplot(sample_data, kde<span class="op">=</span><span class="va">True</span>, stat<span class="op">=</span><span class="st">"density"</span>)</span>
<span id="cb48-40"><a href="#cb48-40" aria-hidden="true" tabindex="-1"></a>plt.axvline(<span class="dv">0</span>, color<span class="op">=</span><span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, label<span class="op">=</span><span class="st">'Null Hypothesis (μ = 0)'</span>)</span>
<span id="cb48-41"><a href="#cb48-41" aria-hidden="true" tabindex="-1"></a>plt.axvline(np.mean(sample_data), color<span class="op">=</span><span class="st">'green'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, label<span class="op">=</span><span class="st">'Sample Mean'</span>)</span>
<span id="cb48-42"><a href="#cb48-42" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Distribution of Blood Pressure Reduction"</span>)</span>
<span id="cb48-43"><a href="#cb48-43" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Blood Pressure Reduction (mmHg)"</span>)</span>
<span id="cb48-44"><a href="#cb48-44" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Density"</span>)</span>
<span id="cb48-45"><a href="#cb48-45" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb48-46"><a href="#cb48-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-47"><a href="#cb48-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Add annotation for p-value</span></span>
<span id="cb48-48"><a href="#cb48-48" aria-hidden="true" tabindex="-1"></a>plt.text(<span class="fl">0.7</span>, <span class="fl">0.95</span>, <span class="ss">f'p-value: </span><span class="sc">{</span>p_value<span class="sc">:.4f}</span><span class="ss">'</span>, transform<span class="op">=</span>plt.gca().transAxes, </span>
<span id="cb48-49"><a href="#cb48-49" aria-hidden="true" tabindex="-1"></a>         verticalalignment<span class="op">=</span><span class="st">'top'</span>, bbox<span class="op">=</span><span class="bu">dict</span>(boxstyle<span class="op">=</span><span class="st">'round'</span>, facecolor<span class="op">=</span><span class="st">'white'</span>, alpha<span class="op">=</span><span class="fl">0.8</span>))</span>
<span id="cb48-50"><a href="#cb48-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-51"><a href="#cb48-51" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb48-52"><a href="#cb48-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-53"><a href="#cb48-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 7: Calculate and plot confidence interval</span></span>
<span id="cb48-54"><a href="#cb48-54" aria-hidden="true" tabindex="-1"></a>confidence_level <span class="op">=</span> <span class="fl">0.95</span></span>
<span id="cb48-55"><a href="#cb48-55" aria-hidden="true" tabindex="-1"></a>degrees_of_freedom <span class="op">=</span> sample_size <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb48-56"><a href="#cb48-56" aria-hidden="true" tabindex="-1"></a>margin_of_error <span class="op">=</span> stats.t.ppf((<span class="dv">1</span> <span class="op">+</span> confidence_level) <span class="op">/</span> <span class="dv">2</span>, degrees_of_freedom) <span class="op">*</span> (np.std(sample_data, ddof<span class="op">=</span><span class="dv">1</span>) <span class="op">/</span> np.sqrt(sample_size))</span>
<span id="cb48-57"><a href="#cb48-57" aria-hidden="true" tabindex="-1"></a>ci_lower <span class="op">=</span> np.mean(sample_data) <span class="op">-</span> margin_of_error</span>
<span id="cb48-58"><a href="#cb48-58" aria-hidden="true" tabindex="-1"></a>ci_upper <span class="op">=</span> np.mean(sample_data) <span class="op">+</span> margin_of_error</span>
<span id="cb48-59"><a href="#cb48-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-60"><a href="#cb48-60" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="sc">{</span>confidence_level<span class="op">*</span><span class="dv">100</span><span class="sc">}</span><span class="ss">% Confidence Interval: [</span><span class="sc">{</span>ci_lower<span class="sc">:.2f}</span><span class="ss">, </span><span class="sc">{</span>ci_upper<span class="sc">:.2f}</span><span class="ss">]"</span>)</span>
<span id="cb48-61"><a href="#cb48-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-62"><a href="#cb48-62" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb48-63"><a href="#cb48-63" aria-hidden="true" tabindex="-1"></a>sns.histplot(sample_data, kde<span class="op">=</span><span class="va">True</span>, stat<span class="op">=</span><span class="st">"density"</span>)</span>
<span id="cb48-64"><a href="#cb48-64" aria-hidden="true" tabindex="-1"></a>plt.axvline(<span class="dv">0</span>, color<span class="op">=</span><span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, label<span class="op">=</span><span class="st">'Null Hypothesis (μ = 0)'</span>)</span>
<span id="cb48-65"><a href="#cb48-65" aria-hidden="true" tabindex="-1"></a>plt.axvline(np.mean(sample_data), color<span class="op">=</span><span class="st">'green'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, label<span class="op">=</span><span class="st">'Sample Mean'</span>)</span>
<span id="cb48-66"><a href="#cb48-66" aria-hidden="true" tabindex="-1"></a>plt.axvline(ci_lower, color<span class="op">=</span><span class="st">'blue'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, label<span class="op">=</span><span class="st">'Confidence Interval'</span>)</span>
<span id="cb48-67"><a href="#cb48-67" aria-hidden="true" tabindex="-1"></a>plt.axvline(ci_upper, color<span class="op">=</span><span class="st">'blue'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb48-68"><a href="#cb48-68" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="ss">f"Distribution of Blood Pressure Reduction with </span><span class="sc">{</span>confidence_level<span class="op">*</span><span class="dv">100</span><span class="sc">}</span><span class="ss">% CI"</span>)</span>
<span id="cb48-69"><a href="#cb48-69" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Blood Pressure Reduction (mmHg)"</span>)</span>
<span id="cb48-70"><a href="#cb48-70" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Density"</span>)</span>
<span id="cb48-71"><a href="#cb48-71" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb48-72"><a href="#cb48-72" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Hypothesis Test Results:
Sample Mean: 3.96
t-statistic: 4.3621
p-value: 0.0000

Reject the null hypothesis.
There is significant evidence to suggest that the drug has an effect.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/Users/ravishankar/miniforge3/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning:

use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="5_inferential_statistics_files/figure-html/cell-25-output-3.png" width="821" height="523" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
95.0% Confidence Interval: [2.16, 5.76]</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/Users/ravishankar/miniforge3/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning:

use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="5_inferential_statistics_files/figure-html/cell-25-output-6.png" width="821" height="523" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="one-tailed-and-two-tailed-tests" class="level3">
<h3 class="anchored" data-anchor-id="one-tailed-and-two-tailed-tests">One-Tailed and Two-Tailed Tests</h3>
<section id="definition-22" class="level4">
<h4 class="anchored" data-anchor-id="definition-22">Definition</h4>
<p>One-tailed and two-tailed tests refer to the direction of the hypothesis test.</p>
</section>
<section id="one-tailed-test" class="level4">
<h4 class="anchored" data-anchor-id="one-tailed-test">One-Tailed Test</h4>
<p>A one-tailed test examines if the sample parameter is either greater than or less than the population parameter. It is used when we have a specific direction in mind.</p>
</section>
<section id="two-tailed-test" class="level4">
<h4 class="anchored" data-anchor-id="two-tailed-test">Two-Tailed Test</h4>
<p>A two-tailed test examines if the sample parameter is different from the population parameter in either direction. It is used when we are interested in any difference, regardless of direction.</p>
</section>
<section id="example-25" class="level4">
<h4 class="anchored" data-anchor-id="example-25">Example</h4>
<p>If we only want to know if a new drug is more effective than the old drug, we use a one-tailed test. If we want to know if there is any difference in effectiveness, we use a two-tailed test.</p>
<div id="27670415" class="cell" data-execution_count="25">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy.stats <span class="im">as</span> stats</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Set random seed for reproducibility</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Define the scenario</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Null Hypothesis (H0): The new drug is not more effective than the old drug (μ_new - μ_old ≤ 0)</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternative Hypothesis (H1): The new drug is more effective than the old drug (μ_new - μ_old &gt; 0)</span></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Generate sample data</span></span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>sample_size <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>old_drug_effect <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">5</span>, scale<span class="op">=</span><span class="dv">2</span>, size<span class="op">=</span>sample_size)</span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>new_drug_effect <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">6</span>, scale<span class="op">=</span><span class="dv">2</span>, size<span class="op">=</span>sample_size)</span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Perform t-test</span></span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a>t_statistic, p_value_two_tailed <span class="op">=</span> stats.ttest_ind(new_drug_effect, old_drug_effect)</span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate one-tailed p-value</span></span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a>p_value_one_tailed <span class="op">=</span> p_value_two_tailed <span class="op">/</span> <span class="dv">2</span>  <span class="co"># Divide by 2 because we're only interested in one direction</span></span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Print results</span></span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Hypothesis Test Results:"</span>)</span>
<span id="cb53-26"><a href="#cb53-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Old Drug Mean Effect: </span><span class="sc">{</span>np<span class="sc">.</span>mean(old_drug_effect)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb53-27"><a href="#cb53-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"New Drug Mean Effect: </span><span class="sc">{</span>np<span class="sc">.</span>mean(new_drug_effect)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb53-28"><a href="#cb53-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"t-statistic: </span><span class="sc">{</span>t_statistic<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb53-29"><a href="#cb53-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Two-tailed p-value: </span><span class="sc">{</span>p_value_two_tailed<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb53-30"><a href="#cb53-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"One-tailed p-value: </span><span class="sc">{</span>p_value_one_tailed<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb53-31"><a href="#cb53-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-32"><a href="#cb53-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5: Interpret results</span></span>
<span id="cb53-33"><a href="#cb53-33" aria-hidden="true" tabindex="-1"></a>alpha <span class="op">=</span> <span class="fl">0.05</span>  <span class="co"># Significance level</span></span>
<span id="cb53-34"><a href="#cb53-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-35"><a href="#cb53-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Two-Tailed Test Interpretation:"</span>)</span>
<span id="cb53-36"><a href="#cb53-36" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> p_value_two_tailed <span class="op">&lt;</span> alpha:</span>
<span id="cb53-37"><a href="#cb53-37" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Reject the null hypothesis."</span>)</span>
<span id="cb53-38"><a href="#cb53-38" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"There is significant evidence to suggest a difference in effectiveness between the drugs."</span>)</span>
<span id="cb53-39"><a href="#cb53-39" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb53-40"><a href="#cb53-40" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Fail to reject the null hypothesis."</span>)</span>
<span id="cb53-41"><a href="#cb53-41" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"There is not enough evidence to suggest a difference in effectiveness between the drugs."</span>)</span>
<span id="cb53-42"><a href="#cb53-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-43"><a href="#cb53-43" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">One-Tailed Test Interpretation:"</span>)</span>
<span id="cb53-44"><a href="#cb53-44" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> p_value_one_tailed <span class="op">&lt;</span> alpha:</span>
<span id="cb53-45"><a href="#cb53-45" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Reject the null hypothesis."</span>)</span>
<span id="cb53-46"><a href="#cb53-46" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"There is significant evidence to suggest the new drug is more effective."</span>)</span>
<span id="cb53-47"><a href="#cb53-47" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb53-48"><a href="#cb53-48" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Fail to reject the null hypothesis."</span>)</span>
<span id="cb53-49"><a href="#cb53-49" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"There is not enough evidence to suggest the new drug is more effective."</span>)</span>
<span id="cb53-50"><a href="#cb53-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-51"><a href="#cb53-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 6: Visualize the results</span></span>
<span id="cb53-52"><a href="#cb53-52" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb53-53"><a href="#cb53-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-54"><a href="#cb53-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot distributions</span></span>
<span id="cb53-55"><a href="#cb53-55" aria-hidden="true" tabindex="-1"></a>sns.histplot(old_drug_effect, kde<span class="op">=</span><span class="va">True</span>, color<span class="op">=</span><span class="st">'blue'</span>, alpha<span class="op">=</span><span class="fl">0.5</span>, label<span class="op">=</span><span class="st">'Old Drug'</span>)</span>
<span id="cb53-56"><a href="#cb53-56" aria-hidden="true" tabindex="-1"></a>sns.histplot(new_drug_effect, kde<span class="op">=</span><span class="va">True</span>, color<span class="op">=</span><span class="st">'red'</span>, alpha<span class="op">=</span><span class="fl">0.5</span>, label<span class="op">=</span><span class="st">'New Drug'</span>)</span>
<span id="cb53-57"><a href="#cb53-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-58"><a href="#cb53-58" aria-hidden="true" tabindex="-1"></a><span class="co"># Add vertical lines for means</span></span>
<span id="cb53-59"><a href="#cb53-59" aria-hidden="true" tabindex="-1"></a>plt.axvline(np.mean(old_drug_effect), color<span class="op">=</span><span class="st">'blue'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, label<span class="op">=</span><span class="st">'Old Drug Mean'</span>)</span>
<span id="cb53-60"><a href="#cb53-60" aria-hidden="true" tabindex="-1"></a>plt.axvline(np.mean(new_drug_effect), color<span class="op">=</span><span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, label<span class="op">=</span><span class="st">'New Drug Mean'</span>)</span>
<span id="cb53-61"><a href="#cb53-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-62"><a href="#cb53-62" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Distribution of Drug Effects"</span>)</span>
<span id="cb53-63"><a href="#cb53-63" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Effect"</span>)</span>
<span id="cb53-64"><a href="#cb53-64" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Density"</span>)</span>
<span id="cb53-65"><a href="#cb53-65" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb53-66"><a href="#cb53-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-67"><a href="#cb53-67" aria-hidden="true" tabindex="-1"></a><span class="co"># Add annotations for p-values</span></span>
<span id="cb53-68"><a href="#cb53-68" aria-hidden="true" tabindex="-1"></a>plt.text(<span class="fl">0.05</span>, <span class="fl">0.95</span>, <span class="ss">f'Two-tailed p-value: </span><span class="sc">{</span>p_value_two_tailed<span class="sc">:.4f}</span><span class="ss">'</span>, transform<span class="op">=</span>plt.gca().transAxes, </span>
<span id="cb53-69"><a href="#cb53-69" aria-hidden="true" tabindex="-1"></a>         verticalalignment<span class="op">=</span><span class="st">'top'</span>, bbox<span class="op">=</span><span class="bu">dict</span>(boxstyle<span class="op">=</span><span class="st">'round'</span>, facecolor<span class="op">=</span><span class="st">'white'</span>, alpha<span class="op">=</span><span class="fl">0.8</span>))</span>
<span id="cb53-70"><a href="#cb53-70" aria-hidden="true" tabindex="-1"></a>plt.text(<span class="fl">0.05</span>, <span class="fl">0.85</span>, <span class="ss">f'One-tailed p-value: </span><span class="sc">{</span>p_value_one_tailed<span class="sc">:.4f}</span><span class="ss">'</span>, transform<span class="op">=</span>plt.gca().transAxes, </span>
<span id="cb53-71"><a href="#cb53-71" aria-hidden="true" tabindex="-1"></a>         verticalalignment<span class="op">=</span><span class="st">'top'</span>, bbox<span class="op">=</span><span class="bu">dict</span>(boxstyle<span class="op">=</span><span class="st">'round'</span>, facecolor<span class="op">=</span><span class="st">'white'</span>, alpha<span class="op">=</span><span class="fl">0.8</span>))</span>
<span id="cb53-72"><a href="#cb53-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-73"><a href="#cb53-73" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb53-74"><a href="#cb53-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-75"><a href="#cb53-75" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 7: Visualize critical regions</span></span>
<span id="cb53-76"><a href="#cb53-76" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb53-77"><a href="#cb53-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-78"><a href="#cb53-78" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">1000</span>)</span>
<span id="cb53-79"><a href="#cb53-79" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> stats.t.pdf(x, df<span class="op">=</span><span class="dv">2</span><span class="op">*</span>sample_size<span class="op">-</span><span class="dv">2</span>)</span>
<span id="cb53-80"><a href="#cb53-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-81"><a href="#cb53-81" aria-hidden="true" tabindex="-1"></a>plt.plot(x, y, <span class="st">'b-'</span>, lw<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="st">'t-distribution'</span>)</span>
<span id="cb53-82"><a href="#cb53-82" aria-hidden="true" tabindex="-1"></a>plt.fill_between(x, y, where<span class="op">=</span>(x <span class="op">&lt;=</span> <span class="op">-</span>t_statistic) <span class="op">|</span> (x <span class="op">&gt;=</span> t_statistic), color<span class="op">=</span><span class="st">'red'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>, label<span class="op">=</span><span class="st">'Two-tailed critical region'</span>)</span>
<span id="cb53-83"><a href="#cb53-83" aria-hidden="true" tabindex="-1"></a>plt.fill_between(x, y, where<span class="op">=</span>(x <span class="op">&gt;=</span> t_statistic), color<span class="op">=</span><span class="st">'green'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>, label<span class="op">=</span><span class="st">'One-tailed critical region'</span>)</span>
<span id="cb53-84"><a href="#cb53-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-85"><a href="#cb53-85" aria-hidden="true" tabindex="-1"></a>plt.axvline(t_statistic, color<span class="op">=</span><span class="st">'black'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, label<span class="op">=</span><span class="st">'Observed t-statistic'</span>)</span>
<span id="cb53-86"><a href="#cb53-86" aria-hidden="true" tabindex="-1"></a>plt.axvline(<span class="op">-</span>t_statistic, color<span class="op">=</span><span class="st">'black'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb53-87"><a href="#cb53-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-88"><a href="#cb53-88" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"t-Distribution with Critical Regions"</span>)</span>
<span id="cb53-89"><a href="#cb53-89" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"t-value"</span>)</span>
<span id="cb53-90"><a href="#cb53-90" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Density"</span>)</span>
<span id="cb53-91"><a href="#cb53-91" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb53-92"><a href="#cb53-92" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Hypothesis Test Results:
Old Drug Mean Effect: 4.79
New Drug Mean Effect: 6.04
t-statistic: 4.7547
Two-tailed p-value: 0.0000
One-tailed p-value: 0.0000

Two-Tailed Test Interpretation:
Reject the null hypothesis.
There is significant evidence to suggest a difference in effectiveness between the drugs.

One-Tailed Test Interpretation:
Reject the null hypothesis.
There is significant evidence to suggest the new drug is more effective.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/Users/ravishankar/miniforge3/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning:

use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.

/Users/ravishankar/miniforge3/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning:

use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="5_inferential_statistics_files/figure-html/cell-26-output-3.png" width="963" height="523" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="5_inferential_statistics_files/figure-html/cell-26-output-4.png" width="969" height="523" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="type-i-and-type-ii-errors" class="level3">
<h3 class="anchored" data-anchor-id="type-i-and-type-ii-errors">Type I and Type II Errors</h3>
<section id="type-i-error" class="level4">
<h4 class="anchored" data-anchor-id="type-i-error">Type I Error</h4>
<section id="definition-23" class="level5">
<h5 class="anchored" data-anchor-id="definition-23">Definition</h5>
<p>A Type I error occurs when we reject the null hypothesis when it is actually true. This is also known as a false positive.</p>
</section>
<section id="example-26" class="level5">
<h5 class="anchored" data-anchor-id="example-26">Example</h5>
<p>Concluding a drug is effective when it is not. If we set a significance level of 0.05, there is a 5% chance of committing a Type I error.</p>
</section>
</section>
<section id="type-ii-error" class="level4">
<h4 class="anchored" data-anchor-id="type-ii-error">Type II Error</h4>
<section id="definition-24" class="level5">
<h5 class="anchored" data-anchor-id="definition-24">Definition</h5>
<p>A Type II error occurs when we fail to reject the null hypothesis when it is actually false. This is also known as a false negative.</p>
</section>
<section id="example-27" class="level5">
<h5 class="anchored" data-anchor-id="example-27">Example</h5>
<p>Concluding a drug is not effective when it is. The probability of committing a Type II error is denoted by <span class="math inline">\(\beta\)</span>, and it is inversely related to the power of the test.</p>
<div id="d13ae326" class="cell" data-execution_count="26">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy.stats <span class="im">as</span> stats</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Set random seed for reproducibility</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Define the scenario</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Null Hypothesis (H0): The drug has no effect (μ = 0)</span></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternative Hypothesis (H1): The drug has an effect (μ ≠ 0)</span></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Set up parameters</span></span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>sample_size <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>num_simulations <span class="op">=</span> <span class="dv">10000</span></span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>alpha <span class="op">=</span> <span class="fl">0.05</span>  <span class="co"># Significance level</span></span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to simulate experiments and calculate error rates</span></span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> simulate_experiments(true_effect, num_simulations, sample_size, alpha):</span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a>    type_I_errors <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a>    type_II_errors <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(num_simulations):</span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a>        sample <span class="op">=</span> np.random.normal(loc<span class="op">=</span>true_effect, scale<span class="op">=</span><span class="dv">1</span>, size<span class="op">=</span>sample_size)</span>
<span id="cb56-25"><a href="#cb56-25" aria-hidden="true" tabindex="-1"></a>        t_statistic, p_value <span class="op">=</span> stats.ttest_1samp(sample, popmean<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb56-26"><a href="#cb56-26" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb56-27"><a href="#cb56-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> true_effect <span class="op">==</span> <span class="dv">0</span> <span class="kw">and</span> p_value <span class="op">&lt;</span> alpha:</span>
<span id="cb56-28"><a href="#cb56-28" aria-hidden="true" tabindex="-1"></a>            type_I_errors <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb56-29"><a href="#cb56-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> true_effect <span class="op">!=</span> <span class="dv">0</span> <span class="kw">and</span> p_value <span class="op">&gt;=</span> alpha:</span>
<span id="cb56-30"><a href="#cb56-30" aria-hidden="true" tabindex="-1"></a>            type_II_errors <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb56-31"><a href="#cb56-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb56-32"><a href="#cb56-32" aria-hidden="true" tabindex="-1"></a>    type_I_error_rate <span class="op">=</span> type_I_errors <span class="op">/</span> num_simulations <span class="cf">if</span> true_effect <span class="op">==</span> <span class="dv">0</span> <span class="cf">else</span> <span class="va">None</span></span>
<span id="cb56-33"><a href="#cb56-33" aria-hidden="true" tabindex="-1"></a>    type_II_error_rate <span class="op">=</span> type_II_errors <span class="op">/</span> num_simulations <span class="cf">if</span> true_effect <span class="op">!=</span> <span class="dv">0</span> <span class="cf">else</span> <span class="va">None</span></span>
<span id="cb56-34"><a href="#cb56-34" aria-hidden="true" tabindex="-1"></a>    power <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> type_II_error_rate <span class="cf">if</span> true_effect <span class="op">!=</span> <span class="dv">0</span> <span class="cf">else</span> <span class="va">None</span></span>
<span id="cb56-35"><a href="#cb56-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb56-36"><a href="#cb56-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> type_I_error_rate, type_II_error_rate, power</span>
<span id="cb56-37"><a href="#cb56-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-38"><a href="#cb56-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Simulate experiments with no effect (for Type I error)</span></span>
<span id="cb56-39"><a href="#cb56-39" aria-hidden="true" tabindex="-1"></a>type_I_error_rate, _, _ <span class="op">=</span> simulate_experiments(true_effect<span class="op">=</span><span class="dv">0</span>, num_simulations<span class="op">=</span>num_simulations, </span>
<span id="cb56-40"><a href="#cb56-40" aria-hidden="true" tabindex="-1"></a>                                               sample_size<span class="op">=</span>sample_size, alpha<span class="op">=</span>alpha)</span>
<span id="cb56-41"><a href="#cb56-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-42"><a href="#cb56-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Simulate experiments with small effect (for Type II error)</span></span>
<span id="cb56-43"><a href="#cb56-43" aria-hidden="true" tabindex="-1"></a>_, type_II_error_rate, power <span class="op">=</span> simulate_experiments(true_effect<span class="op">=</span><span class="fl">0.2</span>, num_simulations<span class="op">=</span>num_simulations, </span>
<span id="cb56-44"><a href="#cb56-44" aria-hidden="true" tabindex="-1"></a>                                                    sample_size<span class="op">=</span>sample_size, alpha<span class="op">=</span>alpha)</span>
<span id="cb56-45"><a href="#cb56-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-46"><a href="#cb56-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5: Print results</span></span>
<span id="cb56-47"><a href="#cb56-47" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Significance level (α): </span><span class="sc">{</span>alpha<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb56-48"><a href="#cb56-48" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Type I Error Rate: </span><span class="sc">{</span>type_I_error_rate<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb56-49"><a href="#cb56-49" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Type II Error Rate: </span><span class="sc">{</span>type_II_error_rate<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb56-50"><a href="#cb56-50" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Power: </span><span class="sc">{</span>power<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb56-51"><a href="#cb56-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-52"><a href="#cb56-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 6: Visualize the distributions and decision boundaries</span></span>
<span id="cb56-53"><a href="#cb56-53" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb56-54"><a href="#cb56-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-55"><a href="#cb56-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate data for plotting</span></span>
<span id="cb56-56"><a href="#cb56-56" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">1000</span>)</span>
<span id="cb56-57"><a href="#cb56-57" aria-hidden="true" tabindex="-1"></a>y_null <span class="op">=</span> stats.norm.pdf(x, loc<span class="op">=</span><span class="dv">0</span>, scale<span class="op">=</span><span class="dv">1</span><span class="op">/</span>np.sqrt(sample_size))</span>
<span id="cb56-58"><a href="#cb56-58" aria-hidden="true" tabindex="-1"></a>y_alt <span class="op">=</span> stats.norm.pdf(x, loc<span class="op">=</span><span class="fl">0.2</span>, scale<span class="op">=</span><span class="dv">1</span><span class="op">/</span>np.sqrt(sample_size))</span>
<span id="cb56-59"><a href="#cb56-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-60"><a href="#cb56-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot distributions</span></span>
<span id="cb56-61"><a href="#cb56-61" aria-hidden="true" tabindex="-1"></a>plt.plot(x, y_null, <span class="st">'b-'</span>, label<span class="op">=</span><span class="st">'Null Hypothesis (No Effect)'</span>)</span>
<span id="cb56-62"><a href="#cb56-62" aria-hidden="true" tabindex="-1"></a>plt.plot(x, y_alt, <span class="st">'r-'</span>, label<span class="op">=</span><span class="st">'Alternative Hypothesis (Small Effect)'</span>)</span>
<span id="cb56-63"><a href="#cb56-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-64"><a href="#cb56-64" aria-hidden="true" tabindex="-1"></a><span class="co"># Add decision boundaries</span></span>
<span id="cb56-65"><a href="#cb56-65" aria-hidden="true" tabindex="-1"></a>critical_value <span class="op">=</span> stats.t.ppf(<span class="dv">1</span> <span class="op">-</span> alpha<span class="op">/</span><span class="dv">2</span>, df<span class="op">=</span>sample_size<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb56-66"><a href="#cb56-66" aria-hidden="true" tabindex="-1"></a>plt.axvline(critical_value, color<span class="op">=</span><span class="st">'green'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, label<span class="op">=</span><span class="st">'Decision Boundary'</span>)</span>
<span id="cb56-67"><a href="#cb56-67" aria-hidden="true" tabindex="-1"></a>plt.axvline(<span class="op">-</span>critical_value, color<span class="op">=</span><span class="st">'green'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb56-68"><a href="#cb56-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-69"><a href="#cb56-69" aria-hidden="true" tabindex="-1"></a><span class="co"># Shade areas for Type I and Type II errors</span></span>
<span id="cb56-70"><a href="#cb56-70" aria-hidden="true" tabindex="-1"></a>plt.fill_between(x, <span class="dv">0</span>, y_null, where<span class="op">=</span>(x <span class="op">&gt;=</span> critical_value) <span class="op">|</span> (x <span class="op">&lt;=</span> <span class="op">-</span>critical_value), </span>
<span id="cb56-71"><a href="#cb56-71" aria-hidden="true" tabindex="-1"></a>                 color<span class="op">=</span><span class="st">'blue'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>, label<span class="op">=</span><span class="st">'Type I Error Region'</span>)</span>
<span id="cb56-72"><a href="#cb56-72" aria-hidden="true" tabindex="-1"></a>plt.fill_between(x, <span class="dv">0</span>, y_alt, where<span class="op">=</span>(x <span class="op">&lt;</span> critical_value) <span class="op">&amp;</span> (x <span class="op">&gt;</span> <span class="op">-</span>critical_value), </span>
<span id="cb56-73"><a href="#cb56-73" aria-hidden="true" tabindex="-1"></a>                 color<span class="op">=</span><span class="st">'red'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>, label<span class="op">=</span><span class="st">'Type II Error Region'</span>)</span>
<span id="cb56-74"><a href="#cb56-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-75"><a href="#cb56-75" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Visualization of Type I and Type II Errors"</span>)</span>
<span id="cb56-76"><a href="#cb56-76" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Test Statistic"</span>)</span>
<span id="cb56-77"><a href="#cb56-77" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Probability Density"</span>)</span>
<span id="cb56-78"><a href="#cb56-78" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb56-79"><a href="#cb56-79" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb56-80"><a href="#cb56-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-81"><a href="#cb56-81" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 7: Explore effect of sample size on error rates</span></span>
<span id="cb56-82"><a href="#cb56-82" aria-hidden="true" tabindex="-1"></a>sample_sizes <span class="op">=</span> np.arange(<span class="dv">20</span>, <span class="dv">201</span>, <span class="dv">20</span>)</span>
<span id="cb56-83"><a href="#cb56-83" aria-hidden="true" tabindex="-1"></a>type_I_error_rates <span class="op">=</span> []</span>
<span id="cb56-84"><a href="#cb56-84" aria-hidden="true" tabindex="-1"></a>type_II_error_rates <span class="op">=</span> []</span>
<span id="cb56-85"><a href="#cb56-85" aria-hidden="true" tabindex="-1"></a>powers <span class="op">=</span> []</span>
<span id="cb56-86"><a href="#cb56-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-87"><a href="#cb56-87" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> size <span class="kw">in</span> sample_sizes:</span>
<span id="cb56-88"><a href="#cb56-88" aria-hidden="true" tabindex="-1"></a>    type_I_rate, _, _ <span class="op">=</span> simulate_experiments(true_effect<span class="op">=</span><span class="dv">0</span>, num_simulations<span class="op">=</span>num_simulations, </span>
<span id="cb56-89"><a href="#cb56-89" aria-hidden="true" tabindex="-1"></a>                                             sample_size<span class="op">=</span>size, alpha<span class="op">=</span>alpha)</span>
<span id="cb56-90"><a href="#cb56-90" aria-hidden="true" tabindex="-1"></a>    _, type_II_rate, power <span class="op">=</span> simulate_experiments(true_effect<span class="op">=</span><span class="fl">0.2</span>, num_simulations<span class="op">=</span>num_simulations, </span>
<span id="cb56-91"><a href="#cb56-91" aria-hidden="true" tabindex="-1"></a>                                                  sample_size<span class="op">=</span>size, alpha<span class="op">=</span>alpha)</span>
<span id="cb56-92"><a href="#cb56-92" aria-hidden="true" tabindex="-1"></a>    type_I_error_rates.append(type_I_rate)</span>
<span id="cb56-93"><a href="#cb56-93" aria-hidden="true" tabindex="-1"></a>    type_II_error_rates.append(type_II_rate)</span>
<span id="cb56-94"><a href="#cb56-94" aria-hidden="true" tabindex="-1"></a>    powers.append(power)</span>
<span id="cb56-95"><a href="#cb56-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-96"><a href="#cb56-96" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot error rates and power vs sample size</span></span>
<span id="cb56-97"><a href="#cb56-97" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb56-98"><a href="#cb56-98" aria-hidden="true" tabindex="-1"></a>plt.plot(sample_sizes, type_I_error_rates, <span class="st">'b-'</span>, label<span class="op">=</span><span class="st">'Type I Error Rate'</span>)</span>
<span id="cb56-99"><a href="#cb56-99" aria-hidden="true" tabindex="-1"></a>plt.plot(sample_sizes, type_II_error_rates, <span class="st">'r-'</span>, label<span class="op">=</span><span class="st">'Type II Error Rate'</span>)</span>
<span id="cb56-100"><a href="#cb56-100" aria-hidden="true" tabindex="-1"></a>plt.plot(sample_sizes, powers, <span class="st">'g-'</span>, label<span class="op">=</span><span class="st">'Power'</span>)</span>
<span id="cb56-101"><a href="#cb56-101" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Error Rates and Power vs Sample Size"</span>)</span>
<span id="cb56-102"><a href="#cb56-102" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Sample Size"</span>)</span>
<span id="cb56-103"><a href="#cb56-103" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Probability"</span>)</span>
<span id="cb56-104"><a href="#cb56-104" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb56-105"><a href="#cb56-105" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Significance level (α): 0.05
Type I Error Rate: 0.0523
Type II Error Rate: 0.4942
Power: 0.5058</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="5_inferential_statistics_files/figure-html/cell-27-output-2.png" width="961" height="523" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="5_inferential_statistics_files/figure-html/cell-27-output-3.png" width="961" height="523" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
</section>
</section>
<section id="power-of-a-test" class="level3">
<h3 class="anchored" data-anchor-id="power-of-a-test">Power of a Test</h3>
<section id="definition-25" class="level4">
<h4 class="anchored" data-anchor-id="definition-25">Definition</h4>
<p>The power of a test is the probability of correctly rejecting the null hypothesis when it is false. It reflects the test’s ability to detect an effect if there is one.</p>
</section>
<section id="formula-3" class="level4">
<h4 class="anchored" data-anchor-id="formula-3">Formula</h4>
<p><span class="math display">\[
\text{Power} = 1 - \beta
\]</span> where <span class="math inline">\(\beta\)</span> is the probability of a Type II error.</p>
</section>
<section id="example-28" class="level4">
<h4 class="anchored" data-anchor-id="example-28">Example</h4>
<p>If a test has a power of 0.8, there is an 80% chance of detecting an effect if there is one. Increasing the sample size or the effect size can increase the power of a test.</p>
<div id="e4fe448e" class="cell" data-execution_count="27">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy.stats <span class="im">as</span> stats</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Set random seed for reproducibility</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Define parameters</span></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>alpha <span class="op">=</span> <span class="fl">0.05</span>  <span class="co"># Significance level</span></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>num_simulations <span class="op">=</span> <span class="dv">10000</span></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Function to calculate power</span></span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_power(effect_size, sample_size, num_simulations, alpha):</span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>    rejections <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(num_simulations):</span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Generate sample data with the given effect size</span></span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a>        sample <span class="op">=</span> np.random.normal(loc<span class="op">=</span>effect_size, scale<span class="op">=</span><span class="dv">1</span>, size<span class="op">=</span>sample_size)</span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Perform one-sample t-test</span></span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true" tabindex="-1"></a>        t_statistic, p_value <span class="op">=</span> stats.ttest_1samp(sample, popmean<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb58-22"><a href="#cb58-22" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb58-23"><a href="#cb58-23" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Check if null hypothesis is rejected</span></span>
<span id="cb58-24"><a href="#cb58-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> p_value <span class="op">&lt;</span> alpha:</span>
<span id="cb58-25"><a href="#cb58-25" aria-hidden="true" tabindex="-1"></a>            rejections <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb58-26"><a href="#cb58-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb58-27"><a href="#cb58-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate power</span></span>
<span id="cb58-28"><a href="#cb58-28" aria-hidden="true" tabindex="-1"></a>    power <span class="op">=</span> rejections <span class="op">/</span> num_simulations</span>
<span id="cb58-29"><a href="#cb58-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> power</span>
<span id="cb58-30"><a href="#cb58-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-31"><a href="#cb58-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Calculate power for different effect sizes and sample sizes</span></span>
<span id="cb58-32"><a href="#cb58-32" aria-hidden="true" tabindex="-1"></a>effect_sizes <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">20</span>)</span>
<span id="cb58-33"><a href="#cb58-33" aria-hidden="true" tabindex="-1"></a>sample_sizes <span class="op">=</span> [<span class="dv">20</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">200</span>]</span>
<span id="cb58-34"><a href="#cb58-34" aria-hidden="true" tabindex="-1"></a>power_results <span class="op">=</span> {}</span>
<span id="cb58-35"><a href="#cb58-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-36"><a href="#cb58-36" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> n <span class="kw">in</span> sample_sizes:</span>
<span id="cb58-37"><a href="#cb58-37" aria-hidden="true" tabindex="-1"></a>    power_results[n] <span class="op">=</span> [calculate_power(effect, n, num_simulations, alpha) <span class="cf">for</span> effect <span class="kw">in</span> effect_sizes]</span>
<span id="cb58-38"><a href="#cb58-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-39"><a href="#cb58-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Plot power curves</span></span>
<span id="cb58-40"><a href="#cb58-40" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb58-41"><a href="#cb58-41" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> n, powers <span class="kw">in</span> power_results.items():</span>
<span id="cb58-42"><a href="#cb58-42" aria-hidden="true" tabindex="-1"></a>    plt.plot(effect_sizes, powers, label<span class="op">=</span><span class="ss">f'n = </span><span class="sc">{</span>n<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb58-43"><a href="#cb58-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-44"><a href="#cb58-44" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Power Curves for Different Sample Sizes'</span>)</span>
<span id="cb58-45"><a href="#cb58-45" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Effect Size'</span>)</span>
<span id="cb58-46"><a href="#cb58-46" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Power'</span>)</span>
<span id="cb58-47"><a href="#cb58-47" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb58-48"><a href="#cb58-48" aria-hidden="true" tabindex="-1"></a>plt.axhline(y<span class="op">=</span><span class="fl">0.8</span>, color<span class="op">=</span><span class="st">'r'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, label<span class="op">=</span><span class="st">'0.8 Power Threshold'</span>)</span>
<span id="cb58-49"><a href="#cb58-49" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb58-50"><a href="#cb58-50" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb58-51"><a href="#cb58-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-52"><a href="#cb58-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5: Calculate required sample size for a given power</span></span>
<span id="cb58-53"><a href="#cb58-53" aria-hidden="true" tabindex="-1"></a>target_power <span class="op">=</span> <span class="fl">0.8</span></span>
<span id="cb58-54"><a href="#cb58-54" aria-hidden="true" tabindex="-1"></a>target_effect <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb58-55"><a href="#cb58-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-56"><a href="#cb58-56" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_required_sample_size(target_power, effect_size, alpha):</span>
<span id="cb58-57"><a href="#cb58-57" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="dv">10</span>  <span class="co"># Start with a small sample size</span></span>
<span id="cb58-58"><a href="#cb58-58" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="va">True</span>:</span>
<span id="cb58-59"><a href="#cb58-59" aria-hidden="true" tabindex="-1"></a>        power <span class="op">=</span> calculate_power(effect_size, n, num_simulations, alpha)</span>
<span id="cb58-60"><a href="#cb58-60" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> power <span class="op">&gt;=</span> target_power:</span>
<span id="cb58-61"><a href="#cb58-61" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> n</span>
<span id="cb58-62"><a href="#cb58-62" aria-hidden="true" tabindex="-1"></a>        n <span class="op">+=</span> <span class="dv">10</span>  <span class="co"># Increment sample size</span></span>
<span id="cb58-63"><a href="#cb58-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-64"><a href="#cb58-64" aria-hidden="true" tabindex="-1"></a>required_n <span class="op">=</span> calculate_required_sample_size(target_power, target_effect, alpha)</span>
<span id="cb58-65"><a href="#cb58-65" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Required sample size for </span><span class="sc">{</span>target_power<span class="op">*</span><span class="dv">100</span><span class="sc">}</span><span class="ss">% power at effect size </span><span class="sc">{</span>target_effect<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>required_n<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb58-66"><a href="#cb58-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-67"><a href="#cb58-67" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 6: Visualize Type II error and power</span></span>
<span id="cb58-68"><a href="#cb58-68" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb58-69"><a href="#cb58-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-70"><a href="#cb58-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate data for plotting</span></span>
<span id="cb58-71"><a href="#cb58-71" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">1000</span>)</span>
<span id="cb58-72"><a href="#cb58-72" aria-hidden="true" tabindex="-1"></a>y_null <span class="op">=</span> stats.norm.pdf(x, loc<span class="op">=</span><span class="dv">0</span>, scale<span class="op">=</span><span class="dv">1</span><span class="op">/</span>np.sqrt(required_n))</span>
<span id="cb58-73"><a href="#cb58-73" aria-hidden="true" tabindex="-1"></a>y_alt <span class="op">=</span> stats.norm.pdf(x, loc<span class="op">=</span>target_effect, scale<span class="op">=</span><span class="dv">1</span><span class="op">/</span>np.sqrt(required_n))</span>
<span id="cb58-74"><a href="#cb58-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-75"><a href="#cb58-75" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot distributions</span></span>
<span id="cb58-76"><a href="#cb58-76" aria-hidden="true" tabindex="-1"></a>plt.plot(x, y_null, <span class="st">'b-'</span>, label<span class="op">=</span><span class="st">'Null Hypothesis (No Effect)'</span>)</span>
<span id="cb58-77"><a href="#cb58-77" aria-hidden="true" tabindex="-1"></a>plt.plot(x, y_alt, <span class="st">'r-'</span>, label<span class="op">=</span><span class="st">'Alternative Hypothesis'</span>)</span>
<span id="cb58-78"><a href="#cb58-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-79"><a href="#cb58-79" aria-hidden="true" tabindex="-1"></a><span class="co"># Add decision boundary</span></span>
<span id="cb58-80"><a href="#cb58-80" aria-hidden="true" tabindex="-1"></a>critical_value <span class="op">=</span> stats.t.ppf(<span class="dv">1</span> <span class="op">-</span> alpha, df<span class="op">=</span>required_n<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb58-81"><a href="#cb58-81" aria-hidden="true" tabindex="-1"></a>plt.axvline(critical_value, color<span class="op">=</span><span class="st">'green'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, label<span class="op">=</span><span class="st">'Decision Boundary'</span>)</span>
<span id="cb58-82"><a href="#cb58-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-83"><a href="#cb58-83" aria-hidden="true" tabindex="-1"></a><span class="co"># Shade areas for Type II error and Power</span></span>
<span id="cb58-84"><a href="#cb58-84" aria-hidden="true" tabindex="-1"></a>plt.fill_between(x, <span class="dv">0</span>, y_alt, where<span class="op">=</span>(x <span class="op">&lt;</span> critical_value), color<span class="op">=</span><span class="st">'gray'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>, label<span class="op">=</span><span class="st">'Type II Error (β)'</span>)</span>
<span id="cb58-85"><a href="#cb58-85" aria-hidden="true" tabindex="-1"></a>plt.fill_between(x, <span class="dv">0</span>, y_alt, where<span class="op">=</span>(x <span class="op">&gt;=</span> critical_value), color<span class="op">=</span><span class="st">'red'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>, label<span class="op">=</span><span class="st">'Power (1-β)'</span>)</span>
<span id="cb58-86"><a href="#cb58-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-87"><a href="#cb58-87" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="ss">f"Visualization of Power and Type II Error (n=</span><span class="sc">{</span>required_n<span class="sc">}</span><span class="ss">, effect size=</span><span class="sc">{</span>target_effect<span class="sc">}</span><span class="ss">)"</span>)</span>
<span id="cb58-88"><a href="#cb58-88" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Test Statistic"</span>)</span>
<span id="cb58-89"><a href="#cb58-89" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Probability Density"</span>)</span>
<span id="cb58-90"><a href="#cb58-90" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb58-91"><a href="#cb58-91" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="5_inferential_statistics_files/figure-html/cell-28-output-1.png" width="961" height="523" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Required sample size for 80.0% power at effect size 0.5: 40</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="5_inferential_statistics_files/figure-html/cell-28-output-3.png" width="961" height="523" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="p-values-and-statistical-significance" class="level3">
<h3 class="anchored" data-anchor-id="p-values-and-statistical-significance">p-values and Statistical Significance</h3>
<section id="p-values" class="level4">
<h4 class="anchored" data-anchor-id="p-values">p-values</h4>
<section id="definition-26" class="level5">
<h5 class="anchored" data-anchor-id="definition-26">Definition</h5>
<p>The p-value is the probability of obtaining test results at least as extreme as the observed results, assuming the null hypothesis is true. It provides a measure of the strength of the evidence against the null hypothesis.</p>
</section>
<section id="example-29" class="level5">
<h5 class="anchored" data-anchor-id="example-29">Example</h5>
<p>A p-value of 0.03 means there is a 3% chance of observing the data if the null hypothesis is true. If the p-value is less than the significance level (e.g., 0.05), we reject the null hypothesis.</p>
</section>
</section>
<section id="statistical-significance" class="level4">
<h4 class="anchored" data-anchor-id="statistical-significance">Statistical Significance</h4>
<section id="definition-27" class="level5">
<h5 class="anchored" data-anchor-id="definition-27">Definition</h5>
<p>A result is statistically significant if the p-value is less than the chosen significance level (<span class="math inline">\(\alpha\)</span>), often 0.05. This means that the observed effect is unlikely to have occurred by chance alone.</p>
</section>
<section id="example-30" class="level5">
<h5 class="anchored" data-anchor-id="example-30">Example</h5>
<p>If the p-value is 0.03 and <span class="math inline">\(\alpha\)</span> is 0.05, the result is statistically significant, and we reject the null hypothesis. This indicates that there is strong evidence to suggest that the observed effect is real.</p>
<div id="3ba8f58f" class="cell" data-execution_count="28">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy.stats <span class="im">as</span> stats</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Set random seed for reproducibility</span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Define parameters</span></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>population_mean <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>population_std <span class="op">=</span> <span class="dv">15</span></span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>sample_size <span class="op">=</span> <span class="dv">30</span></span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>num_simulations <span class="op">=</span> <span class="dv">10000</span></span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>alpha <span class="op">=</span> <span class="fl">0.05</span>  <span class="co"># Significance level</span></span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Function to conduct experiment and calculate p-value</span></span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> conduct_experiment(true_mean, sample_size):</span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a>    sample <span class="op">=</span> np.random.normal(loc<span class="op">=</span>true_mean, scale<span class="op">=</span>population_std, size<span class="op">=</span>sample_size)</span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a>    t_statistic, p_value <span class="op">=</span> stats.ttest_1samp(sample, popmean<span class="op">=</span>population_mean)</span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> p_value</span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Simulate experiments with no effect</span></span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true" tabindex="-1"></a>p_values_null <span class="op">=</span> [conduct_experiment(population_mean, sample_size) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(num_simulations)]</span>
<span id="cb60-24"><a href="#cb60-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-25"><a href="#cb60-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Simulate experiments with small effect</span></span>
<span id="cb60-26"><a href="#cb60-26" aria-hidden="true" tabindex="-1"></a>effect_size <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb60-27"><a href="#cb60-27" aria-hidden="true" tabindex="-1"></a>p_values_effect <span class="op">=</span> [conduct_experiment(population_mean <span class="op">+</span> effect_size, sample_size) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(num_simulations)]</span>
<span id="cb60-28"><a href="#cb60-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-29"><a href="#cb60-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5: Visualize distribution of p-values</span></span>
<span id="cb60-30"><a href="#cb60-30" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb60-31"><a href="#cb60-31" aria-hidden="true" tabindex="-1"></a>sns.histplot(p_values_null, kde<span class="op">=</span><span class="va">True</span>, color<span class="op">=</span><span class="st">'blue'</span>, alpha<span class="op">=</span><span class="fl">0.5</span>, label<span class="op">=</span><span class="st">'No Effect'</span>)</span>
<span id="cb60-32"><a href="#cb60-32" aria-hidden="true" tabindex="-1"></a>sns.histplot(p_values_effect, kde<span class="op">=</span><span class="va">True</span>, color<span class="op">=</span><span class="st">'red'</span>, alpha<span class="op">=</span><span class="fl">0.5</span>, label<span class="op">=</span><span class="st">'Small Effect'</span>)</span>
<span id="cb60-33"><a href="#cb60-33" aria-hidden="true" tabindex="-1"></a>plt.axvline(alpha, color<span class="op">=</span><span class="st">'green'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, label<span class="op">=</span><span class="st">'Significance Level (α)'</span>)</span>
<span id="cb60-34"><a href="#cb60-34" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Distribution of p-values'</span>)</span>
<span id="cb60-35"><a href="#cb60-35" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'p-value'</span>)</span>
<span id="cb60-36"><a href="#cb60-36" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Frequency'</span>)</span>
<span id="cb60-37"><a href="#cb60-37" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb60-38"><a href="#cb60-38" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb60-39"><a href="#cb60-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-40"><a href="#cb60-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 6: Calculate proportion of significant results</span></span>
<span id="cb60-41"><a href="#cb60-41" aria-hidden="true" tabindex="-1"></a>significant_null <span class="op">=</span> np.mean(np.array(p_values_null) <span class="op">&lt;</span> alpha)</span>
<span id="cb60-42"><a href="#cb60-42" aria-hidden="true" tabindex="-1"></a>significant_effect <span class="op">=</span> np.mean(np.array(p_values_effect) <span class="op">&lt;</span> alpha)</span>
<span id="cb60-43"><a href="#cb60-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-44"><a href="#cb60-44" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Proportion of significant results (No Effect): </span><span class="sc">{</span>significant_null<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb60-45"><a href="#cb60-45" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Proportion of significant results (Small Effect): </span><span class="sc">{</span>significant_effect<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb60-46"><a href="#cb60-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-47"><a href="#cb60-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 7: Demonstrate p-value interpretation with a single experiment</span></span>
<span id="cb60-48"><a href="#cb60-48" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">123</span>)  <span class="co"># Set seed for reproducibility of this specific example</span></span>
<span id="cb60-49"><a href="#cb60-49" aria-hidden="true" tabindex="-1"></a>sample <span class="op">=</span> np.random.normal(loc<span class="op">=</span>population_mean <span class="op">+</span> effect_size, scale<span class="op">=</span>population_std, size<span class="op">=</span>sample_size)</span>
<span id="cb60-50"><a href="#cb60-50" aria-hidden="true" tabindex="-1"></a>t_statistic, p_value <span class="op">=</span> stats.ttest_1samp(sample, popmean<span class="op">=</span>population_mean)</span>
<span id="cb60-51"><a href="#cb60-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-52"><a href="#cb60-52" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Single Experiment Results:"</span>)</span>
<span id="cb60-53"><a href="#cb60-53" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Sample Mean: </span><span class="sc">{</span>np<span class="sc">.</span>mean(sample)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb60-54"><a href="#cb60-54" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"t-statistic: </span><span class="sc">{</span>t_statistic<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb60-55"><a href="#cb60-55" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"p-value: </span><span class="sc">{</span>p_value<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb60-56"><a href="#cb60-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-57"><a href="#cb60-57" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> p_value <span class="op">&lt;</span> alpha:</span>
<span id="cb60-58"><a href="#cb60-58" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"The result is statistically significant. We reject the null hypothesis."</span>)</span>
<span id="cb60-59"><a href="#cb60-59" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb60-60"><a href="#cb60-60" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"The result is not statistically significant. We fail to reject the null hypothesis."</span>)</span>
<span id="cb60-61"><a href="#cb60-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-62"><a href="#cb60-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 8: Visualize the single experiment result</span></span>
<span id="cb60-63"><a href="#cb60-63" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb60-64"><a href="#cb60-64" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="dv">80</span>, <span class="dv">120</span>, <span class="dv">1000</span>)</span>
<span id="cb60-65"><a href="#cb60-65" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> stats.t.pdf(x, df<span class="op">=</span>sample_size<span class="op">-</span><span class="dv">1</span>, loc<span class="op">=</span>population_mean, scale<span class="op">=</span>population_std<span class="op">/</span>np.sqrt(sample_size))</span>
<span id="cb60-66"><a href="#cb60-66" aria-hidden="true" tabindex="-1"></a>plt.plot(x, y, <span class="st">'b-'</span>, label<span class="op">=</span><span class="st">'Null Hypothesis Distribution'</span>)</span>
<span id="cb60-67"><a href="#cb60-67" aria-hidden="true" tabindex="-1"></a>plt.axvline(np.mean(sample), color<span class="op">=</span><span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, label<span class="op">=</span><span class="st">'Observed Sample Mean'</span>)</span>
<span id="cb60-68"><a href="#cb60-68" aria-hidden="true" tabindex="-1"></a>plt.axvline(population_mean, color<span class="op">=</span><span class="st">'green'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, label<span class="op">=</span><span class="st">'Null Hypothesis Mean'</span>)</span>
<span id="cb60-69"><a href="#cb60-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-70"><a href="#cb60-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Shade p-value area</span></span>
<span id="cb60-71"><a href="#cb60-71" aria-hidden="true" tabindex="-1"></a>critical_value <span class="op">=</span> stats.t.ppf(<span class="dv">1</span> <span class="op">-</span> alpha<span class="op">/</span><span class="dv">2</span>, df<span class="op">=</span>sample_size<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb60-72"><a href="#cb60-72" aria-hidden="true" tabindex="-1"></a>plt.fill_between(x, <span class="dv">0</span>, y, where<span class="op">=</span>(x <span class="op">&gt;=</span> np.mean(sample)) <span class="op">|</span> (x <span class="op">&lt;=</span> <span class="dv">2</span><span class="op">*</span>population_mean <span class="op">-</span> np.mean(sample)), </span>
<span id="cb60-73"><a href="#cb60-73" aria-hidden="true" tabindex="-1"></a>                 color<span class="op">=</span><span class="st">'gray'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>, label<span class="op">=</span><span class="st">'p-value area'</span>)</span>
<span id="cb60-74"><a href="#cb60-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-75"><a href="#cb60-75" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="ss">f"Visualization of p-value (p = </span><span class="sc">{</span>p_value<span class="sc">:.4f}</span><span class="ss">)"</span>)</span>
<span id="cb60-76"><a href="#cb60-76" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Sample Mean"</span>)</span>
<span id="cb60-77"><a href="#cb60-77" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Probability Density"</span>)</span>
<span id="cb60-78"><a href="#cb60-78" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb60-79"><a href="#cb60-79" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>/Users/ravishankar/miniforge3/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning:

use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.

/Users/ravishankar/miniforge3/lib/python3.10/site-packages/seaborn/_oldcore.py:1119: FutureWarning:

use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="5_inferential_statistics_files/figure-html/cell-29-output-2.png" width="974" height="523" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Proportion of significant results (No Effect): 0.0562
Proportion of significant results (Small Effect): 0.4163

Single Experiment Results:
Sample Mean: 105.67
t-statistic: 1.7441
p-value: 0.0917
The result is not statistically significant. We fail to reject the null hypothesis.</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="5_inferential_statistics_files/figure-html/cell-29-output-4.png" width="969" height="523" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
</section>
</section>
<section id="effect-size-and-practical-significance" class="level3">
<h3 class="anchored" data-anchor-id="effect-size-and-practical-significance">Effect Size and Practical Significance</h3>
<section id="effect-size" class="level4">
<h4 class="anchored" data-anchor-id="effect-size">Effect Size</h4>
<section id="definition-28" class="level5">
<h5 class="anchored" data-anchor-id="definition-28">Definition</h5>
<p>Effect size measures the magnitude of a treatment effect or difference between groups. It provides information about the practical importance of the result, beyond statistical significance.</p>
</section>
<section id="cohens-d" class="level5">
<h5 class="anchored" data-anchor-id="cohens-d">Cohen’s d</h5>
<p>Cohen’s d is a standardized measure of effect size that expresses the difference between two means in terms of standard deviations.</p>
<p><span class="math display">\[
d = \frac{\bar{x}_1 - \bar{x}_2}{s_{pooled}}
\]</span></p>
</section>
<section id="example-31" class="level5">
<h5 class="anchored" data-anchor-id="example-31">Example</h5>
<p>An effect size of 0.5 indicates a medium effect. This measure helps to understand the practical significance of the results, regardless of the sample size.</p>
</section>
</section>
<section id="practical-significance" class="level4">
<h4 class="anchored" data-anchor-id="practical-significance">Practical Significance</h4>
<section id="definition-29" class="level5">
<h5 class="anchored" data-anchor-id="definition-29">Definition</h5>
<p>Practical significance refers to the real-world importance or relevance of a result. It considers whether the effect size is large enough to be meaningful in a practical context.</p>
</section>
<section id="example-32" class="level5">
<h5 class="anchored" data-anchor-id="example-32">Example</h5>
<p>A drug might show a statistically significant reduction in blood pressure, but the effect size is so small that it is not practically significant. This highlights the need to consider both statistical and practical significance when interpreting results.</p>
<div id="619ea7db" class="cell" data-execution_count="29">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy.stats <span class="im">as</span> stats</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Set random seed for reproducibility</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Define parameters</span></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>sample_size <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>num_simulations <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>alpha <span class="op">=</span> <span class="fl">0.05</span>  <span class="co"># Significance level</span></span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Function to calculate Cohen's d</span></span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> cohens_d(group1, group2):</span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>    n1, n2 <span class="op">=</span> <span class="bu">len</span>(group1), <span class="bu">len</span>(group2)</span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>    var1, var2 <span class="op">=</span> np.var(group1, ddof<span class="op">=</span><span class="dv">1</span>), np.var(group2, ddof<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>    pooled_std <span class="op">=</span> np.sqrt(((n1 <span class="op">-</span> <span class="dv">1</span>) <span class="op">*</span> var1 <span class="op">+</span> (n2 <span class="op">-</span> <span class="dv">1</span>) <span class="op">*</span> var2) <span class="op">/</span> (n1 <span class="op">+</span> n2 <span class="op">-</span> <span class="dv">2</span>))</span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (np.mean(group1) <span class="op">-</span> np.mean(group2)) <span class="op">/</span> pooled_std</span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Function to conduct experiment and calculate p-value and effect size</span></span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> conduct_experiment(effect_size):</span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a>    group1 <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">0</span>, scale<span class="op">=</span><span class="dv">1</span>, size<span class="op">=</span>sample_size)</span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a>    group2 <span class="op">=</span> np.random.normal(loc<span class="op">=</span>effect_size, scale<span class="op">=</span><span class="dv">1</span>, size<span class="op">=</span>sample_size)</span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a>    t_statistic, p_value <span class="op">=</span> stats.ttest_ind(group1, group2)</span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a>    d <span class="op">=</span> cohens_d(group1, group2)</span>
<span id="cb63-27"><a href="#cb63-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> p_value, d</span>
<span id="cb63-28"><a href="#cb63-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-29"><a href="#cb63-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Simulate experiments with different effect sizes</span></span>
<span id="cb63-30"><a href="#cb63-30" aria-hidden="true" tabindex="-1"></a>effect_sizes <span class="op">=</span> [<span class="dv">0</span>, <span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="fl">0.8</span>]  <span class="co"># No effect, small, medium, large</span></span>
<span id="cb63-31"><a href="#cb63-31" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> {effect: [conduct_experiment(effect) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(num_simulations)] <span class="cf">for</span> effect <span class="kw">in</span> effect_sizes}</span>
<span id="cb63-32"><a href="#cb63-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-33"><a href="#cb63-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5: Analyze and visualize results</span></span>
<span id="cb63-34"><a href="#cb63-34" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">8</span>))</span>
<span id="cb63-35"><a href="#cb63-35" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, effect <span class="kw">in</span> <span class="bu">enumerate</span>(effect_sizes):</span>
<span id="cb63-36"><a href="#cb63-36" aria-hidden="true" tabindex="-1"></a>    p_values, d_values <span class="op">=</span> <span class="bu">zip</span>(<span class="op">*</span>results[effect])</span>
<span id="cb63-37"><a href="#cb63-37" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb63-38"><a href="#cb63-38" aria-hidden="true" tabindex="-1"></a>    plt.subplot(<span class="dv">2</span>, <span class="dv">2</span>, i<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb63-39"><a href="#cb63-39" aria-hidden="true" tabindex="-1"></a>    plt.scatter(d_values, p_values, alpha<span class="op">=</span><span class="fl">0.1</span>)</span>
<span id="cb63-40"><a href="#cb63-40" aria-hidden="true" tabindex="-1"></a>    plt.axhline(alpha, color<span class="op">=</span><span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, label<span class="op">=</span><span class="st">'Significance Level'</span>)</span>
<span id="cb63-41"><a href="#cb63-41" aria-hidden="true" tabindex="-1"></a>    plt.axvline(effect, color<span class="op">=</span><span class="st">'green'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, label<span class="op">=</span><span class="st">'True Effect Size'</span>)</span>
<span id="cb63-42"><a href="#cb63-42" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="ss">f"Effect Size = </span><span class="sc">{</span>effect<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb63-43"><a href="#cb63-43" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">"Cohen's d"</span>)</span>
<span id="cb63-44"><a href="#cb63-44" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">"p-value"</span>)</span>
<span id="cb63-45"><a href="#cb63-45" aria-hidden="true" tabindex="-1"></a>    plt.yscale(<span class="st">'log'</span>)</span>
<span id="cb63-46"><a href="#cb63-46" aria-hidden="true" tabindex="-1"></a>    plt.legend()</span>
<span id="cb63-47"><a href="#cb63-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-48"><a href="#cb63-48" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb63-49"><a href="#cb63-49" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb63-50"><a href="#cb63-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-51"><a href="#cb63-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 6: Calculate proportion of significant results and mean effect size</span></span>
<span id="cb63-52"><a href="#cb63-52" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> effect <span class="kw">in</span> effect_sizes:</span>
<span id="cb63-53"><a href="#cb63-53" aria-hidden="true" tabindex="-1"></a>    p_values, d_values <span class="op">=</span> <span class="bu">zip</span>(<span class="op">*</span>results[effect])</span>
<span id="cb63-54"><a href="#cb63-54" aria-hidden="true" tabindex="-1"></a>    prop_significant <span class="op">=</span> np.mean(np.array(p_values) <span class="op">&lt;</span> alpha)</span>
<span id="cb63-55"><a href="#cb63-55" aria-hidden="true" tabindex="-1"></a>    mean_d <span class="op">=</span> np.mean(d_values)</span>
<span id="cb63-56"><a href="#cb63-56" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Effect Size </span><span class="sc">{</span>effect<span class="sc">}</span><span class="ss">:"</span>)</span>
<span id="cb63-57"><a href="#cb63-57" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  Proportion of significant results: </span><span class="sc">{</span>prop_significant<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb63-58"><a href="#cb63-58" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  Mean Cohen's d: </span><span class="sc">{</span>mean_d<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb63-59"><a href="#cb63-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-60"><a href="#cb63-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 7: Demonstrate practical significance</span></span>
<span id="cb63-61"><a href="#cb63-61" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> interpret_cohens_d(d):</span>
<span id="cb63-62"><a href="#cb63-62" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">abs</span>(d) <span class="op">&lt;</span> <span class="fl">0.2</span>:</span>
<span id="cb63-63"><a href="#cb63-63" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">"Negligible effect"</span></span>
<span id="cb63-64"><a href="#cb63-64" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> <span class="bu">abs</span>(d) <span class="op">&lt;</span> <span class="fl">0.5</span>:</span>
<span id="cb63-65"><a href="#cb63-65" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">"Small effect"</span></span>
<span id="cb63-66"><a href="#cb63-66" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> <span class="bu">abs</span>(d) <span class="op">&lt;</span> <span class="fl">0.8</span>:</span>
<span id="cb63-67"><a href="#cb63-67" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">"Medium effect"</span></span>
<span id="cb63-68"><a href="#cb63-68" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb63-69"><a href="#cb63-69" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">"Large effect"</span></span>
<span id="cb63-70"><a href="#cb63-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-71"><a href="#cb63-71" aria-hidden="true" tabindex="-1"></a><span class="co"># Example scenario</span></span>
<span id="cb63-72"><a href="#cb63-72" aria-hidden="true" tabindex="-1"></a>control_group <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">100</span>, scale<span class="op">=</span><span class="dv">15</span>, size<span class="op">=</span><span class="dv">100</span>)</span>
<span id="cb63-73"><a href="#cb63-73" aria-hidden="true" tabindex="-1"></a>treatment_group <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">105</span>, scale<span class="op">=</span><span class="dv">15</span>, size<span class="op">=</span><span class="dv">100</span>)</span>
<span id="cb63-74"><a href="#cb63-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-75"><a href="#cb63-75" aria-hidden="true" tabindex="-1"></a>t_statistic, p_value <span class="op">=</span> stats.ttest_ind(control_group, treatment_group)</span>
<span id="cb63-76"><a href="#cb63-76" aria-hidden="true" tabindex="-1"></a>d <span class="op">=</span> cohens_d(control_group, treatment_group)</span>
<span id="cb63-77"><a href="#cb63-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-78"><a href="#cb63-78" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Example Scenario:"</span>)</span>
<span id="cb63-79"><a href="#cb63-79" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"p-value: </span><span class="sc">{</span>p_value<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb63-80"><a href="#cb63-80" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Cohen's d: </span><span class="sc">{</span>d<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb63-81"><a href="#cb63-81" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Effect size interpretation: </span><span class="sc">{</span>interpret_cohens_d(d)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb63-82"><a href="#cb63-82" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mean difference: </span><span class="sc">{</span>np<span class="sc">.</span>mean(treatment_group) <span class="op">-</span> np<span class="sc">.</span>mean(control_group)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb63-83"><a href="#cb63-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-84"><a href="#cb63-84" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> p_value <span class="op">&lt;</span> alpha:</span>
<span id="cb63-85"><a href="#cb63-85" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"The result is statistically significant."</span>)</span>
<span id="cb63-86"><a href="#cb63-86" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb63-87"><a href="#cb63-87" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"The result is not statistically significant."</span>)</span>
<span id="cb63-88"><a href="#cb63-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-89"><a href="#cb63-89" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Practical significance: The treatment increases the outcome by about "</span> </span>
<span id="cb63-90"><a href="#cb63-90" aria-hidden="true" tabindex="-1"></a>      <span class="ss">f"</span><span class="sc">{</span>np<span class="sc">.</span>mean(treatment_group) <span class="op">-</span> np<span class="sc">.</span>mean(control_group)<span class="sc">:.1f}</span><span class="ss"> units. "</span></span>
<span id="cb63-91"><a href="#cb63-91" aria-hidden="true" tabindex="-1"></a>      <span class="ss">f"This is a </span><span class="sc">{</span>interpret_cohens_d(d)<span class="sc">.</span>lower()<span class="sc">}</span><span class="ss">, which may or may not be practically significant "</span></span>
<span id="cb63-92"><a href="#cb63-92" aria-hidden="true" tabindex="-1"></a>      <span class="ss">f"depending on the context of the study and the cost/benefit of the treatment."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="5_inferential_statistics_files/figure-html/cell-30-output-1.png" width="1140" height="756" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Effect Size 0:
  Proportion of significant results: 0.06
  Mean Cohen's d: 0.00
Effect Size 0.2:
  Proportion of significant results: 0.27
  Mean Cohen's d: -0.20
Effect Size 0.5:
  Proportion of significant results: 0.93
  Mean Cohen's d: -0.50
Effect Size 0.8:
  Proportion of significant results: 1.00
  Mean Cohen's d: -0.80

Example Scenario:
p-value: 0.8370
Cohen's d: -0.03
Effect size interpretation: Negligible effect
Mean difference: 0.42
The result is not statistically significant.
Practical significance: The treatment increases the outcome by about 0.4 units. This is a negligible effect, which may or may not be practically significant depending on the context of the study and the cost/benefit of the treatment.</code></pre>
</div>
</div>
<hr>
</section>
</section>
</section>
<section id="multiple-comparison-procedures" class="level3">
<h3 class="anchored" data-anchor-id="multiple-comparison-procedures">Multiple Comparison Procedures</h3>
<section id="bonferroni-correction" class="level4">
<h4 class="anchored" data-anchor-id="bonferroni-correction">Bonferroni Correction</h4>
<section id="definition-30" class="level5">
<h5 class="anchored" data-anchor-id="definition-30">Definition</h5>
<p>The Bonferroni correction is a method to control the family-wise error rate when performing multiple hypothesis tests. It adjusts the significance level by dividing it by the number of tests.</p>
</section>
<section id="example-33" class="level5">
<h5 class="anchored" data-anchor-id="example-33">Example</h5>
<p>If we are conducting 10 tests with an overall significance level of 0.05, the Bonferroni correction sets the significance level for each test at 0.005. This reduces the likelihood of Type I errors.</p>
</section>
</section>
<section id="tukeys-hsd" class="level4">
<h4 class="anchored" data-anchor-id="tukeys-hsd">Tukey’s HSD</h4>
<section id="definition-31" class="level5">
<h5 class="anchored" data-anchor-id="definition-31">Definition</h5>
<p>Tukey’s Honestly Significant Difference (HSD) test is a post-hoc test used to identify which specific groups’ means are different after performing an ANOVA. It controls for the family-wise error rate.</p>
</section>
<section id="example-34" class="level5">
<h5 class="anchored" data-anchor-id="example-34">Example</h5>
<p>After finding a significant result in an ANOVA comparing multiple teaching methods, Tukey’s HSD can determine which pairs of teaching methods differ significantly.</p>
</section>
</section>
<section id="false-discovery-rate-fdr" class="level4">
<h4 class="anchored" data-anchor-id="false-discovery-rate-fdr">False Discovery Rate (FDR)</h4>
<section id="definition-32" class="level5">
<h5 class="anchored" data-anchor-id="definition-32">Definition</h5>
<p>The False Discovery Rate (FDR) is the expected proportion of false positives among the rejected hypotheses. Procedures controlling FDR, such as the Benjamini-Hochberg procedure, are less conservative than the Bonferroni correction, providing more power.</p>
</section>
<section id="example-35" class="level5">
<h5 class="anchored" data-anchor-id="example-35">Example</h5>
<p>In genetic studies with thousands of tests, controlling the FDR allows for more discoveries while limiting the proportion of false positives. This approach is useful when dealing with large datasets and numerous comparisons.</p>
<div id="6099bc3e" class="cell" data-execution_count="30">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.stats.multicomp <span class="im">import</span> pairwise_tukeyhsd</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.stats.multitest <span class="im">import</span> multipletests</span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Set random seed for reproducibility</span></span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Generate data for multiple groups</span></span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>num_groups <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a>samples_per_group <span class="op">=</span> <span class="dv">30</span></span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a>group_means <span class="op">=</span> [<span class="dv">0</span>, <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="fl">1.5</span>, <span class="dv">2</span>]</span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a>group_std <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-18"><a href="#cb65-18" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> []</span>
<span id="cb65-19"><a href="#cb65-19" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> []</span>
<span id="cb65-20"><a href="#cb65-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, mean <span class="kw">in</span> <span class="bu">enumerate</span>(group_means):</span>
<span id="cb65-21"><a href="#cb65-21" aria-hidden="true" tabindex="-1"></a>    group_data <span class="op">=</span> np.random.normal(loc<span class="op">=</span>mean, scale<span class="op">=</span>group_std, size<span class="op">=</span>samples_per_group)</span>
<span id="cb65-22"><a href="#cb65-22" aria-hidden="true" tabindex="-1"></a>    data.extend(group_data)</span>
<span id="cb65-23"><a href="#cb65-23" aria-hidden="true" tabindex="-1"></a>    labels.extend([<span class="ss">f'Group </span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">'</span>] <span class="op">*</span> samples_per_group)</span>
<span id="cb65-24"><a href="#cb65-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-25"><a href="#cb65-25" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame({<span class="st">'Value'</span>: data, <span class="st">'Group'</span>: labels})</span>
<span id="cb65-26"><a href="#cb65-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-27"><a href="#cb65-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Perform one-way ANOVA</span></span>
<span id="cb65-28"><a href="#cb65-28" aria-hidden="true" tabindex="-1"></a>groups <span class="op">=</span> [group <span class="cf">for</span> _, group <span class="kw">in</span> df.groupby(<span class="st">'Group'</span>)[<span class="st">'Value'</span>]]</span>
<span id="cb65-29"><a href="#cb65-29" aria-hidden="true" tabindex="-1"></a>f_statistic, p_value <span class="op">=</span> stats.f_oneway(<span class="op">*</span>groups)</span>
<span id="cb65-30"><a href="#cb65-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-31"><a href="#cb65-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"One-way ANOVA results:"</span>)</span>
<span id="cb65-32"><a href="#cb65-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"F-statistic: </span><span class="sc">{</span>f_statistic<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb65-33"><a href="#cb65-33" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"p-value: </span><span class="sc">{</span>p_value<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb65-34"><a href="#cb65-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-35"><a href="#cb65-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Pairwise t-tests with Bonferroni correction</span></span>
<span id="cb65-36"><a href="#cb65-36" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> pairwise_t_tests(df):</span>
<span id="cb65-37"><a href="#cb65-37" aria-hidden="true" tabindex="-1"></a>    groups <span class="op">=</span> df[<span class="st">'Group'</span>].unique()</span>
<span id="cb65-38"><a href="#cb65-38" aria-hidden="true" tabindex="-1"></a>    results <span class="op">=</span> []</span>
<span id="cb65-39"><a href="#cb65-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(groups)):</span>
<span id="cb65-40"><a href="#cb65-40" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i<span class="op">+</span><span class="dv">1</span>, <span class="bu">len</span>(groups)):</span>
<span id="cb65-41"><a href="#cb65-41" aria-hidden="true" tabindex="-1"></a>            group1 <span class="op">=</span> df[df[<span class="st">'Group'</span>] <span class="op">==</span> groups[i]][<span class="st">'Value'</span>]</span>
<span id="cb65-42"><a href="#cb65-42" aria-hidden="true" tabindex="-1"></a>            group2 <span class="op">=</span> df[df[<span class="st">'Group'</span>] <span class="op">==</span> groups[j]][<span class="st">'Value'</span>]</span>
<span id="cb65-43"><a href="#cb65-43" aria-hidden="true" tabindex="-1"></a>            t_stat, p_val <span class="op">=</span> stats.ttest_ind(group1, group2)</span>
<span id="cb65-44"><a href="#cb65-44" aria-hidden="true" tabindex="-1"></a>            results.append((groups[i], groups[j], p_val))</span>
<span id="cb65-45"><a href="#cb65-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> results</span>
<span id="cb65-46"><a href="#cb65-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-47"><a href="#cb65-47" aria-hidden="true" tabindex="-1"></a>pairwise_results <span class="op">=</span> pairwise_t_tests(df)</span>
<span id="cb65-48"><a href="#cb65-48" aria-hidden="true" tabindex="-1"></a>num_comparisons <span class="op">=</span> <span class="bu">len</span>(pairwise_results)</span>
<span id="cb65-49"><a href="#cb65-49" aria-hidden="true" tabindex="-1"></a>bonferroni_threshold <span class="op">=</span> <span class="fl">0.05</span> <span class="op">/</span> num_comparisons</span>
<span id="cb65-50"><a href="#cb65-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-51"><a href="#cb65-51" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Pairwise t-tests with Bonferroni correction:"</span>)</span>
<span id="cb65-52"><a href="#cb65-52" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> group1, group2, p_val <span class="kw">in</span> pairwise_results:</span>
<span id="cb65-53"><a href="#cb65-53" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>group1<span class="sc">}</span><span class="ss"> vs </span><span class="sc">{</span>group2<span class="sc">}</span><span class="ss">: p-value = </span><span class="sc">{</span>p_val<span class="sc">:.4f}</span><span class="ss">, </span><span class="sc">{</span><span class="st">'Significant'</span> <span class="cf">if</span> p_val <span class="op">&lt;</span> bonferroni_threshold <span class="cf">else</span> <span class="st">'Not significant'</span><span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb65-54"><a href="#cb65-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-55"><a href="#cb65-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Tukey's HSD</span></span>
<span id="cb65-56"><a href="#cb65-56" aria-hidden="true" tabindex="-1"></a>tukey_results <span class="op">=</span> pairwise_tukeyhsd(df[<span class="st">'Value'</span>], df[<span class="st">'Group'</span>])</span>
<span id="cb65-57"><a href="#cb65-57" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Tukey's HSD results:"</span>)</span>
<span id="cb65-58"><a href="#cb65-58" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(tukey_results)</span>
<span id="cb65-59"><a href="#cb65-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-60"><a href="#cb65-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5: False Discovery Rate (FDR) control</span></span>
<span id="cb65-61"><a href="#cb65-61" aria-hidden="true" tabindex="-1"></a>_, p_values_fdr, _, _ <span class="op">=</span> multipletests([p <span class="cf">for</span> _, _, p <span class="kw">in</span> pairwise_results], method<span class="op">=</span><span class="st">'fdr_bh'</span>)</span>
<span id="cb65-62"><a href="#cb65-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-63"><a href="#cb65-63" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">FDR-corrected results:"</span>)</span>
<span id="cb65-64"><a href="#cb65-64" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (group1, group2, _), p_fdr <span class="kw">in</span> <span class="bu">zip</span>(pairwise_results, p_values_fdr):</span>
<span id="cb65-65"><a href="#cb65-65" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>group1<span class="sc">}</span><span class="ss"> vs </span><span class="sc">{</span>group2<span class="sc">}</span><span class="ss">: FDR-corrected p-value = </span><span class="sc">{</span>p_fdr<span class="sc">:.4f}</span><span class="ss">, </span><span class="sc">{</span><span class="st">'Significant'</span> <span class="cf">if</span> p_fdr <span class="op">&lt;</span> <span class="fl">0.05</span> <span class="cf">else</span> <span class="st">'Not significant'</span><span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb65-66"><a href="#cb65-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-67"><a href="#cb65-67" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 6: Visualize results</span></span>
<span id="cb65-68"><a href="#cb65-68" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb65-69"><a href="#cb65-69" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x<span class="op">=</span><span class="st">'Group'</span>, y<span class="op">=</span><span class="st">'Value'</span>, data<span class="op">=</span>df)</span>
<span id="cb65-70"><a href="#cb65-70" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Comparison of Group Means'</span>)</span>
<span id="cb65-71"><a href="#cb65-71" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb65-72"><a href="#cb65-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-73"><a href="#cb65-73" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 7: Heatmap of p-values</span></span>
<span id="cb65-74"><a href="#cb65-74" aria-hidden="true" tabindex="-1"></a>groups <span class="op">=</span> df[<span class="st">'Group'</span>].unique()</span>
<span id="cb65-75"><a href="#cb65-75" aria-hidden="true" tabindex="-1"></a>p_value_matrix <span class="op">=</span> np.ones((<span class="bu">len</span>(groups), <span class="bu">len</span>(groups)))</span>
<span id="cb65-76"><a href="#cb65-76" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, group1 <span class="kw">in</span> <span class="bu">enumerate</span>(groups):</span>
<span id="cb65-77"><a href="#cb65-77" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j, group2 <span class="kw">in</span> <span class="bu">enumerate</span>(groups):</span>
<span id="cb65-78"><a href="#cb65-78" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> i <span class="op">&lt;</span> j:</span>
<span id="cb65-79"><a href="#cb65-79" aria-hidden="true" tabindex="-1"></a>            p_value_matrix[i, j] <span class="op">=</span> p_value_matrix[j, i] <span class="op">=</span> <span class="bu">next</span>(p <span class="cf">for</span> g1, g2, p <span class="kw">in</span> pairwise_results <span class="cf">if</span> (g1 <span class="op">==</span> group1 <span class="kw">and</span> g2 <span class="op">==</span> group2) <span class="kw">or</span> (g1 <span class="op">==</span> group2 <span class="kw">and</span> g2 <span class="op">==</span> group1))</span>
<span id="cb65-80"><a href="#cb65-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-81"><a href="#cb65-81" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">8</span>))</span>
<span id="cb65-82"><a href="#cb65-82" aria-hidden="true" tabindex="-1"></a>sns.heatmap(p_value_matrix, annot<span class="op">=</span><span class="va">True</span>, cmap<span class="op">=</span><span class="st">'coolwarm_r'</span>, xticklabels<span class="op">=</span>groups, yticklabels<span class="op">=</span>groups)</span>
<span id="cb65-83"><a href="#cb65-83" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Heatmap of Pairwise Comparison p-values'</span>)</span>
<span id="cb65-84"><a href="#cb65-84" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>One-way ANOVA results:
F-statistic: 23.2570
p-value: 0.0000

Pairwise t-tests with Bonferroni correction:
Group 1 vs Group 2: p-value = 0.0197, Not significant
Group 1 vs Group 3: p-value = 0.0000, Significant
Group 1 vs Group 4: p-value = 0.0000, Significant
Group 1 vs Group 5: p-value = 0.0000, Significant
Group 2 vs Group 3: p-value = 0.0133, Not significant
Group 2 vs Group 4: p-value = 0.0000, Significant
Group 2 vs Group 5: p-value = 0.0000, Significant
Group 3 vs Group 4: p-value = 0.0623, Not significant
Group 3 vs Group 5: p-value = 0.0011, Significant
Group 4 vs Group 5: p-value = 0.0943, Not significant

Tukey's HSD results:
 Multiple Comparison of Means - Tukey HSD, FWER=0.05 
=====================================================
 group1  group2 meandiff p-adj   lower  upper  reject
-----------------------------------------------------
Group 1 Group 2    0.567  0.149 -0.1124 1.2463  False
Group 1 Group 3    1.201    0.0  0.5217 1.8804   True
Group 1 Group 4   1.6679    0.0  0.9886 2.3472   True
Group 1 Group 5   2.0932    0.0  1.4138 2.7725   True
Group 2 Group 3    0.634 0.0798 -0.0453 1.3134  False
Group 2 Group 4   1.1009 0.0001  0.4216 1.7802   True
Group 2 Group 5   1.5262    0.0  0.8469 2.2055   True
Group 3 Group 4   0.4669 0.3228 -0.2125 1.1462  False
Group 3 Group 5   0.8922 0.0036  0.2128 1.5715   True
Group 4 Group 5   0.4253 0.4193  -0.254 1.1046  False
-----------------------------------------------------

FDR-corrected results:
Group 1 vs Group 2: FDR-corrected p-value = 0.0246, Significant
Group 1 vs Group 3: FDR-corrected p-value = 0.0000, Significant
Group 1 vs Group 4: FDR-corrected p-value = 0.0000, Significant
Group 1 vs Group 5: FDR-corrected p-value = 0.0000, Significant
Group 2 vs Group 3: FDR-corrected p-value = 0.0191, Significant
Group 2 vs Group 4: FDR-corrected p-value = 0.0000, Significant
Group 2 vs Group 5: FDR-corrected p-value = 0.0000, Significant
Group 3 vs Group 4: FDR-corrected p-value = 0.0692, Not significant
Group 3 vs Group 5: FDR-corrected p-value = 0.0019, Significant
Group 4 vs Group 5: FDR-corrected p-value = 0.0943, Not significant</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="5_inferential_statistics_files/figure-html/cell-31-output-2.png" width="959" height="523" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="5_inferential_statistics_files/figure-html/cell-31-output-3.png" width="734" height="653" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
</section>
</section>
</section>
<section id="confidence-intervals-1" class="level2">
<h2 class="anchored" data-anchor-id="confidence-intervals-1">Confidence Intervals</h2>
<section id="definition-33" class="level3">
<h3 class="anchored" data-anchor-id="definition-33">Definition</h3>
<p>Confidence intervals provide a range of values within which the population parameter is expected to lie with a certain confidence level. They offer an estimate of the parameter and convey the uncertainty associated with the estimate.</p>
</section>
<section id="components-1" class="level3">
<h3 class="anchored" data-anchor-id="components-1">Components</h3>
<ul>
<li><p><strong>Point Estimate</strong>: The sample statistic (e.g., sample mean) used to estimate the population parameter. It is the best single estimate of the parameter.</p></li>
<li><p><strong>Margin of Error</strong>: The range within which the true population parameter is expected to lie. It reflects the precision of the estimate and is influenced by the sample size and variability.</p></li>
<li><p><strong>Confidence Level</strong>: The probability that the interval contains the population parameter (e.g., 95%). It indicates the degree of confidence we have that the interval includes the true parameter.</p></li>
</ul>
</section>
<section id="normal-approximation" class="level3">
<h3 class="anchored" data-anchor-id="normal-approximation">Normal Approximation</h3>
<section id="definition-34" class="level4">
<h4 class="anchored" data-anchor-id="definition-34">Definition</h4>
<p>Using the normal distribution to approximate the confidence interval. This method is applicable when the sample size is large enough for the Central Limit Theorem to hold, allowing the use of the standard normal distribution.</p>
</section>
<section id="example-36" class="level4">
<h4 class="anchored" data-anchor-id="example-36">Example</h4>
<p>When the sample size is large, the sampling distribution of the sample mean is approximately normal. This allows us to construct confidence intervals using the standard normal distribution.</p>
</section>
</section>
<section id="students-t-distribution" class="level3">
<h3 class="anchored" data-anchor-id="students-t-distribution">Student’s t-distribution</h3>
<section id="definition-35" class="level4">
<h4 class="anchored" data-anchor-id="definition-35">Definition</h4>
<p>The Student’s t-distribution is used for confidence intervals when the sample size is small and the population standard deviation is unknown. It accounts for the increased variability in small samples.</p>
</section>
<section id="example-37" class="level4">
<h4 class="anchored" data-anchor-id="example-37">Example</h4>
<p>When the sample size is small (less than 30), the t-distribution provides a more accurate interval estimate. For example, estimating the mean weight of a small sample of fish from a pond.</p>
</section>
</section>
<section id="bootstrap-confidence-intervals" class="level3">
<h3 class="anchored" data-anchor-id="bootstrap-confidence-intervals">Bootstrap Confidence Intervals</h3>
<section id="definition-36" class="level4">
<h4 class="anchored" data-anchor-id="definition-36">Definition</h4>
<p>Bootstrap confidence intervals are estimated by repeatedly resampling the data with replacement and calculating the statistic of interest for each resample. This method does not rely on assumptions about the population distribution.</p>
</section>
<section id="example-38" class="level4">
<h4 class="anchored" data-anchor-id="example-38">Example</h4>
<p>Estimating the confidence interval for the median income of a sample of households by generating thousands of bootstrap samples and calculating the median for each sample. This approach provides robust interval estimates even for non-normal data.</p>
</section>
</section>
</section>
<section id="questions" class="level2">
<h2 class="anchored" data-anchor-id="questions">Questions</h2>
<section id="hypothesis-testing-1" class="level3">
<h3 class="anchored" data-anchor-id="hypothesis-testing-1">Hypothesis Testing</h3>
<section id="null-and-alternative-hypotheses-1" class="level4">
<h4 class="anchored" data-anchor-id="null-and-alternative-hypotheses-1">1. Null and Alternative Hypotheses</h4>
<p><strong>Question:</strong> How would you formulate null and alternative hypotheses to test if a new feature on Instagram increases user engagement?</p>
<p><strong>Answer:</strong> The null hypothesis (<span class="math inline">\(H_0\)</span>) represents the default position that there is no effect or difference. The alternative hypothesis (<span class="math inline">\(H_1\)</span>) represents the position that there is an effect or difference. For testing if a new feature increases user engagement: - <span class="math inline">\(H_0\)</span>: The new feature does not increase user engagement (mean engagement after feature = mean engagement before feature). - <span class="math inline">\(H_1\)</span>: The new feature increases user engagement (mean engagement after feature &gt; mean engagement before feature).</p>
<p>For example, if the average engagement before the feature was 20 interactions per user, and we observe 25 interactions after, we test if this increase is statistically significant.</p>
</section>
<section id="one-tailed-and-two-tailed-tests-1" class="level4">
<h4 class="anchored" data-anchor-id="one-tailed-and-two-tailed-tests-1">2. One-tailed and Two-tailed Tests</h4>
<p><strong>Question:</strong> Explain the difference between one-tailed and two-tailed tests with an example related to user activity on Facebook.</p>
<p><strong>Answer:</strong> A one-tailed test assesses the direction of the effect (e.g., increase or decrease), while a two-tailed test assesses any difference regardless of direction.</p>
<p>Example: - <strong>One-tailed test:</strong> Testing if a new notification system increases user activity. - <span class="math inline">\(H_0\)</span>: New notifications do not increase activity (mean activity with new notifications ≤ mean activity with old notifications). - <span class="math inline">\(H_1\)</span>: New notifications increase activity (mean activity with new notifications &gt; mean activity with old notifications). - <strong>Two-tailed test:</strong> Testing if a new interface affects user activity in any way. - <span class="math inline">\(H_0\)</span>: New interface does not affect activity (mean activity with new interface = mean activity with old interface). - <span class="math inline">\(H_1\)</span>: New interface affects activity (mean activity with new interface ≠ mean activity with old interface).</p>
</section>
<section id="t-tests" class="level4">
<h4 class="anchored" data-anchor-id="t-tests">3. T-tests</h4>
<p><strong>Question:</strong> How would you use a two-sample t-test to compare the average time spent on Instagram between two user groups?</p>
<p><strong>Answer:</strong> A two-sample t-test compares the means of two independent groups to determine if they are statistically different.</p>
<p>Example: - Group 1: Users who follow more than 100 accounts. - Group 2: Users who follow fewer than 100 accounts.</p>
<p><span class="math inline">\(H_0\)</span>: There is no difference in average time spent between the two groups. <span class="math inline">\(H_1\)</span>: There is a difference in average time spent between the two groups.</p>
<p>Calculate the t-statistic and p-value to determine if the observed difference is significant. If the p-value is less than the significance level (e.g., 0.05), we reject <span class="math inline">\(H_0\)</span> and conclude that the groups differ in their average time spent on Instagram.</p>
</section>
<section id="anova" class="level4">
<h4 class="anchored" data-anchor-id="anova">4. ANOVA</h4>
<p><strong>Question:</strong> How would you use one-way ANOVA to test if different content types (e.g., photos, videos, stories) affect user engagement differently on Facebook?</p>
<p><strong>Answer:</strong> One-way ANOVA tests for differences in means across three or more groups.</p>
<p>Example: - Content types: Photos, Videos, Stories.</p>
<p><span class="math inline">\(H_0\)</span>: All content types have the same average engagement. <span class="math inline">\(H_1\)</span>: At least one content type has a different average engagement.</p>
<p>Calculate the F-statistic and p-value. If the p-value is less than the significance level, we reject <span class="math inline">\(H_0\)</span> and conclude that at least one content type affects engagement differently. Post-hoc tests (e.g., Tukey’s HSD) can identify which pairs of content types differ.</p>
</section>
<section id="chi-square-tests" class="level4">
<h4 class="anchored" data-anchor-id="chi-square-tests">5. Chi-square Tests</h4>
<p><strong>Question:</strong> How would you use a chi-square test to analyze the relationship between user demographic (age group) and content preference on Instagram?</p>
<p><strong>Answer:</strong> The chi-square test for independence evaluates if there is an association between two categorical variables.</p>
<p>Example: - Variables: Age group (18-25, 26-35, 36-45), Content preference (Photos, Videos, Stories).</p>
<p><span class="math inline">\(H_0\)</span>: User demographic is independent of content preference. <span class="math inline">\(H_1\)</span>: User demographic is associated with content preference.</p>
<p>Construct a contingency table of age groups vs.&nbsp;content preferences and calculate the chi-square statistic and p-value. If the p-value is less than the significance level, we reject <span class="math inline">\(H_0\)</span> and conclude that there is an association between age group and content preference.</p>
</section>
<section id="f-test" class="level4">
<h4 class="anchored" data-anchor-id="f-test">6. F-test</h4>
<p><strong>Question:</strong> How can you use an F-test to compare the variances of user engagement between two different social media platforms?</p>
<p><strong>Answer:</strong> An F-test compares the variances of two independent samples to see if they are significantly different.</p>
<p>Example: - Platforms: Platform A and Platform B.</p>
<p><span class="math inline">\(H_0\)</span>: The variances of user engagement are equal between the two platforms. <span class="math inline">\(H_1\)</span>: The variances of user engagement are different between the two platforms.</p>
<p>Calculate the F-statistic as the ratio of the two sample variances and compare it to the critical value from the F-distribution. If the test statistic exceeds the critical value, we reject <span class="math inline">\(H_0\)</span> and conclude that the variances are significantly different.</p>
</section>
<section id="kolmogorov-smirnov-test" class="level4">
<h4 class="anchored" data-anchor-id="kolmogorov-smirnov-test">7. Kolmogorov-Smirnov Test</h4>
<p><strong>Question:</strong> Describe how you would use the Kolmogorov-Smirnov test to compare the distribution of daily active users on Facebook and Instagram.</p>
<p><strong>Answer:</strong> The Kolmogorov-Smirnov (K-S) test compares the distributions of two samples to determine if they come from the same distribution.</p>
<p>Example: - Samples: Daily active users on Facebook and Instagram.</p>
<p><span class="math inline">\(H_0\)</span>: The distributions of daily active users are the same for both platforms. <span class="math inline">\(H_1\)</span>: The distributions of daily active users are different for the platforms.</p>
<p>Calculate the K-S statistic and p-value. If the p-value is less than the significance level, we reject <span class="math inline">\(H_0\)</span> and conclude that the distributions of daily active users differ between Facebook and Instagram.</p>
</section>
<section id="mann-whitney-u-test" class="level4">
<h4 class="anchored" data-anchor-id="mann-whitney-u-test">8. Mann-Whitney U Test</h4>
<p><strong>Question:</strong> How would you apply the Mann-Whitney U test to compare user satisfaction scores between two different app versions on Instagram?</p>
<p><strong>Answer:</strong> The Mann-Whitney U test compares the distributions of two independent samples to assess differences in their central tendencies.</p>
<p>Example: - Versions: App Version A and App Version B.</p>
<p><span class="math inline">\(H_0\)</span>: User satisfaction scores are the same for both versions. <span class="math inline">\(H_1\)</span>: User satisfaction scores differ between versions.</p>
<p>Rank all satisfaction scores and calculate the U statistic. Compare it to the critical value from the Mann-Whitney distribution. If the test statistic is significant, we reject <span class="math inline">\(H_0\)</span> and conclude that user satisfaction differs between the two app versions.</p>
</section>
<section id="wilcoxon-signed-rank-test" class="level4">
<h4 class="anchored" data-anchor-id="wilcoxon-signed-rank-test">9. Wilcoxon Signed-Rank Test</h4>
<p><strong>Question:</strong> Explain how you would use the Wilcoxon signed-rank test to evaluate the effect of a new feature on user engagement on Instagram, using paired data.</p>
<p><strong>Answer:</strong> The Wilcoxon signed-rank test compares two related samples to assess changes in their distributions.</p>
<p>Example: - Paired data: User engagement before and after introducing a new feature.</p>
<p><span class="math inline">\(H_0\)</span>: There is no difference in user engagement before and after the new feature. <span class="math inline">\(H_1\)</span>: There is a difference in user engagement before and after the new feature.</p>
<p>Calculate the differences between paired observations, rank the absolute differences, and sum the ranks for positive and negative differences. If the test statistic is significant, we reject <span class="math inline">\(H_0\)</span> and conclude that the new feature affects user engagement.</p>
</section>
<section id="kruskal-wallis-test" class="level4">
<h4 class="anchored" data-anchor-id="kruskal-wallis-test">10. Kruskal-Wallis Test</h4>
<p><strong>Question:</strong> How would you use the Kruskal-Wallis test to compare user engagement across different social media platforms (e.g., Facebook, Instagram, Twitter)?</p>
<p><strong>Answer:</strong> The Kruskal-Wallis test compares the distributions of more than two independent samples to detect differences in their central tendencies.</p>
<p>Example: - Platforms: Facebook, Instagram, Twitter.</p>
<p><span class="math inline">\(H_0\)</span>: User engagement distributions are the same across platforms. <span class="math inline">\(H_1\)</span>: User engagement distributions differ across platforms.</p>
<p>Rank all user engagement scores and calculate the Kruskal-Wallis statistic. If the test statistic is significant, we reject <span class="math inline">\(H_0\)</span> and conclude that user engagement varies between platforms.</p>
</section>
</section>
<section id="confidence-intervals-2" class="level3">
<h3 class="anchored" data-anchor-id="confidence-intervals-2">Confidence Intervals</h3>
<section id="normal-approximation-1" class="level4">
<h4 class="anchored" data-anchor-id="normal-approximation-1">11. Normal Approximation</h4>
<p><strong>Question:</strong> How would you construct a confidence interval for the average time spent on Instagram using the normal approximation method?</p>
<p><strong>Answer:</strong> To construct a confidence interval using the normal approximation: 1. Calculate the sample mean (<span class="math inline">\(\bar{x}\)</span>) and standard deviation (<span class="math inline">\(s\)</span>). 2. Determine the standard error (<span class="math inline">\(SE = \frac{s}{\sqrt{n}}\)</span>). 3. Choose the confidence level (e.g., 95%) and find the corresponding z-value (e.g., 1.96 for 95% confidence). 4. Calculate the confidence interval: <span class="math inline">\(\bar{x} \pm z \times SE\)</span>.</p>
<p>For example, if the sample mean time spent is 2 hours with a standard deviation of 0.5 hours and a sample size of 100, the 95% confidence interval is <span class="math inline">\(2 \pm 1.96 \times \frac{0.5}{\sqrt{100}} = 2 \pm 0.098\)</span> hours.</p>
</section>
<section id="students-t-distribution-1" class="level4">
<h4 class="anchored" data-anchor-id="students-t-distribution-1">12. Student’s T-distribution</h4>
<p><strong>Question:</strong> How would you use Student’s t-distribution to construct a confidence interval for user engagement on Facebook with a small sample size?</p>
<p><strong>Answer:</strong> For small sample sizes, use Student’s t-distribution: 1. Calculate the sample mean (<span class="math inline">\(\bar{x}\)</span>) and standard deviation (<span class="math inline">\(s\)</span>). 2. Determine the standard error (<span class="math inline">\(SE = \frac{s}{\sqrt{n}}\)</span>). 3. Choose the confidence level and find the corresponding t-value from the t-distribution table based on degrees of freedom (<span class="math inline">\(n-1\)</span>). 4. Calculate the confidence interval: <span class="math inline">\(\bar{x} \pm t \times SE\)</span>.</p>
<p>For example, if the sample mean engagement is 50 interactions with a standard deviation of 10 interactions and a sample size of 15, the 95% confidence interval is <span class="math inline">\(50 \pm t_{14,0.025} \times \frac{10}{\sqrt{15}}\)</span>.</p>
</section>
<section id="bootstrap-confidence-intervals-1" class="level4">
<h4 class="anchored" data-anchor-id="bootstrap-confidence-intervals-1">13. Bootstrap Confidence Intervals</h4>
<p><strong>Question:</strong> Explain how you would use bootstrap confidence intervals to estimate the average likes per post on Instagram.</p>
<p><strong>Answer:</strong> Bootstrap confidence intervals use resampling to estimate the interval: 1. Draw multiple bootstrap samples from the original data (with replacement). 2. Calculate the sample mean for each bootstrap sample. 3. Construct the distribution of these means. 4. Determine the desired confidence interval from the bootstrap distribution (e.g., 2.5th to 97.5th percentile for 95% confidence).</p>
<p>For example, if we have a sample of likes per post and generate 10,000 bootstrap samples, we calculate the mean for each sample and find the 2.5th and 97.5th percentiles of these means to form the confidence interval.</p>
</section>
</section>
<section id="p-values-and-statistical-significance-1" class="level3">
<h3 class="anchored" data-anchor-id="p-values-and-statistical-significance-1">P-values and Statistical Significance</h3>
<section id="p-values-and-statistical-significance-2" class="level4">
<h4 class="anchored" data-anchor-id="p-values-and-statistical-significance-2">14. P-values and Statistical Significance</h4>
<p><strong>Question:</strong> What is a p-value, and how would you interpret it in the context of testing whether a new feature on Facebook increases user engagement?</p>
<p><strong>Answer:</strong> A p-value measures the probability of observing the test statistic or more extreme results under the null hypothesis. It indicates evidence against <span class="math inline">\(H_0\)</span>.</p>
<p>Example: - If testing whether a new feature increases user engagement, a p-value &lt; 0.05 (at the 5% significance level) suggests rejecting <span class="math inline">\(H_0\)</span> and concluding the feature likely increases engagement. - A p-value &gt; 0.05 means not rejecting <span class="math inline">\(H_0\)</span>, suggesting insufficient evidence to conclude the feature increases engagement.</p>
</section>
</section>
<section id="type-i-and-type-ii-errors-1" class="level3">
<h3 class="anchored" data-anchor-id="type-i-and-type-ii-errors-1">Type I and Type II Errors</h3>
<section id="type-i-and-type-ii-errors-2" class="level4">
<h4 class="anchored" data-anchor-id="type-i-and-type-ii-errors-2">15. Type I and Type II Errors</h4>
<p><strong>Question:</strong> Describe Type I and Type II errors in the context of A/B testing for a new user interface on Instagram.</p>
<p><strong>Answer:</strong> - <strong>Type I error (false positive):</strong> Concluding the new interface improves user engagement when it does not (rejecting <span class="math inline">\(H_0\)</span> when <span class="math inline">\(H_0\)</span> is true). Example: Rolling out a new interface based on test results that falsely indicate improved engagement. - <strong>Type II error (false negative):</strong> Concluding the new interface does not improve user engagement when it does (failing to reject <span class="math inline">\(H_0\)</span> when <span class="math inline">\(H_1\)</span> is true). Example: Not implementing a beneficial interface change due to test results not showing significant improvement.</p>
</section>
</section>
<section id="power-analysis" class="level3">
<h3 class="anchored" data-anchor-id="power-analysis">Power Analysis</h3>
<section id="power-analysis-1" class="level4">
<h4 class="anchored" data-anchor-id="power-analysis-1">16. Power Analysis</h4>
<p><strong>Question:</strong> How would you conduct a power analysis to determine the sample size needed for detecting a significant difference in user engagement on Facebook after introducing a new feature?</p>
<p><strong>Answer:</strong> Power analysis determines the sample size required to detect an effect with a specified power (typically 0.8) and significance level (e.g., 0.05): 1. Define the effect size (e.g., expected change in engagement). 2. Choose the significance level (<span class="math inline">\(\alpha\)</span>). 3. Set the desired power (1 - <span class="math inline">\(\beta\)</span>). 4. Use power analysis formulas or software to calculate the required sample size.</p>
<p>For example, if we expect a 5% increase in engagement, set <span class="math inline">\(\alpha = 0.05\)</span>, and power = 0.8, we use power analysis tools (e.g., G*Power) to find the needed sample size to detect this effect.</p>
</section>
</section>
<section id="effect-size-1" class="level3">
<h3 class="anchored" data-anchor-id="effect-size-1">Effect Size</h3>
<section id="cohens-d-1" class="level4">
<h4 class="anchored" data-anchor-id="cohens-d-1">17. Cohen’s d</h4>
<p><strong>Question:</strong> Explain how you would use Cohen’s d to quantify the effect size of a new content recommendation algorithm on user engagement on Instagram.</p>
<p><strong>Answer:</strong> Cohen’s d measures the standardized difference between two means: <span class="math display">\[ d = \frac{\bar{x}_1 - \bar{x}_2}{s_{pooled}} \]</span> where <span class="math inline">\(\bar{x}_1\)</span> and <span class="math inline">\(\bar{x}_2\)</span> are the means of engagement for the new and old algorithms, and <span class="math inline">\(s_{pooled}\)</span> is the pooled standard deviation.</p>
<p>Example: - If the mean engagement with the new algorithm is 60 and with the old algorithm is 50, with a pooled standard deviation of 10, Cohen’s d is <span class="math display">\[ \frac{60 - 50}{10} = 1.0 \]</span> indicating a large effect size.</p>
</section>
<section id="odds-ratio" class="level4">
<h4 class="anchored" data-anchor-id="odds-ratio">18. Odds Ratio</h4>
<p><strong>Question:</strong> How would you calculate and interpret the odds ratio for the likelihood of users clicking on ads before and after implementing a targeting algorithm on Facebook?</p>
<p><strong>Answer:</strong> The odds ratio compares the odds of an event occurring in two groups: <span class="math display">\[ \text{Odds ratio} = \frac{\text{odds of click after targeting}}{\text{odds of click before targeting}} \]</span></p>
<p>Example: - If the odds of clicking an ad after targeting are 0.4 and before targeting are 0.2, the odds ratio is <span class="math display">\[ \frac{0.4}{0.2} = 2 \]</span> indicating users are twice as likely to click ads after targeting.</p>
</section>
<section id="risk-ratio" class="level4">
<h4 class="anchored" data-anchor-id="risk-ratio">19. Risk Ratio</h4>
<p><strong>Question:</strong> Describe how you would use the risk ratio to compare the probability of high engagement among users exposed to two different content types on Instagram.</p>
<p><strong>Answer:</strong> The risk ratio compares the probability (risk) of an event between two groups: <span class="math display">\[ \text{Risk ratio} = \frac{P(\text{high engagement | content type 1})}{P(\text{high engagement | content type 2})} \]</span></p>
<p>Example: - If the probability of high engagement with videos is 0.3 and with photos is 0.15, the risk ratio is <span class="math display">\[ \frac{0.3}{0.15} = 2 \]</span> indicating videos are associated with a higher probability of high engagement.</p>
</section>
</section>
<section id="multiple-comparison-procedures-1" class="level3">
<h3 class="anchored" data-anchor-id="multiple-comparison-procedures-1">Multiple Comparison Procedures</h3>
<section id="bonferroni-correction-1" class="level4">
<h4 class="anchored" data-anchor-id="bonferroni-correction-1">20. Bonferroni Correction</h4>
<p><strong>Question:</strong> How would you use the Bonferroni correction to adjust for multiple comparisons in an A/B test with multiple metrics on Facebook?</p>
<p><strong>Answer:</strong> The Bonferroni correction adjusts the significance level to account for multiple comparisons, reducing the chance of Type I errors: <span class="math display">\[ \alpha_{adj} = \frac{\alpha}{m} \]</span> where <span class="math inline">\(\alpha\)</span> is the original significance level and <span class="math inline">\(m\)</span> is the number of comparisons.</p>
<p>Example: - If testing 10 metrics with an original <span class="math inline">\(\alpha\)</span> of 0.05, the adjusted <span class="math inline">\(\alpha_{adj}\)</span> is <span class="math display">\[ \frac{0.05}{10} = 0.005 \]</span> Each test must meet this stricter significance level to be considered significant.</p>
</section>
<section id="tukeys-hsd-1" class="level4">
<h4 class="anchored" data-anchor-id="tukeys-hsd-1">21. Tukey’s HSD</h4>
<p><strong>Question:</strong> Explain how Tukey’s HSD can be used for post-hoc analysis following ANOVA to compare user engagement across multiple content types on Instagram.</p>
<p><strong>Answer:</strong> Tukey’s HSD (Honestly Significant Difference) test compares all pairs of group means to identify significant differences: 1. Perform ANOVA to detect overall significance. 2. If significant, apply Tukey’s HSD to determine which specific pairs of content types (e.g., photos vs.&nbsp;videos, videos vs.&nbsp;stories) differ significantly in engagement.</p>
<p>Example: - After ANOVA shows significant differences, Tukey’s HSD might reveal that videos have significantly higher engagement than photos but not significantly different from stories.</p>
</section>
<section id="false-discovery-rate-fdr-1" class="level4">
<h4 class="anchored" data-anchor-id="false-discovery-rate-fdr-1">22. False Discovery Rate (FDR)</h4>
<p><strong>Question:</strong> How would you use the FDR method to control for false positives in multiple hypothesis testing for ad performance metrics on Facebook?</p>
<p><strong>Answer:</strong> FDR controls the expected proportion of false positives among rejected hypotheses. The Benjamini-Hochberg procedure is commonly used: 1. Rank p-values from multiple tests in ascending order. 2. Calculate the critical value for each rank: <span class="math display">\[ \frac{i}{m} \times \alpha \]</span> 3. Compare each p-value to its critical value. The largest p-value meeting this criterion, and all smaller p-values, are considered significant.</p>
<p>Example: - If testing 20 ad metrics with <span class="math inline">\(\alpha = 0.05\)</span>, rank the p-values, and apply the procedure to identify significant metrics while controlling for false positives.</p>
</section>
</section>
</section>
</section>



</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>